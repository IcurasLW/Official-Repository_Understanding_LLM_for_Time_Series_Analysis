Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           SMD                 Model:              CALF                

[1mData Loader[0m
  Data:               SMD                 Root Path:          /home/nathan/LLM4TS/datasets/anomaly_detection/SMD
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             38                  Dec In:             7                   
  C Out:              38                  d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.3                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       5                   Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : anomaly_detection_SMD_CALF_SMD_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7084
val 1416
test 7084
  0%|          | 0/5 [00:00<?, ?it/s]	iters: 100, epoch: 1 | loss: 0.2808646
	speed: 0.1348s/iter; left time: 61.4905s
Epoch: 1 cost time: 14.859778642654419
test 7084
train 7084
Threshold : 4.475206615924819
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9865, Precision : 0.8689, Recall : 0.7947, F-score : 0.8301 
Epoch: 1, Steps: 111 | Train Loss: 0.4356940 Vali Loss: 0.1761091
Validation loss decreased (inf --> 0.176109).  Saving model ...
lr_adjust = {1: 0.0001}
Updating learning rate to 0.0001
 20%|â–ˆâ–ˆ        | 1/5 [00:32<02:10, 32.50s/it]	iters: 100, epoch: 2 | loss: 0.2729980
	speed: 0.3138s/iter; left time: 108.2514s
Epoch: 2 cost time: 13.782546997070312
test 7084
train 7084
Threshold : 3.4577568542956483
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9868, Precision : 0.8688, Recall : 0.8025, F-score : 0.8344 
Epoch: 2, Steps: 111 | Train Loss: 0.2713930 Vali Loss: 0.1436373
Validation loss decreased (0.176109 --> 0.143637).  Saving model ...
lr_adjust = {2: 0.0001}
Updating learning rate to 0.0001
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:04<01:36, 32.01s/it]	iters: 100, epoch: 3 | loss: 0.2515871
	speed: 0.3198s/iter; left time: 74.8438s
Epoch: 3 cost time: 14.112065315246582
test 7084
train 7084
Threshold : 3.03060788512229
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9868, Precision : 0.8686, Recall : 0.8039, F-score : 0.8350 
Epoch: 3, Steps: 111 | Train Loss: 0.2404702 Vali Loss: 0.1273146
Validation loss decreased (0.143637 --> 0.127315).  Saving model ...
lr_adjust = {3: 0.0001}
Updating learning rate to 0.0001
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:36<01:04, 32.04s/it]	iters: 100, epoch: 4 | loss: 0.2057301
	speed: 0.3230s/iter; left time: 39.7275s
Epoch: 4 cost time: 14.356658458709717
test 7084
train 7084
Threshold : 2.7988343691825803
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9867, Precision : 0.8685, Recall : 0.8010, F-score : 0.8334 
Epoch: 4, Steps: 111 | Train Loss: 0.2217611 Vali Loss: 0.1136384
Validation loss decreased (0.127315 --> 0.113638).  Saving model ...
lr_adjust = {4: 9e-05}
Updating learning rate to 9e-05
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:08<00:32, 32.29s/it]	iters: 100, epoch: 5 | loss: 0.2164030
	speed: 0.3242s/iter; left time: 3.8910s
Epoch: 5 cost time: 14.07641887664795
test 7084
train 7084
Threshold : 2.6499624955653918
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9865, Precision : 0.8674, Recall : 0.7983, F-score : 0.8314 
Epoch: 5, Steps: 111 | Train Loss: 0.2086425 Vali Loss: 0.1067072
Validation loss decreased (0.113638 --> 0.106707).  Saving model ...
lr_adjust = {5: 8.1e-05}
Updating learning rate to 8.1e-05
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:44<00:00, 33.36s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:44<00:00, 32.83s/it]
>>>>>>>testing : anomaly_detection_SMD_CALF_SMD_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7084
train 7084
Threshold : 2.6499624955653918
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9865, Precision : 0.8674, Recall : 0.7983, F-score : 0.8314 
Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           SWAT                Model:              CALF                

[1mData Loader[0m
  Data:               SWAT                Root Path:          /home/nathan/LLM4TS/datasets/anomaly_detection/SWaT
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             51                  Dec In:             7                   
  C Out:              51                  d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.3                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       5                   Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : anomaly_detection_SWAT_CALF_SWAT_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
test: (449919, 51)
train: (495000, 51)
train 494901
test: (449919, 51)
train: (495000, 51)
val 98901
test: (449919, 51)
train: (495000, 51)
test 449820
  0%|          | 0/5 [00:00<?, ?it/s]	iters: 100, epoch: 1 | loss: 0.1371393
	speed: 0.1678s/iter; left time: 6473.2047s
	iters: 200, epoch: 1 | loss: 0.1357015
	speed: 0.1515s/iter; left time: 5827.6951s
	iters: 300, epoch: 1 | loss: 0.1147280
	speed: 0.1527s/iter; left time: 5859.2141s
	iters: 400, epoch: 1 | loss: 0.1013490
	speed: 0.1527s/iter; left time: 5843.7533s
	iters: 500, epoch: 1 | loss: 0.1006789
	speed: 0.1531s/iter; left time: 5842.4146s
	iters: 600, epoch: 1 | loss: 0.0942894
	speed: 0.1532s/iter; left time: 5832.6408s
	iters: 700, epoch: 1 | loss: 0.0754066
	speed: 0.1533s/iter; left time: 5819.1585s
	iters: 800, epoch: 1 | loss: 0.0937034
	speed: 0.1532s/iter; left time: 5802.6531s
	iters: 900, epoch: 1 | loss: 0.0869562
	speed: 0.1533s/iter; left time: 5791.2622s
	iters: 1000, epoch: 1 | loss: 0.0666391
	speed: 0.1534s/iter; left time: 5779.6504s
	iters: 1100, epoch: 1 | loss: 0.0648111
	speed: 0.1534s/iter; left time: 5764.4938s
	iters: 1200, epoch: 1 | loss: 0.0664017
	speed: 0.1535s/iter; left time: 5749.8135s
	iters: 1300, epoch: 1 | loss: 0.0694387
	speed: 0.1536s/iter; left time: 5737.6320s
	iters: 1400, epoch: 1 | loss: 0.0638717
	speed: 0.1535s/iter; left time: 5720.2097s
	iters: 1500, epoch: 1 | loss: 0.0743198
	speed: 0.1535s/iter; left time: 5706.2586s
	iters: 1600, epoch: 1 | loss: 0.0561744
	speed: 0.1535s/iter; left time: 5688.0192s
	iters: 1700, epoch: 1 | loss: 0.0578524
	speed: 0.1536s/iter; left time: 5676.2719s
	iters: 1800, epoch: 1 | loss: 0.0635664
	speed: 0.1535s/iter; left time: 5658.9814s
	iters: 1900, epoch: 1 | loss: 0.0624873
	speed: 0.1535s/iter; left time: 5643.4880s
	iters: 2000, epoch: 1 | loss: 0.0554603
	speed: 0.1532s/iter; left time: 5617.1723s
	iters: 2100, epoch: 1 | loss: 0.0613134
	speed: 0.1535s/iter; left time: 5611.1038s
	iters: 2200, epoch: 1 | loss: 0.0530883
	speed: 0.1534s/iter; left time: 5595.5927s
	iters: 2300, epoch: 1 | loss: 0.0545529
	speed: 0.1534s/iter; left time: 5578.4691s
	iters: 2400, epoch: 1 | loss: 0.0608730
	speed: 0.1534s/iter; left time: 5564.8114s
	iters: 2500, epoch: 1 | loss: 0.0522438
	speed: 0.1535s/iter; left time: 5552.0181s
	iters: 2600, epoch: 1 | loss: 0.0536098
	speed: 0.1533s/iter; left time: 5528.9649s
	iters: 2700, epoch: 1 | loss: 0.0569098
	speed: 0.1529s/iter; left time: 5498.8771s
	iters: 2800, epoch: 1 | loss: 0.0461777
	speed: 0.1535s/iter; left time: 5506.5134s
	iters: 2900, epoch: 1 | loss: 0.0515133
	speed: 0.1536s/iter; left time: 5491.8724s
	iters: 3000, epoch: 1 | loss: 0.0488982
	speed: 0.1536s/iter; left time: 5477.5613s
	iters: 3100, epoch: 1 | loss: 0.0572021
	speed: 0.1535s/iter; left time: 5460.6794s
	iters: 3200, epoch: 1 | loss: 0.0516655
	speed: 0.1536s/iter; left time: 5446.8830s
	iters: 3300, epoch: 1 | loss: 0.0490894
	speed: 0.1536s/iter; left time: 5430.7345s
	iters: 3400, epoch: 1 | loss: 0.0498154
	speed: 0.1535s/iter; left time: 5413.3366s
	iters: 3500, epoch: 1 | loss: 0.0499855
	speed: 0.1535s/iter; left time: 5399.6505s
	iters: 3600, epoch: 1 | loss: 0.0564167
	speed: 0.1535s/iter; left time: 5382.6955s
	iters: 3700, epoch: 1 | loss: 0.0498606
	speed: 0.1534s/iter; left time: 5363.7353s
	iters: 3800, epoch: 1 | loss: 0.0455460
	speed: 0.1532s/iter; left time: 5340.9538s
	iters: 3900, epoch: 1 | loss: 0.0457265
	speed: 0.1535s/iter; left time: 5336.0175s
	iters: 4000, epoch: 1 | loss: 0.0455352
	speed: 0.1535s/iter; left time: 5320.9118s
	iters: 4100, epoch: 1 | loss: 0.0418185
	speed: 0.1535s/iter; left time: 5306.1595s
	iters: 4200, epoch: 1 | loss: 0.0470546
	speed: 0.1535s/iter; left time: 5289.9867s
	iters: 4300, epoch: 1 | loss: 0.0485014
	speed: 0.1535s/iter; left time: 5274.8734s
	iters: 4400, epoch: 1 | loss: 0.0469254
	speed: 0.1535s/iter; left time: 5261.4419s
	iters: 4500, epoch: 1 | loss: 0.0455970
	speed: 0.1536s/iter; left time: 5247.7365s
	iters: 4600, epoch: 1 | loss: 0.0479813
	speed: 0.1535s/iter; left time: 5229.8898s
	iters: 4700, epoch: 1 | loss: 0.0422484
	speed: 0.1531s/iter; left time: 5201.3112s
	iters: 4800, epoch: 1 | loss: 0.0448786
	speed: 0.1538s/iter; left time: 5207.0676s
	iters: 4900, epoch: 1 | loss: 0.0452608
	speed: 0.1541s/iter; left time: 5204.7742s
	iters: 5000, epoch: 1 | loss: 0.0512363
	speed: 0.1535s/iter; left time: 5168.3601s
	iters: 5100, epoch: 1 | loss: 0.0526665
	speed: 0.1537s/iter; left time: 5160.4846s
	iters: 5200, epoch: 1 | loss: 0.0432731
	speed: 0.1542s/iter; left time: 5159.0111s
	iters: 5300, epoch: 1 | loss: 0.0405245
	speed: 0.1538s/iter; left time: 5132.1566s
	iters: 5400, epoch: 1 | loss: 0.0448003
	speed: 0.1536s/iter; left time: 5110.6431s
	iters: 5500, epoch: 1 | loss: 0.0434993
	speed: 0.1536s/iter; left time: 5094.4979s
	iters: 5600, epoch: 1 | loss: 0.0444127
	speed: 0.1537s/iter; left time: 5082.8837s
	iters: 5700, epoch: 1 | loss: 0.0501808
	speed: 0.1537s/iter; left time: 5065.6719s
	iters: 5800, epoch: 1 | loss: 0.0426900
	speed: 0.1535s/iter; left time: 5043.9484s
	iters: 5900, epoch: 1 | loss: 0.0425764
	speed: 0.1536s/iter; left time: 5032.8550s
	iters: 6000, epoch: 1 | loss: 0.0402661
	speed: 0.1536s/iter; left time: 5018.7791s
	iters: 6100, epoch: 1 | loss: 0.0438175
	speed: 0.1539s/iter; left time: 5012.4424s
	iters: 6200, epoch: 1 | loss: 0.0423787
	speed: 0.1536s/iter; left time: 4985.3710s
	iters: 6300, epoch: 1 | loss: 0.0395773
	speed: 0.1539s/iter; left time: 4982.2167s
	iters: 6400, epoch: 1 | loss: 0.0444641
	speed: 0.1539s/iter; left time: 4964.3297s
	iters: 6500, epoch: 1 | loss: 0.0439577
	speed: 0.1542s/iter; left time: 4959.0155s
	iters: 6600, epoch: 1 | loss: 0.0419191
	speed: 0.1536s/iter; left time: 4924.6568s
	iters: 6700, epoch: 1 | loss: 0.0476274
	speed: 0.1535s/iter; left time: 4905.4236s
	iters: 6800, epoch: 1 | loss: 0.0427180
	speed: 0.1534s/iter; left time: 4889.6192s
	iters: 6900, epoch: 1 | loss: 0.0460790
	speed: 0.1532s/iter; left time: 4867.8419s
	iters: 7000, epoch: 1 | loss: 0.0438229
	speed: 0.1534s/iter; left time: 4859.0595s
	iters: 7100, epoch: 1 | loss: 0.0355235
	speed: 0.1535s/iter; left time: 4845.8004s
	iters: 7200, epoch: 1 | loss: 0.0439465
	speed: 0.1534s/iter; left time: 4826.9774s
	iters: 7300, epoch: 1 | loss: 0.0482016
	speed: 0.1535s/iter; left time: 4815.5146s
	iters: 7400, epoch: 1 | loss: 0.0423225
	speed: 0.1535s/iter; left time: 4800.0447s
	iters: 7500, epoch: 1 | loss: 0.0392326
	speed: 0.1532s/iter; left time: 4775.3137s
	iters: 7600, epoch: 1 | loss: 0.0425423
	speed: 0.1535s/iter; left time: 4769.7236s
	iters: 7700, epoch: 1 | loss: 0.0393656
	speed: 0.1535s/iter; left time: 4752.1358s
Epoch: 1 cost time: 1188.312207698822
test: (449919, 51)
train: (495000, 51)
test 449820
test: (449919, 51)
train: (495000, 51)
train 494901
Threshold : 0.4022104477882351
pred:    (44982000,)
gt:      (44982000,)
pred:  (44982000,)
gt:    (44982000,)
Accuracy : 0.9781, Precision : 0.9562, Recall : 0.8594, F-score : 0.9052 
Epoch: 1, Steps: 7733 | Train Loss: 0.0570934 Vali Loss: 0.0077021
Validation loss decreased (inf --> 0.007702).  Saving model ...
lr_adjust = {1: 0.0001}
Updating learning rate to 0.0001
 20%|â–ˆâ–ˆ        | 1/5 [37:44<2:30:58, 2264.74s/it]	iters: 100, epoch: 2 | loss: 0.0414099
	speed: 10.9786s/iter; left time: 338504.4913s
	iters: 200, epoch: 2 | loss: 0.0439984
	speed: 0.1525s/iter; left time: 4687.0568s
	iters: 300, epoch: 2 | loss: 0.0462835
	speed: 0.1530s/iter; left time: 4687.6760s
	iters: 400, epoch: 2 | loss: 0.0426882
	speed: 0.1532s/iter; left time: 4679.1112s
	iters: 500, epoch: 2 | loss: 0.0434949
	speed: 0.1533s/iter; left time: 4665.1447s
	iters: 600, epoch: 2 | loss: 0.0408395
	speed: 0.1533s/iter; left time: 4650.0893s
	iters: 700, epoch: 2 | loss: 0.0397870
	speed: 0.1534s/iter; left time: 4636.3600s
	iters: 800, epoch: 2 | loss: 0.0425685
	speed: 0.1533s/iter; left time: 4620.6168s
	iters: 900, epoch: 2 | loss: 0.0441176
	speed: 0.1535s/iter; left time: 4608.7830s
	iters: 1000, epoch: 2 | loss: 0.0402216
	speed: 0.1534s/iter; left time: 4592.9891s
	iters: 1100, epoch: 2 | loss: 0.0444702
	speed: 0.1534s/iter; left time: 4575.4921s
	iters: 1200, epoch: 2 | loss: 0.0419365
	speed: 0.1534s/iter; left time: 4562.1949s
	iters: 1300, epoch: 2 | loss: 0.0363958
	speed: 0.1535s/iter; left time: 4548.4203s
	iters: 1400, epoch: 2 | loss: 0.0497476
	speed: 0.1533s/iter; left time: 4526.9730s
	iters: 1500, epoch: 2 | loss: 0.0343742
	speed: 0.1534s/iter; left time: 4515.8835s
	iters: 1600, epoch: 2 | loss: 0.0381053
	speed: 0.1535s/iter; left time: 4501.9502s
	iters: 1700, epoch: 2 | loss: 0.0356323
	speed: 0.1535s/iter; left time: 4487.3794s
	iters: 1800, epoch: 2 | loss: 0.0393631
	speed: 0.1536s/iter; left time: 4474.4605s
	iters: 1900, epoch: 2 | loss: 0.0354788
	speed: 0.1534s/iter; left time: 4453.7958s
	iters: 2000, epoch: 2 | loss: 0.0347899
	speed: 0.1533s/iter; left time: 4436.0251s
	iters: 2100, epoch: 2 | loss: 0.0386401
	speed: 0.1535s/iter; left time: 4424.9081s
	iters: 2200, epoch: 2 | loss: 0.0349598
	speed: 0.1536s/iter; left time: 4412.2878s
	iters: 2300, epoch: 2 | loss: 0.0352892
	speed: 0.1535s/iter; left time: 4394.4462s
	iters: 2400, epoch: 2 | loss: 0.0338353
	speed: 0.1537s/iter; left time: 4384.5939s
	iters: 2500, epoch: 2 | loss: 0.0363481
	speed: 0.1534s/iter; left time: 4360.6821s
	iters: 2600, epoch: 2 | loss: 0.0397942
	speed: 0.1535s/iter; left time: 4350.3869s
	iters: 2700, epoch: 2 | loss: 0.0352026
	speed: 0.1535s/iter; left time: 4334.2258s
	iters: 2800, epoch: 2 | loss: 0.0457729
	speed: 0.1535s/iter; left time: 4319.2238s
	iters: 2900, epoch: 2 | loss: 0.0416475
	speed: 0.1535s/iter; left time: 4304.3271s
	iters: 3000, epoch: 2 | loss: 0.0374440
	speed: 0.1535s/iter; left time: 4288.9606s
	iters: 3100, epoch: 2 | loss: 0.0367581
	speed: 0.1536s/iter; left time: 4274.3574s
	iters: 3200, epoch: 2 | loss: 0.0355131
	speed: 0.1535s/iter; left time: 4257.2144s
	iters: 3300, epoch: 2 | loss: 0.0394178
	speed: 0.1534s/iter; left time: 4240.2347s
	iters: 3400, epoch: 2 | loss: 0.0397490
	speed: 0.1534s/iter; left time: 4223.4432s
	iters: 3500, epoch: 2 | loss: 0.0443250
	speed: 0.1533s/iter; left time: 4206.8491s
	iters: 3600, epoch: 2 | loss: 0.0341065
	speed: 0.1530s/iter; left time: 4180.5966s
	iters: 3700, epoch: 2 | loss: 0.0412614
	speed: 0.1534s/iter; left time: 4177.1799s
	iters: 3800, epoch: 2 | loss: 0.0390310
	speed: 0.1535s/iter; left time: 4163.8280s
	iters: 3900, epoch: 2 | loss: 0.0387824
	speed: 0.1541s/iter; left time: 4166.4977s
	iters: 4000, epoch: 2 | loss: 0.0366430
	speed: 0.1541s/iter; left time: 4150.6863s
	iters: 4100, epoch: 2 | loss: 0.0406278
	speed: 0.1537s/iter; left time: 4124.9980s
	iters: 4200, epoch: 2 | loss: 0.0369587
	speed: 0.1540s/iter; left time: 4116.0280s
	iters: 4300, epoch: 2 | loss: 0.0358604
	speed: 0.1534s/iter; left time: 4085.0206s
	iters: 4400, epoch: 2 | loss: 0.0420989
	speed: 0.1534s/iter; left time: 4070.4484s
	iters: 4500, epoch: 2 | loss: 0.0397133
	speed: 0.1535s/iter; left time: 4058.5982s
	iters: 4600, epoch: 2 | loss: 0.0342810
	speed: 0.1535s/iter; left time: 4042.7066s
	iters: 4700, epoch: 2 | loss: 0.0412874
	speed: 0.1536s/iter; left time: 4028.4031s
	iters: 4800, epoch: 2 | loss: 0.0372480
	speed: 0.1540s/iter; left time: 4023.8350s
	iters: 4900, epoch: 2 | loss: 0.0398528
	speed: 0.1541s/iter; left time: 4012.1307s
	iters: 5000, epoch: 2 | loss: 0.0378364
	speed: 0.1539s/iter; left time: 3990.5411s
	iters: 5100, epoch: 2 | loss: 0.0376549
	speed: 0.1535s/iter; left time: 3965.3826s
	iters: 5200, epoch: 2 | loss: 0.0364662
	speed: 0.1534s/iter; left time: 3948.3839s
	iters: 5300, epoch: 2 | loss: 0.0357778
	speed: 0.1532s/iter; left time: 3927.3323s
	iters: 5400, epoch: 2 | loss: 0.0344146
	speed: 0.1534s/iter; left time: 3917.8236s
	iters: 5500, epoch: 2 | loss: 0.0361395
	speed: 0.1535s/iter; left time: 3904.0869s
	iters: 5600, epoch: 2 | loss: 0.0378741
	speed: 0.1535s/iter; left time: 3887.9092s
	iters: 5700, epoch: 2 | loss: 0.0347029
	speed: 0.1532s/iter; left time: 3865.6945s
	iters: 5800, epoch: 2 | loss: 0.0329593
	speed: 0.1535s/iter; left time: 3856.8396s
	iters: 5900, epoch: 2 | loss: 0.0325989
	speed: 0.1532s/iter; left time: 3835.7736s
	iters: 6000, epoch: 2 | loss: 0.0366277
	speed: 0.1535s/iter; left time: 3826.4920s
	iters: 6100, epoch: 2 | loss: 0.0383965
	speed: 0.1536s/iter; left time: 3813.3382s
	iters: 6200, epoch: 2 | loss: 0.0372637
	speed: 0.1535s/iter; left time: 3796.2186s
	iters: 6300, epoch: 2 | loss: 0.0337059
	speed: 0.1535s/iter; left time: 3780.8310s
	iters: 6400, epoch: 2 | loss: 0.0343748
	speed: 0.1536s/iter; left time: 3767.3472s
	iters: 6500, epoch: 2 | loss: 0.0377785
	speed: 0.1535s/iter; left time: 3750.3811s
	iters: 6600, epoch: 2 | loss: 0.0369569
	speed: 0.1535s/iter; left time: 3734.6624s
	iters: 6700, epoch: 2 | loss: 0.0385555
	speed: 0.1534s/iter; left time: 3717.2031s
	iters: 6800, epoch: 2 | loss: 0.0365124
	speed: 0.1534s/iter; left time: 3703.1347s
	iters: 6900, epoch: 2 | loss: 0.0410176
	speed: 0.1534s/iter; left time: 3687.4553s
	iters: 7000, epoch: 2 | loss: 0.0402960
	speed: 0.1535s/iter; left time: 3674.6514s
	iters: 7100, epoch: 2 | loss: 0.0348754
	speed: 0.1534s/iter; left time: 3656.9537s
	iters: 7200, epoch: 2 | loss: 0.0368234
	speed: 0.1534s/iter; left time: 3640.8174s
	iters: 7300, epoch: 2 | loss: 0.0358829
	speed: 0.1533s/iter; left time: 3623.1258s
	iters: 7400, epoch: 2 | loss: 0.0362574
	speed: 0.1535s/iter; left time: 3611.7178s
	iters: 7500, epoch: 2 | loss: 0.0357743
	speed: 0.1533s/iter; left time: 3592.9440s
	iters: 7600, epoch: 2 | loss: 0.0341484
	speed: 0.1532s/iter; left time: 3575.2561s
	iters: 7700, epoch: 2 | loss: 0.0396042
	speed: 0.1534s/iter; left time: 3564.1950s
Epoch: 2 cost time: 1187.8662059307098
test: (449919, 51)
train: (495000, 51)
test 449820
test: (449919, 51)
train: (495000, 51)
train 494901
Threshold : 0.24517877563834034
pred:    (44982000,)
gt:      (44982000,)
pred:  (44982000,)
gt:    (44982000,)
Accuracy : 0.9860, Precision : 0.9594, Recall : 0.9237, F-score : 0.9412 
Epoch: 2, Steps: 7733 | Train Loss: 0.0378698 Vali Loss: 0.0043248
Validation loss decreased (0.007702 --> 0.004325).  Saving model ...
lr_adjust = {2: 0.0001}
Updating learning rate to 0.0001
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [1:15:32<1:53:19, 2266.65s/it]	iters: 100, epoch: 3 | loss: 0.0340839
	speed: 11.0152s/iter; left time: 254450.0172s
	iters: 200, epoch: 3 | loss: 0.0326439
	speed: 0.1524s/iter; left time: 3504.9816s
	iters: 300, epoch: 3 | loss: 0.0389419
	speed: 0.1529s/iter; left time: 3500.6659s
	iters: 400, epoch: 3 | loss: 0.0395702
	speed: 0.1529s/iter; left time: 3486.2857s
	iters: 500, epoch: 3 | loss: 0.0392667
	speed: 0.1532s/iter; left time: 3477.3223s
	iters: 600, epoch: 3 | loss: 0.0340775
	speed: 0.1532s/iter; left time: 3461.4995s
	iters: 700, epoch: 3 | loss: 0.0296700
	speed: 0.1534s/iter; left time: 3451.9825s
	iters: 800, epoch: 3 | loss: 0.0322341
	speed: 0.1533s/iter; left time: 3433.2420s
	iters: 900, epoch: 3 | loss: 0.0379093
	speed: 0.1533s/iter; left time: 3419.6250s
	iters: 1000, epoch: 3 | loss: 0.0368865
	speed: 0.1534s/iter; left time: 3406.2967s
	iters: 1100, epoch: 3 | loss: 0.0339645
	speed: 0.1535s/iter; left time: 3391.3088s
	iters: 1200, epoch: 3 | loss: 0.0288113
	speed: 0.1536s/iter; left time: 3378.7660s
	iters: 1300, epoch: 3 | loss: 0.0336457
	speed: 0.1534s/iter; left time: 3358.7680s
	iters: 1400, epoch: 3 | loss: 0.0360286
	speed: 0.1536s/iter; left time: 3347.4747s
	iters: 1500, epoch: 3 | loss: 0.0350941
	speed: 0.1535s/iter; left time: 3330.4211s
	iters: 1600, epoch: 3 | loss: 0.0370706
	speed: 0.1535s/iter; left time: 3316.2667s
	iters: 1700, epoch: 3 | loss: 0.0365492
	speed: 0.1535s/iter; left time: 3300.9345s
	iters: 1800, epoch: 3 | loss: 0.0405793
	speed: 0.1535s/iter; left time: 3285.9466s
	iters: 1900, epoch: 3 | loss: 0.0302131
	speed: 0.1535s/iter; left time: 3270.4987s
	iters: 2000, epoch: 3 | loss: 0.0337235
	speed: 0.1535s/iter; left time: 3254.5848s
	iters: 2100, epoch: 3 | loss: 0.0371726
	speed: 0.1532s/iter; left time: 3232.4087s
	iters: 2200, epoch: 3 | loss: 0.0314302
	speed: 0.1536s/iter; left time: 3225.9245s
	iters: 2300, epoch: 3 | loss: 0.0316978
	speed: 0.1537s/iter; left time: 3212.6592s
	iters: 2400, epoch: 3 | loss: 0.0358416
	speed: 0.1535s/iter; left time: 3192.5062s
	iters: 2500, epoch: 3 | loss: 0.0345994
	speed: 0.1535s/iter; left time: 3176.9199s
	iters: 2600, epoch: 3 | loss: 0.0365444
	speed: 0.1534s/iter; left time: 3159.2102s
	iters: 2700, epoch: 3 | loss: 0.0403190
	speed: 0.1534s/iter; left time: 3143.6820s
	iters: 2800, epoch: 3 | loss: 0.0353614
	speed: 0.1534s/iter; left time: 3129.9414s
	iters: 2900, epoch: 3 | loss: 0.0324651
	speed: 0.1534s/iter; left time: 3114.6305s
	iters: 3000, epoch: 3 | loss: 0.0329429
	speed: 0.1534s/iter; left time: 3098.9367s
	iters: 3100, epoch: 3 | loss: 0.0352871
	speed: 0.1535s/iter; left time: 3084.3997s
	iters: 3200, epoch: 3 | loss: 0.0310570
	speed: 0.1534s/iter; left time: 3068.8686s
	iters: 3300, epoch: 3 | loss: 0.0353781
	speed: 0.1535s/iter; left time: 3054.8957s
	iters: 3400, epoch: 3 | loss: 0.0376811
	speed: 0.1535s/iter; left time: 3039.3501s
	iters: 3500, epoch: 3 | loss: 0.0349342
	speed: 0.1534s/iter; left time: 3022.5411s
	iters: 3600, epoch: 3 | loss: 0.0365097
	speed: 0.1536s/iter; left time: 3009.7084s
	iters: 3700, epoch: 3 | loss: 0.0363036
	speed: 0.1535s/iter; left time: 2993.1537s
	iters: 3800, epoch: 3 | loss: 0.0345300
	speed: 0.1534s/iter; left time: 2976.2529s
	iters: 3900, epoch: 3 | loss: 0.0330631
	speed: 0.1535s/iter; left time: 2962.6941s
	iters: 4000, epoch: 3 | loss: 0.0334063
	speed: 0.1535s/iter; left time: 2948.0853s
	iters: 4100, epoch: 3 | loss: 0.0339572
	speed: 0.1536s/iter; left time: 2933.7222s
	iters: 4200, epoch: 3 | loss: 0.0314200
	speed: 0.1535s/iter; left time: 2916.1320s
	iters: 4300, epoch: 3 | loss: 0.0317707
	speed: 0.1535s/iter; left time: 2900.4587s
	iters: 4400, epoch: 3 | loss: 0.0314314
	speed: 0.1535s/iter; left time: 2885.0072s
	iters: 4500, epoch: 3 | loss: 0.0340334
	speed: 0.1534s/iter; left time: 2867.8943s
	iters: 4600, epoch: 3 | loss: 0.0350815
	speed: 0.1533s/iter; left time: 2850.9965s
	iters: 4700, epoch: 3 | loss: 0.0391642
	speed: 0.1533s/iter; left time: 2836.6177s
	iters: 4800, epoch: 3 | loss: 0.0327931
	speed: 0.1534s/iter; left time: 2822.1299s
	iters: 4900, epoch: 3 | loss: 0.0404068
	speed: 0.1531s/iter; left time: 2801.7104s
	iters: 5000, epoch: 3 | loss: 0.0343421
	speed: 0.1532s/iter; left time: 2787.6531s
	iters: 5100, epoch: 3 | loss: 0.0385495
	speed: 0.1533s/iter; left time: 2774.7602s
	iters: 5200, epoch: 3 | loss: 0.0316743
	speed: 0.1535s/iter; left time: 2762.4188s
	iters: 5300, epoch: 3 | loss: 0.0376678
	speed: 0.1537s/iter; left time: 2750.9431s
	iters: 5400, epoch: 3 | loss: 0.0337776
	speed: 0.1535s/iter; left time: 2731.5586s
	iters: 5500, epoch: 3 | loss: 0.0325891
	speed: 0.1535s/iter; left time: 2717.0457s
	iters: 5600, epoch: 3 | loss: 0.0327701
	speed: 0.1535s/iter; left time: 2702.0295s
	iters: 5700, epoch: 3 | loss: 0.0348305
	speed: 0.1535s/iter; left time: 2686.2922s
	iters: 5800, epoch: 3 | loss: 0.0323842
	speed: 0.1531s/iter; left time: 2663.7519s
	iters: 5900, epoch: 3 | loss: 0.0355143
	speed: 0.1533s/iter; left time: 2651.8775s
	iters: 6000, epoch: 3 | loss: 0.0404795
	speed: 0.1533s/iter; left time: 2636.0774s
	iters: 6100, epoch: 3 | loss: 0.0349423
	speed: 0.1533s/iter; left time: 2621.3388s
	iters: 6200, epoch: 3 | loss: 0.0323633
	speed: 0.1535s/iter; left time: 2609.2207s
	iters: 6300, epoch: 3 | loss: 0.0312441
	speed: 0.1535s/iter; left time: 2594.1714s
	iters: 6400, epoch: 3 | loss: 0.0361260
	speed: 0.1534s/iter; left time: 2577.6370s
	iters: 6500, epoch: 3 | loss: 0.0350004
	speed: 0.1534s/iter; left time: 2561.7032s
	iters: 6600, epoch: 3 | loss: 0.0371026
	speed: 0.1533s/iter; left time: 2544.4297s
	iters: 6700, epoch: 3 | loss: 0.0321831
	speed: 0.1534s/iter; left time: 2531.7408s
	iters: 6800, epoch: 3 | loss: 0.0311644
	speed: 0.1535s/iter; left time: 2517.3983s
	iters: 6900, epoch: 3 | loss: 0.0311964
	speed: 0.1535s/iter; left time: 2502.5298s
	iters: 7000, epoch: 3 | loss: 0.0335120
	speed: 0.1535s/iter; left time: 2486.1085s
	iters: 7100, epoch: 3 | loss: 0.0287883
	speed: 0.1535s/iter; left time: 2471.4792s
	iters: 7200, epoch: 3 | loss: 0.0360786
	speed: 0.1536s/iter; left time: 2457.4039s
	iters: 7300, epoch: 3 | loss: 0.0327227
	speed: 0.1536s/iter; left time: 2442.2780s
	iters: 7400, epoch: 3 | loss: 0.0357443
	speed: 0.1536s/iter; left time: 2426.8906s
	iters: 7500, epoch: 3 | loss: 0.0312254
	speed: 0.1540s/iter; left time: 2418.5793s
	iters: 7600, epoch: 3 | loss: 0.0318123
	speed: 0.1541s/iter; left time: 2404.1657s
	iters: 7700, epoch: 3 | loss: 0.0311983
	speed: 0.1535s/iter; left time: 2378.9925s
Epoch: 3 cost time: 1187.4281673431396
test: (449919, 51)
train: (495000, 51)
test 449820
test: (449919, 51)
train: (495000, 51)
train 494901
Threshold : 0.20321951955556727
pred:    (44982000,)
gt:      (44982000,)
pred:  (44982000,)
gt:    (44982000,)
Accuracy : 0.9860, Precision : 0.9596, Recall : 0.9237, F-score : 0.9413 
Epoch: 3, Steps: 7733 | Train Loss: 0.0344634 Vali Loss: 0.0033416
Validation loss decreased (0.004325 --> 0.003342).  Saving model ...
lr_adjust = {3: 0.0001}
Updating learning rate to 0.0001
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [1:53:19<1:15:33, 2266.55s/it]	iters: 100, epoch: 4 | loss: 0.0348483
	speed: 11.0043s/iter; left time: 169103.8041s
	iters: 200, epoch: 4 | loss: 0.0346529
	speed: 0.1524s/iter; left time: 2327.3005s
	iters: 300, epoch: 4 | loss: 0.0337256
	speed: 0.1530s/iter; left time: 2320.5259s
	iters: 400, epoch: 4 | loss: 0.0333201
	speed: 0.1532s/iter; left time: 2308.8106s
	iters: 500, epoch: 4 | loss: 0.0380524
	speed: 0.1529s/iter; left time: 2288.3279s
	iters: 600, epoch: 4 | loss: 0.0387855
	speed: 0.1538s/iter; left time: 2286.2060s
	iters: 700, epoch: 4 | loss: 0.0285217
	speed: 0.1540s/iter; left time: 2273.8539s
	iters: 800, epoch: 4 | loss: 0.0367214
	speed: 0.1540s/iter; left time: 2258.9206s
	iters: 900, epoch: 4 | loss: 0.0357307
	speed: 0.1534s/iter; left time: 2233.9166s
	iters: 1000, epoch: 4 | loss: 0.0331153
	speed: 0.1534s/iter; left time: 2219.5633s
	iters: 1100, epoch: 4 | loss: 0.0300322
	speed: 0.1534s/iter; left time: 2204.4897s
	iters: 1200, epoch: 4 | loss: 0.0297518
	speed: 0.1535s/iter; left time: 2189.5032s
	iters: 1300, epoch: 4 | loss: 0.0305752
	speed: 0.1535s/iter; left time: 2174.6311s
	iters: 1400, epoch: 4 | loss: 0.0374259
	speed: 0.1535s/iter; left time: 2159.4564s
	iters: 1500, epoch: 4 | loss: 0.0321023
	speed: 0.1536s/iter; left time: 2144.6360s
	iters: 1600, epoch: 4 | loss: 0.0321463
	speed: 0.1536s/iter; left time: 2129.7908s
	iters: 1700, epoch: 4 | loss: 0.0302700
	speed: 0.1541s/iter; left time: 2121.7559s
	iters: 1800, epoch: 4 | loss: 0.0341403
	speed: 0.1539s/iter; left time: 2103.3668s
	iters: 1900, epoch: 4 | loss: 0.0291394
	speed: 0.1536s/iter; left time: 2083.4547s
	iters: 2000, epoch: 4 | loss: 0.0316801
	speed: 0.1534s/iter; left time: 2065.9873s
	iters: 2100, epoch: 4 | loss: 0.0301764
	speed: 0.1541s/iter; left time: 2059.3720s
	iters: 2200, epoch: 4 | loss: 0.0354184
	speed: 0.1542s/iter; left time: 2045.3476s
	iters: 2300, epoch: 4 | loss: 0.0377957
	speed: 0.1537s/iter; left time: 2023.3178s
	iters: 2400, epoch: 4 | loss: 0.0343164
	speed: 0.1536s/iter; left time: 2006.8628s
	iters: 2500, epoch: 4 | loss: 0.0336493
	speed: 0.1536s/iter; left time: 1992.0492s
	iters: 2600, epoch: 4 | loss: 0.0285021
	speed: 0.1535s/iter; left time: 1974.5784s
	iters: 2700, epoch: 4 | loss: 0.0322840
	speed: 0.1536s/iter; left time: 1960.8196s
	iters: 2800, epoch: 4 | loss: 0.0303834
	speed: 0.1534s/iter; left time: 1942.9559s
	iters: 2900, epoch: 4 | loss: 0.0335588
	speed: 0.1533s/iter; left time: 1926.7561s
	iters: 3000, epoch: 4 | loss: 0.0321266
	speed: 0.1536s/iter; left time: 1914.8466s
	iters: 3100, epoch: 4 | loss: 0.0352598
	speed: 0.1536s/iter; left time: 1899.4532s
	iters: 3200, epoch: 4 | loss: 0.0272885
	speed: 0.1534s/iter; left time: 1882.1869s
	iters: 3300, epoch: 4 | loss: 0.0283352
	speed: 0.1534s/iter; left time: 1866.5358s
	iters: 3400, epoch: 4 | loss: 0.0354621
	speed: 0.1535s/iter; left time: 1852.0133s
	iters: 3500, epoch: 4 | loss: 0.0286955
	speed: 0.1535s/iter; left time: 1836.3442s
	iters: 3600, epoch: 4 | loss: 0.0365466
	speed: 0.1535s/iter; left time: 1821.1282s
	iters: 3700, epoch: 4 | loss: 0.0331397
	speed: 0.1535s/iter; left time: 1806.1747s
	iters: 3800, epoch: 4 | loss: 0.0341512
	speed: 0.1533s/iter; left time: 1788.7954s
	iters: 3900, epoch: 4 | loss: 0.0364618
	speed: 0.1532s/iter; left time: 1772.4765s
	iters: 4000, epoch: 4 | loss: 0.0366403
	speed: 0.1535s/iter; left time: 1760.0723s
	iters: 4100, epoch: 4 | loss: 0.0339874
	speed: 0.1535s/iter; left time: 1744.8056s
	iters: 4200, epoch: 4 | loss: 0.0304135
	speed: 0.1534s/iter; left time: 1727.7954s
	iters: 4300, epoch: 4 | loss: 0.0397354
	speed: 0.1532s/iter; left time: 1711.1834s
	iters: 4400, epoch: 4 | loss: 0.0341913
	speed: 0.1534s/iter; left time: 1697.7339s
	iters: 4500, epoch: 4 | loss: 0.0291866
	speed: 0.1535s/iter; left time: 1683.3879s
	iters: 4600, epoch: 4 | loss: 0.0317575
	speed: 0.1534s/iter; left time: 1667.5238s
	iters: 4700, epoch: 4 | loss: 0.0386068
	speed: 0.1535s/iter; left time: 1652.2280s
	iters: 4800, epoch: 4 | loss: 0.0287985
	speed: 0.1534s/iter; left time: 1636.5685s
	iters: 4900, epoch: 4 | loss: 0.0317879
	speed: 0.1530s/iter; left time: 1616.2859s
	iters: 5000, epoch: 4 | loss: 0.0341188
	speed: 0.1535s/iter; left time: 1606.2238s
	iters: 5100, epoch: 4 | loss: 0.0365678
	speed: 0.1535s/iter; left time: 1591.5798s
	iters: 5200, epoch: 4 | loss: 0.0331928
	speed: 0.1535s/iter; left time: 1576.3236s
	iters: 5300, epoch: 4 | loss: 0.0310908
	speed: 0.1535s/iter; left time: 1560.5578s
	iters: 5400, epoch: 4 | loss: 0.0344279
	speed: 0.1540s/iter; left time: 1550.0953s
	iters: 5500, epoch: 4 | loss: 0.0357773
	speed: 0.1539s/iter; left time: 1534.0187s
	iters: 5600, epoch: 4 | loss: 0.0381795
	speed: 0.1536s/iter; left time: 1515.5116s
	iters: 5700, epoch: 4 | loss: 0.0303404
	speed: 0.1535s/iter; left time: 1499.4913s
	iters: 5800, epoch: 4 | loss: 0.0321298
	speed: 0.1535s/iter; left time: 1483.7128s
	iters: 5900, epoch: 4 | loss: 0.0348683
	speed: 0.1535s/iter; left time: 1468.7689s
	iters: 6000, epoch: 4 | loss: 0.0304745
	speed: 0.1534s/iter; left time: 1452.6185s
	iters: 6100, epoch: 4 | loss: 0.0350935
	speed: 0.1535s/iter; left time: 1437.9328s
	iters: 6200, epoch: 4 | loss: 0.0355925
	speed: 0.1535s/iter; left time: 1422.1743s
	iters: 6300, epoch: 4 | loss: 0.0323947
	speed: 0.1534s/iter; left time: 1406.6078s
	iters: 6400, epoch: 4 | loss: 0.0289599
	speed: 0.1533s/iter; left time: 1390.0946s
	iters: 6500, epoch: 4 | loss: 0.0319241
	speed: 0.1534s/iter; left time: 1375.8920s
	iters: 6600, epoch: 4 | loss: 0.0361583
	speed: 0.1535s/iter; left time: 1361.1908s
	iters: 6700, epoch: 4 | loss: 0.0325847
	speed: 0.1534s/iter; left time: 1345.2308s
	iters: 6800, epoch: 4 | loss: 0.0339970
	speed: 0.1535s/iter; left time: 1329.9717s
	iters: 6900, epoch: 4 | loss: 0.0327382
	speed: 0.1535s/iter; left time: 1314.6976s
	iters: 7000, epoch: 4 | loss: 0.0281169
	speed: 0.1534s/iter; left time: 1298.9117s
	iters: 7100, epoch: 4 | loss: 0.0341648
	speed: 0.1534s/iter; left time: 1283.4061s
	iters: 7200, epoch: 4 | loss: 0.0293822
	speed: 0.1534s/iter; left time: 1268.0377s
	iters: 7300, epoch: 4 | loss: 0.0304021
	speed: 0.1535s/iter; left time: 1253.6496s
	iters: 7400, epoch: 4 | loss: 0.0310401
	speed: 0.1539s/iter; left time: 1241.5391s
	iters: 7500, epoch: 4 | loss: 0.0344083
	speed: 0.1534s/iter; left time: 1222.1248s
	iters: 7600, epoch: 4 | loss: 0.0338455
	speed: 0.1535s/iter; left time: 1207.2257s
	iters: 7700, epoch: 4 | loss: 0.0298258
	speed: 0.1530s/iter; left time: 1188.6525s
Epoch: 4 cost time: 1187.917153596878
test: (449919, 51)
train: (495000, 51)
test 449820
test: (449919, 51)
train: (495000, 51)
train 494901
Threshold : 0.18660814382135804
pred:    (44982000,)
gt:      (44982000,)
pred:  (44982000,)
gt:    (44982000,)
Accuracy : 0.9860, Precision : 0.9597, Recall : 0.9237, F-score : 0.9413 
Epoch: 4, Steps: 7733 | Train Loss: 0.0328391 Vali Loss: 0.0029421
Validation loss decreased (0.003342 --> 0.002942).  Saving model ...
lr_adjust = {4: 9e-05}
Updating learning rate to 9e-05
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [2:31:06<37:46, 2266.74s/it]  	iters: 100, epoch: 5 | loss: 0.0340697
	speed: 11.0052s/iter; left time: 84013.9177s
	iters: 200, epoch: 5 | loss: 0.0328311
	speed: 0.1516s/iter; left time: 1142.4811s
	iters: 300, epoch: 5 | loss: 0.0311263
	speed: 0.1522s/iter; left time: 1131.6000s
	iters: 400, epoch: 5 | loss: 0.0340480
	speed: 0.1528s/iter; left time: 1120.7319s
	iters: 500, epoch: 5 | loss: 0.0323046
	speed: 0.1528s/iter; left time: 1105.4005s
	iters: 600, epoch: 5 | loss: 0.0303194
	speed: 0.1526s/iter; left time: 1088.6006s
	iters: 700, epoch: 5 | loss: 0.0346983
	speed: 0.1533s/iter; left time: 1078.2481s
	iters: 800, epoch: 5 | loss: 0.0305820
	speed: 0.1529s/iter; left time: 1060.1141s
	iters: 900, epoch: 5 | loss: 0.0327092
	speed: 0.1526s/iter; left time: 1043.1382s
	iters: 1000, epoch: 5 | loss: 0.0334361
	speed: 0.1530s/iter; left time: 1030.1787s
	iters: 1100, epoch: 5 | loss: 0.0324465
	speed: 0.1530s/iter; left time: 1015.1728s
	iters: 1200, epoch: 5 | loss: 0.0301268
	speed: 0.1530s/iter; left time: 1000.0040s
	iters: 1300, epoch: 5 | loss: 0.0326008
	speed: 0.1530s/iter; left time: 984.5968s
	iters: 1400, epoch: 5 | loss: 0.0329109
	speed: 0.1527s/iter; left time: 967.1411s
	iters: 1500, epoch: 5 | loss: 0.0318134
	speed: 0.1526s/iter; left time: 951.5695s
	iters: 1600, epoch: 5 | loss: 0.0322060
	speed: 0.1529s/iter; left time: 938.0564s
	iters: 1700, epoch: 5 | loss: 0.0292097
	speed: 0.1544s/iter; left time: 931.9422s
	iters: 1800, epoch: 5 | loss: 0.0320902
	speed: 0.1535s/iter; left time: 910.6101s
	iters: 1900, epoch: 5 | loss: 0.0317044
	speed: 0.1538s/iter; left time: 897.4316s
	iters: 2000, epoch: 5 | loss: 0.0302693
	speed: 0.1541s/iter; left time: 883.8854s
	iters: 2100, epoch: 5 | loss: 0.0296552
	speed: 0.1541s/iter; left time: 868.0903s
	iters: 2200, epoch: 5 | loss: 0.0350398
	speed: 0.1540s/iter; left time: 852.3283s
	iters: 2300, epoch: 5 | loss: 0.0328047
	speed: 0.1541s/iter; left time: 837.5375s
	iters: 2400, epoch: 5 | loss: 0.0280514
	speed: 0.1541s/iter; left time: 821.9281s
	iters: 2500, epoch: 5 | loss: 0.0311565
	speed: 0.1541s/iter; left time: 806.3460s
	iters: 2600, epoch: 5 | loss: 0.0344662
	speed: 0.1535s/iter; left time: 788.1671s
	iters: 2700, epoch: 5 | loss: 0.0356444
	speed: 0.1541s/iter; left time: 775.7203s
	iters: 2800, epoch: 5 | loss: 0.0283959
	speed: 0.1541s/iter; left time: 760.1813s
	iters: 2900, epoch: 5 | loss: 0.0352986
	speed: 0.1537s/iter; left time: 743.0204s
	iters: 3000, epoch: 5 | loss: 0.0327270
	speed: 0.1537s/iter; left time: 727.6322s
	iters: 3100, epoch: 5 | loss: 0.0304441
	speed: 0.1534s/iter; left time: 710.6825s
	iters: 3200, epoch: 5 | loss: 0.0274853
	speed: 0.1535s/iter; left time: 695.9417s
	iters: 3300, epoch: 5 | loss: 0.0270096
	speed: 0.1534s/iter; left time: 680.3316s
	iters: 3400, epoch: 5 | loss: 0.0292345
	speed: 0.1534s/iter; left time: 665.0478s
	iters: 3500, epoch: 5 | loss: 0.0326941
	speed: 0.1534s/iter; left time: 649.6376s
	iters: 3600, epoch: 5 | loss: 0.0332433
	speed: 0.1535s/iter; left time: 634.4500s
	iters: 3700, epoch: 5 | loss: 0.0289107
	speed: 0.1534s/iter; left time: 618.8583s
	iters: 3800, epoch: 5 | loss: 0.0333061
	speed: 0.1533s/iter; left time: 603.2544s
	iters: 3900, epoch: 5 | loss: 0.0318297
	speed: 0.1534s/iter; left time: 588.2316s
	iters: 4000, epoch: 5 | loss: 0.0303893
	speed: 0.1534s/iter; left time: 572.6804s
	iters: 4100, epoch: 5 | loss: 0.0322157
	speed: 0.1534s/iter; left time: 557.4359s
	iters: 4200, epoch: 5 | loss: 0.0314142
	speed: 0.1534s/iter; left time: 542.2898s
	iters: 4300, epoch: 5 | loss: 0.0310198
	speed: 0.1535s/iter; left time: 527.0101s
	iters: 4400, epoch: 5 | loss: 0.0287858
	speed: 0.1536s/iter; left time: 512.0752s
	iters: 4500, epoch: 5 | loss: 0.0310446
	speed: 0.1540s/iter; left time: 498.0683s
	iters: 4600, epoch: 5 | loss: 0.0266156
	speed: 0.1536s/iter; left time: 481.2497s
	iters: 4700, epoch: 5 | loss: 0.0292658
	speed: 0.1533s/iter; left time: 465.1655s
	iters: 4800, epoch: 5 | loss: 0.0326478
	speed: 0.1536s/iter; left time: 450.7561s
	iters: 4900, epoch: 5 | loss: 0.0330767
	speed: 0.1533s/iter; left time: 434.5741s
	iters: 5000, epoch: 5 | loss: 0.0295055
	speed: 0.1533s/iter; left time: 418.9903s
	iters: 5100, epoch: 5 | loss: 0.0328832
	speed: 0.1538s/iter; left time: 405.1754s
	iters: 5200, epoch: 5 | loss: 0.0307843
	speed: 0.1539s/iter; left time: 390.0594s
	iters: 5300, epoch: 5 | loss: 0.0280398
	speed: 0.1541s/iter; left time: 375.0764s
	iters: 5400, epoch: 5 | loss: 0.0303440
	speed: 0.1540s/iter; left time: 359.4791s
	iters: 5500, epoch: 5 | loss: 0.0303888
	speed: 0.1538s/iter; left time: 343.6449s
	iters: 5600, epoch: 5 | loss: 0.0294477
	speed: 0.1531s/iter; left time: 326.7037s
	iters: 5700, epoch: 5 | loss: 0.0280341
	speed: 0.1533s/iter; left time: 311.8804s
	iters: 5800, epoch: 5 | loss: 0.0350697
	speed: 0.1533s/iter; left time: 296.4467s
	iters: 5900, epoch: 5 | loss: 0.0294351
	speed: 0.1533s/iter; left time: 281.2178s
	iters: 6000, epoch: 5 | loss: 0.0308756
	speed: 0.1534s/iter; left time: 266.0024s
	iters: 6100, epoch: 5 | loss: 0.0348906
	speed: 0.1537s/iter; left time: 251.1390s
	iters: 6200, epoch: 5 | loss: 0.0291656
	speed: 0.1532s/iter; left time: 235.0027s
	iters: 6300, epoch: 5 | loss: 0.0293493
	speed: 0.1533s/iter; left time: 219.8927s
	iters: 6400, epoch: 5 | loss: 0.0314479
	speed: 0.1534s/iter; left time: 204.6622s
	iters: 6500, epoch: 5 | loss: 0.0299112
	speed: 0.1534s/iter; left time: 189.2741s
	iters: 6600, epoch: 5 | loss: 0.0319811
	speed: 0.1533s/iter; left time: 173.8981s
	iters: 6700, epoch: 5 | loss: 0.0303069
	speed: 0.1534s/iter; left time: 158.5953s
	iters: 6800, epoch: 5 | loss: 0.0324999
	speed: 0.1533s/iter; left time: 143.1929s
	iters: 6900, epoch: 5 | loss: 0.0367470
	speed: 0.1533s/iter; left time: 127.8788s
	iters: 7000, epoch: 5 | loss: 0.0328112
	speed: 0.1540s/iter; left time: 113.0301s
	iters: 7100, epoch: 5 | loss: 0.0322215
	speed: 0.1538s/iter; left time: 97.4823s
	iters: 7200, epoch: 5 | loss: 0.0329623
	speed: 0.1535s/iter; left time: 81.9620s
	iters: 7300, epoch: 5 | loss: 0.0312782
	speed: 0.1536s/iter; left time: 66.6807s
	iters: 7400, epoch: 5 | loss: 0.0309943
	speed: 0.1535s/iter; left time: 51.2840s
	iters: 7500, epoch: 5 | loss: 0.0337167
	speed: 0.1535s/iter; left time: 35.9104s
	iters: 7600, epoch: 5 | loss: 0.0341338
	speed: 0.1534s/iter; left time: 20.5524s
	iters: 7700, epoch: 5 | loss: 0.0334965
	speed: 0.1532s/iter; left time: 5.2098s
Epoch: 5 cost time: 1187.5515909194946
test: (449919, 51)
train: (495000, 51)
test 449820
test: (449919, 51)
train: (495000, 51)
train 494901
Threshold : 0.17683349080383515
pred:    (44982000,)
gt:      (44982000,)
pred:  (44982000,)
gt:    (44982000,)
Accuracy : 0.9860, Precision : 0.9597, Recall : 0.9237, F-score : 0.9413 
Epoch: 5, Steps: 7733 | Train Loss: 0.0317990 Vali Loss: 0.0027197
Validation loss decreased (0.002942 --> 0.002720).  Saving model ...
lr_adjust = {5: 8.1e-05}
Updating learning rate to 8.1e-05
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [3:08:51<00:00, 2266.22s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [3:08:51<00:00, 2266.30s/it]
>>>>>>>testing : anomaly_detection_SWAT_CALF_SWAT_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test: (449919, 51)
train: (495000, 51)
test 449820
test: (449919, 51)
train: (495000, 51)
train 494901
Threshold : 0.17683349080383515
pred:    (44982000,)
gt:      (44982000,)
pred:  (44982000,)
gt:    (44982000,)
Accuracy : 0.9860, Precision : 0.9597, Recall : 0.9237, F-score : 0.9413 
Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           MSL                 Model:              CALF                

[1mData Loader[0m
  Data:               MSL                 Root Path:          /home/nathan/LLM4TS/datasets/anomaly_detection/MSL
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      2.0                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             55                  Dec In:             7                   
  C Out:              55                  d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.3                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       5                   Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                test                Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : anomaly_detection_MSL_CALF_MSL_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
test: (73729, 55)
train: (58317, 55)
train 58218
test: (73729, 55)
train: (58317, 55)
val 11565
test: (73729, 55)
train: (58317, 55)
test 73630
  0%|          | 0/5 [00:00<?, ?it/s]Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           PSM                 Model:              CALF                

[1mData Loader[0m
  Data:               PSM                 Root Path:          /home/nathan/LLM4TS/datasets/anomaly_detection/PSM
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             25                  Dec In:             7                   
  C Out:              25                  d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.3                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       5                   Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/data_provider/data_loader.py", line 8, in <module>
    from sklearn.preprocessing import StandardScaler
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/sklearn/__init__.py", line 87, in <module>
    from .base import clone
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/sklearn/base.py", line 19, in <module>
    from .utils import _IS_32BIT
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/sklearn/utils/__init__.py", line 22, in <module>
    from ._estimator_html_repr import estimator_html_repr
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/sklearn/utils/_estimator_html_repr.py", line 10, in <module>
    from .fixes import parse_version
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/sklearn/utils/fixes.py", line 17, in <module>
    import scipy.stats
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/scipy/stats/__init__.py", line 605, in <module>
    from ._stats_py import *
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/scipy/stats/_stats_py.py", line 9116, in <module>
    def ranksums(x, y, alternative='two-sided'):
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/scipy/stats/_axis_nan_policy.py", line 608, in axis_nan_policy_decorator
    doc = FunctionDoc(axis_nan_policy_wrapper)
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/scipy/_lib/_docscrape.py", line 570, in __init__
    NumpyDocString.__init__(self, doc, config)
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/scipy/_lib/_docscrape.py", line 148, in __init__
    self._parse()
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/scipy/_lib/_docscrape.py", line 398, in _parse
    self[section] = self._parse_param_list(content)
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/scipy/_lib/_docscrape.py", line 232, in _parse_param_list
    desc = dedent_lines(desc)
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/site-packages/scipy/_lib/_docscrape.py", line 554, in dedent_lines
    return textwrap.dedent("\n".join(lines)).split("\n")
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/textwrap.py", line 469, in dedent
    text = re.sub(r'(?m)^' + margin, '', text)
  File "/opt/conda/Anaconda3/envs/IRTS/lib/python3.10/re.py", line 202, in sub
    def sub(pattern, repl, string, count=0, flags=0):
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/run.py", line 157, in <module>
    exp = Exp(args)  # set experiments
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/exp/exp_anomaly_detection.py", line 23, in __init__
    super(Exp_Anomaly_Detection, self).__init__(args)
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/exp/exp_basic.py", line 13, in __init__
    self.model = self._build_model().to(self.device)
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/exp/exp_anomaly_detection.py", line 26, in _build_model
    model = self.model_dict[self.args.model].Model(self.args, self.device).float()
  File "/home/nathan/LLM4TS/Anomaly_Detection_task/CALF/models/CALF.py", line 118, in __init__
    word_embedding = torch.tensor(torch.load(configs.word_embedding_path)).to(device=device)
KeyboardInterrupt
Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           PSM                 Model:              CALF                

[1mData Loader[0m
  Data:               PSM                 Root Path:          /home/nathan/LLM4TS/datasets/anomaly_detection/PSM
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             25                  Dec In:             7                   
  C Out:              25                  d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.3                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       5                   Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : anomaly_detection_PSM_CALF_PSM_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
test: (87841, 25)
train: (132481, 25)
train 132382
Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           SMAP                Model:              CALF                

[1mData Loader[0m
  Data:               SMAP                Root Path:          /home/nathan/LLM4TS/datasets/anomaly_detection/SMAP
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      1.0                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             25                  Dec In:             7                   
  C Out:              25                  d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.3                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       5                   Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
test: (87841, 25)
train: (132481, 25)
val 26398
test: (87841, 25)
train: (132481, 25)
test 87742
  0%|          | 0/5 [00:00<?, ?it/s]>>>>>>>start training : anomaly_detection_SMAP_CALF_SMAP_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
test: (427617, 25)
train: (135183, 25)
train 135084
test: (427617, 25)
train: (135183, 25)
val 26938
test: (427617, 25)
train: (135183, 25)
test 427518
  0%|          | 0/5 [00:00<?, ?it/s]	iters: 100, epoch: 1 | loss: 0.1706948
	speed: 0.3315s/iter; left time: 1475.6124s
Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           SMD                 Model:              CALF                

[1mData Loader[0m
  Data:               SMD                 Root Path:          /home/nathan/LLM4TS/datasets/anomaly_detection/SMD
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             38                  Dec In:             7                   
  C Out:              38                  d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.3                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       5                   Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
Args in experiment:
[1mBasic Config[0m
  Task Name:          anomaly_detection   Is Training:        1                   
  Model ID:           SWAT                Model:              CALF                

[1mData Loader[0m
  Data:               SWAT                Root Path:          /home/nathan/LLM4TS/datasets/anomaly_detection/SWaT
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mAnomaly Detection Task[0m
  Anomaly Ratio:      0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             51                  Dec In:             7                   
  C Out:              51                  d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.3                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       5                   Batch Size:         64                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : anomaly_detection_SMD_CALF_SMD_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7084
val 1416
test 7084
  0%|          | 0/5 [00:00<?, ?it/s]>>>>>>>start training : anomaly_detection_SWAT_CALF_SWAT_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 100, epoch: 1 | loss: 0.4006905
	speed: 0.3873s/iter; left time: 3968.7667s
test: (449919, 51)
train: (495000, 51)
train 494901
test: (449919, 51)
train: (495000, 51)
val 98901
	iters: 100, epoch: 1 | loss: 0.5191623
	speed: 0.4344s/iter; left time: 4542.0782s
test: (449919, 51)
train: (495000, 51)
test 449820
  0%|          | 0/5 [00:00<?, ?it/s]	iters: 200, epoch: 1 | loss: 0.1383924
	speed: 0.7777s/iter; left time: 3383.7274s
	iters: 200, epoch: 1 | loss: 0.3638513
	speed: 0.5061s/iter; left time: 5135.0244s
	iters: 200, epoch: 1 | loss: 0.3446206
	speed: 0.5273s/iter; left time: 5460.9111s
	iters: 100, epoch: 1 | loss: 0.2808646
	speed: 0.8025s/iter; left time: 365.9424s
Epoch: 1 cost time: 88.6103093624115
test 7084
train 7084
	iters: 300, epoch: 1 | loss: 0.3243316
	speed: 0.5429s/iter; left time: 5454.4743s
	iters: 100, epoch: 1 | loss: 0.1371393
	speed: 1.0463s/iter; left time: 40349.7809s
	iters: 300, epoch: 1 | loss: 0.3699112
	speed: 0.5438s/iter; left time: 5577.1893s
	iters: 300, epoch: 1 | loss: 0.1092191
	speed: 0.9969s/iter; left time: 4237.9767s
	iters: 400, epoch: 1 | loss: 0.3045434
	speed: 0.5462s/iter; left time: 5432.3997s
Threshold : 4.475206615924819
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9865, Precision : 0.8689, Recall : 0.7947, F-score : 0.8301 
Epoch: 1, Steps: 111 | Train Loss: 0.4356940 Vali Loss: 0.1761091
Validation loss decreased (inf --> 0.176109).  Saving model ...
lr_adjust = {1: 0.0001}
Updating learning rate to 0.0001
 20%|â–ˆâ–ˆ        | 1/5 [02:52<11:29, 172.35s/it]	iters: 400, epoch: 1 | loss: 0.2791903
	speed: 0.5409s/iter; left time: 5493.1300s
	iters: 200, epoch: 1 | loss: 0.1357015
	speed: 0.9609s/iter; left time: 36962.7965s
	iters: 500, epoch: 1 | loss: 0.2718190
	speed: 0.5431s/iter; left time: 5346.9862s
	iters: 500, epoch: 1 | loss: 0.3065085
	speed: 0.5489s/iter; left time: 5519.4693s
	iters: 100, epoch: 2 | loss: 0.2729980
	speed: 1.6894s/iter; left time: 582.8466s
	iters: 400, epoch: 1 | loss: 0.0983989
	speed: 1.0005s/iter; left time: 4153.1707s
Epoch: 2 cost time: 85.20371103286743
test 7084
train 7084
	iters: 600, epoch: 1 | loss: 0.2588309
	speed: 0.5433s/iter; left time: 5295.3518s
	iters: 600, epoch: 1 | loss: 0.2402961
	speed: 0.5436s/iter; left time: 5411.6461s
	iters: 300, epoch: 1 | loss: 0.1147280
	speed: 0.9658s/iter; left time: 37053.5079s
	iters: 700, epoch: 1 | loss: 0.2692689
	speed: 0.5476s/iter; left time: 5282.2272s
Threshold : 3.4577568542956483
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9868, Precision : 0.8688, Recall : 0.8025, F-score : 0.8344 
Epoch: 2, Steps: 111 | Train Loss: 0.2713930 Vali Loss: 0.1436373
Validation loss decreased (0.176109 --> 0.143637).  Saving model ...
	iters: 700, epoch: 1 | loss: 0.2787854
	speed: 0.5420s/iter; left time: 5341.4677s
lr_adjust = {2: 0.0001}
Updating learning rate to 0.0001
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [05:41<08:30, 170.27s/it]	iters: 500, epoch: 1 | loss: 0.0978313
	speed: 0.9915s/iter; left time: 4016.6673s
	iters: 800, epoch: 1 | loss: 0.2461312
	speed: 0.5385s/iter; left time: 5140.7006s
	iters: 800, epoch: 1 | loss: 0.2553337
	speed: 0.5447s/iter; left time: 5314.1513s
	iters: 400, epoch: 1 | loss: 0.1013490
	speed: 0.9603s/iter; left time: 36745.7263s
	iters: 100, epoch: 3 | loss: 0.2515871
	speed: 1.6868s/iter; left time: 394.7050s
Epoch: 3 cost time: 85.09514212608337
test 7084
train 7084
	iters: 900, epoch: 1 | loss: 0.2576669
	speed: 0.5426s/iter; left time: 5125.1901s
	iters: 900, epoch: 1 | loss: 0.2458344
	speed: 0.5418s/iter; left time: 5231.6173s
	iters: 600, epoch: 1 | loss: 0.0824601
	speed: 1.0003s/iter; left time: 3952.1842s
	iters: 1000, epoch: 1 | loss: 0.2330730
	speed: 0.5485s/iter; left time: 5126.5814s
	iters: 1000, epoch: 1 | loss: 0.2223067
	speed: 0.5489s/iter; left time: 5245.0132s
	iters: 500, epoch: 1 | loss: 0.1006789
	speed: 0.9617s/iter; left time: 36703.0801s
Threshold : 3.03060788512229
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9868, Precision : 0.8686, Recall : 0.8039, F-score : 0.8350 
Epoch: 3, Steps: 111 | Train Loss: 0.2404702 Vali Loss: 0.1273146
Validation loss decreased (0.143637 --> 0.127315).  Saving model ...
lr_adjust = {3: 0.0001}
Updating learning rate to 0.0001
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [08:31<05:40, 170.07s/it]	iters: 1100, epoch: 1 | loss: 0.2228285
	speed: 0.5421s/iter; left time: 5012.3639s
	iters: 700, epoch: 1 | loss: 0.0831140
	speed: 0.9992s/iter; left time: 3848.0952s
	iters: 1100, epoch: 1 | loss: 0.2411325
	speed: 0.5429s/iter; left time: 5134.0440s
	iters: 100, epoch: 4 | loss: 0.2057301
	speed: 1.6979s/iter; left time: 208.8413s
Epoch: 4 cost time: 85.03425097465515
	iters: 1200, epoch: 1 | loss: 0.2017929
	speed: 0.5457s/iter; left time: 4991.3464s
	iters: 600, epoch: 1 | loss: 0.0942894
	speed: 0.9596s/iter; left time: 36526.9101s
test 7084
train 7084
	iters: 1200, epoch: 1 | loss: 0.2293013
	speed: 0.5395s/iter; left time: 5047.4954s
	iters: 800, epoch: 1 | loss: 0.0731879
	speed: 0.9961s/iter; left time: 3736.5397s
	iters: 1300, epoch: 1 | loss: 0.2121519
	speed: 0.5428s/iter; left time: 4910.3736s
	iters: 1300, epoch: 1 | loss: 0.2132437
	speed: 0.5476s/iter; left time: 5069.0291s
Threshold : 2.7988343691825803
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9867, Precision : 0.8685, Recall : 0.8010, F-score : 0.8334 
Epoch: 4, Steps: 111 | Train Loss: 0.2217611 Vali Loss: 0.1136384
Validation loss decreased (0.127315 --> 0.113638).  Saving model ...
lr_adjust = {4: 9e-05}
Updating learning rate to 9e-05
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [11:20<02:49, 169.83s/it]	iters: 700, epoch: 1 | loss: 0.0754066
	speed: 0.9563s/iter; left time: 36308.4562s
	iters: 1400, epoch: 1 | loss: 0.2026244
	speed: 0.5416s/iter; left time: 4844.8658s
	iters: 1400, epoch: 1 | loss: 0.2116429
	speed: 0.5421s/iter; left time: 4963.7893s
	iters: 900, epoch: 1 | loss: 0.0716097
	speed: 1.0000s/iter; left time: 3650.9851s
	iters: 100, epoch: 5 | loss: 0.2164030
	speed: 1.6967s/iter; left time: 20.3607s
Epoch: 1 cost time: 819.4758379459381
	iters: 1500, epoch: 1 | loss: 0.1903101
	speed: 0.5491s/iter; left time: 4857.4669s
Epoch: 5 cost time: 85.20550060272217
test 7084
train 7084
	iters: 1500, epoch: 1 | loss: 0.2173366
	speed: 0.5397s/iter; left time: 4887.7231s
	iters: 800, epoch: 1 | loss: 0.0937034
	speed: 0.9606s/iter; left time: 36374.1699s
	iters: 1600, epoch: 1 | loss: 0.1976678
	speed: 0.5372s/iter; left time: 4698.4678s
	iters: 1600, epoch: 1 | loss: 0.2158514
	speed: 0.5472s/iter; left time: 4900.4181s
test: (73729, 55)
train: (58317, 55)
test 73630
test: (73729, 55)
train: (58317, 55)
train 58218
Threshold : 2.6499624955653918
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9865, Precision : 0.8674, Recall : 0.7983, F-score : 0.8314 
Epoch: 5, Steps: 111 | Train Loss: 0.2086425 Vali Loss: 0.1067072
Validation loss decreased (0.113638 --> 0.106707).  Saving model ...
lr_adjust = {5: 8.1e-05}
Updating learning rate to 8.1e-05
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [14:07<00:00, 168.94s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [14:07<00:00, 169.57s/it]
>>>>>>>testing : anomaly_detection_SMD_CALF_SMD_ftM_sl100_ll48_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_test_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7084
train 7084
	iters: 1700, epoch: 1 | loss: 0.1920868
	speed: 0.5355s/iter; left time: 4629.7623s
	iters: 1700, epoch: 1 | loss: 0.2091480
	speed: 0.5354s/iter; left time: 4741.8282s
	iters: 900, epoch: 1 | loss: 0.0869562
	speed: 0.9534s/iter; left time: 36004.2987s
Threshold : 2.6499624955653918
pred:    (708400,)
gt:      (708400,)
pred:  (708400,)
gt:    (708400,)
Accuracy : 0.9865, Precision : 0.8674, Recall : 0.7983, F-score : 0.8314 
	iters: 1800, epoch: 1 | loss: 0.1800419
	speed: 0.5390s/iter; left time: 4605.9232s
	iters: 1800, epoch: 1 | loss: 0.1974273
	speed: 0.5190s/iter; left time: 4544.2421s
	iters: 1900, epoch: 1 | loss: 0.1783117
	speed: 0.4540s/iter; left time: 3834.1228s
	iters: 1000, epoch: 1 | loss: 0.0666391
	speed: 0.8511s/iter; left time: 32058.8710s
	iters: 1900, epoch: 1 | loss: 0.1744621
	speed: 0.4506s/iter; left time: 3900.7641s
	iters: 2000, epoch: 1 | loss: 0.1844637
	speed: 0.4507s/iter; left time: 3761.4693s
	iters: 2000, epoch: 1 | loss: 0.1736101
	speed: 0.4533s/iter; left time: 3878.2001s
Epoch: 1 cost time: 1079.585604429245
	iters: 1100, epoch: 1 | loss: 0.0648111
	speed: 0.7981s/iter; left time: 29981.5287s
	iters: 2100, epoch: 1 | loss: 0.1396536
	speed: 0.4486s/iter; left time: 3793.2189s
Epoch: 1 cost time: 1103.3155992031097
test: (87841, 25)
train: (132481, 25)
test 87742
	iters: 1200, epoch: 1 | loss: 0.0664017
	speed: 0.7745s/iter; left time: 29018.4415s
test: (87841, 25)
train: (132481, 25)
train 132382
test: (427617, 25)
train: (135183, 25)
test 427518
test: (427617, 25)
train: (135183, 25)
train 135084
	iters: 1300, epoch: 1 | loss: 0.0694387
	speed: 0.7855s/iter; left time: 29352.4681s
	iters: 1400, epoch: 1 | loss: 0.0638717
	speed: 0.7984s/iter; left time: 29754.1928s
	iters: 1500, epoch: 1 | loss: 0.0743198
	speed: 0.7940s/iter; left time: 29508.4882s
	iters: 1600, epoch: 1 | loss: 0.0561744
	speed: 0.7981s/iter; left time: 29583.2911s
	iters: 1700, epoch: 1 | loss: 0.0578524
	speed: 0.7930s/iter; left time: 29312.9931s
Threshold : 3.002240920066833
pred:    (7363000,)
gt:      (7363000,)
pred:  (7363000,)
gt:    (7363000,)
Accuracy : 0.9642, Precision : 0.8316, Recall : 0.8287, F-score : 0.8302 
Epoch: 1, Steps: 910 | Train Loss: 0.1159061 Vali Loss: 0.4915864
Validation loss decreased (inf --> 0.491586).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
 20%|â–ˆâ–ˆ        | 1/5 [26:39<1:46:39, 1599.89s/it]Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh2_mask_0.125    Model:              CALF                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.125               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh2_mask_0.125_CALF_ETTh2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.5571035
	speed: 0.0703s/iter; left time: 368.4305s
	iters: 200, epoch: 1 | loss: 0.8796791
	speed: 0.0585s/iter; left time: 300.7114s
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTm1_mask_0.125    Model:              CALF                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.125               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
	iters: 300, epoch: 1 | loss: 2.1191189
	speed: 0.0612s/iter; left time: 308.5497s
>>>>>>>start training : imputation_ETTm1_mask_0.125_CALF_ETTm1_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt3_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34465
val 11521
test 11521
	iters: 400, epoch: 1 | loss: 3.4922614
	speed: 0.0622s/iter; left time: 307.3118s
	iters: 100, epoch: 1 | loss: 0.6163245
	speed: 0.0528s/iter; left time: 6820.6772s
	iters: 500, epoch: 1 | loss: 5.0792184
	speed: 0.0510s/iter; left time: 247.0834s
Epoch: 1 cost time: 32.08980989456177
	iters: 200, epoch: 1 | loss: 1.1407862
	speed: 0.0403s/iter; left time: 5202.5046s
	iters: 300, epoch: 1 | loss: 1.8205132
	speed: 0.0455s/iter; left time: 5872.4175s
	iters: 400, epoch: 1 | loss: 3.4069920
	speed: 0.0448s/iter; left time: 5771.5045s
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Imputation_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Imputation_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_loader.py", line 10, in <module>
    from data_provider.m4 import M4Dataset, M4Meta
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/m4.py", line 26, in <module>
    import patoolib
ModuleNotFoundError: No module named 'patoolib'
	iters: 500, epoch: 1 | loss: 4.4108677
	speed: 0.0470s/iter; left time: 6051.1233s
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Imputation_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Imputation_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_loader.py", line 10, in <module>
    from data_provider.m4 import M4Dataset, M4Meta
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/m4.py", line 26, in <module>
    import patoolib
ModuleNotFoundError: No module named 'patoolib'
	iters: 600, epoch: 1 | loss: 4.4689646
	speed: 0.0473s/iter; left time: 6082.0151s
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Imputation_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Imputation_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_loader.py", line 10, in <module>
    from data_provider.m4 import M4Dataset, M4Meta
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/m4.py", line 26, in <module>
    import patoolib
ModuleNotFoundError: No module named 'patoolib'
	iters: 700, epoch: 1 | loss: 3.7444036
	speed: 0.0474s/iter; left time: 6094.5713s
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Imputation_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Imputation_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_loader.py", line 10, in <module>
    from data_provider.m4 import M4Dataset, M4Meta
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/m4.py", line 26, in <module>
    import patoolib
ModuleNotFoundError: No module named 'patoolib'
	iters: 800, epoch: 1 | loss: 3.9004388
	speed: 0.0454s/iter; left time: 5830.3694s
	iters: 900, epoch: 1 | loss: 7.9515610
	speed: 0.0416s/iter; left time: 5336.7875s
	iters: 1000, epoch: 1 | loss: 6.6930227
	speed: 0.0439s/iter; left time: 5625.9205s
	iters: 1100, epoch: 1 | loss: 6.0661373
	speed: 0.0406s/iter; left time: 5198.2987s
	iters: 1200, epoch: 1 | loss: 11.7682476
	speed: 0.0369s/iter; left time: 4725.3837s
	iters: 1300, epoch: 1 | loss: 10.8148346
	speed: 0.0351s/iter; left time: 4489.2234s
	iters: 1400, epoch: 1 | loss: 9.2849455
	speed: 0.0366s/iter; left time: 4676.1592s
	iters: 1500, epoch: 1 | loss: 20.0250206
	speed: 0.0396s/iter; left time: 5053.4131s
	iters: 1600, epoch: 1 | loss: 10.0230427
	speed: 0.0379s/iter; left time: 4843.6045s
Epoch: 1, Steps: 534 | Train Loss: 1.9533755 Vali Loss: 0.0883627 Test Loss: 0.1158710
Validation loss decreased (inf --> 0.088363).  Saving model ...
	iters: 1700, epoch: 1 | loss: 11.9090919
	speed: 0.0452s/iter; left time: 5760.0955s
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 1800, epoch: 1 | loss: 11.4564209
	speed: 0.0455s/iter; left time: 5793.1944s
	iters: 100, epoch: 2 | loss: 4.6492906
	speed: 0.7170s/iter; left time: 3375.1244s
	iters: 1900, epoch: 1 | loss: 19.9221287
	speed: 0.0441s/iter; left time: 5618.8614s
	iters: 200, epoch: 2 | loss: 7.8260565
	speed: 0.0507s/iter; left time: 233.4407s
	iters: 2000, epoch: 1 | loss: 17.0223198
	speed: 0.0460s/iter; left time: 5855.2028s
	iters: 300, epoch: 2 | loss: 13.3155088
	speed: 0.0528s/iter; left time: 237.8906s
	iters: 2100, epoch: 1 | loss: 49.9989052
	speed: 0.0461s/iter; left time: 5857.0501s
	iters: 400, epoch: 2 | loss: 13.4070845
	speed: 0.0580s/iter; left time: 255.6100s
	iters: 2200, epoch: 1 | loss: 56.7884598
	speed: 0.0412s/iter; left time: 5237.2976s
	iters: 2300, epoch: 1 | loss: 48.6250191
	speed: 0.0417s/iter; left time: 5296.0953s
	iters: 500, epoch: 2 | loss: 10.5754766
	speed: 0.0513s/iter; left time: 221.1601s
Epoch: 2 cost time: 28.890337467193604
	iters: 2400, epoch: 1 | loss: 54.6878815
	speed: 0.0413s/iter; left time: 5236.5817s
	iters: 2500, epoch: 1 | loss: 61.6105766
	speed: 0.0387s/iter; left time: 4903.3714s
	iters: 2600, epoch: 1 | loss: 43.1147919
	speed: 0.0370s/iter; left time: 4690.2059s
	iters: 2700, epoch: 1 | loss: 49.3379250
	speed: 0.0417s/iter; left time: 5274.8464s
	iters: 2800, epoch: 1 | loss: 34.1913605
	speed: 0.0349s/iter; left time: 4414.9219s
	iters: 2900, epoch: 1 | loss: 47.7046280
	speed: 0.0362s/iter; left time: 4575.5475s
	iters: 3000, epoch: 1 | loss: 39.1101837
	speed: 0.0366s/iter; left time: 4618.4318s
	iters: 3100, epoch: 1 | loss: 52.4475670
	speed: 0.0370s/iter; left time: 4672.5862s
	iters: 3200, epoch: 1 | loss: 43.6639519
	speed: 0.0392s/iter; left time: 4947.0187s
	iters: 3300, epoch: 1 | loss: 32.7164383
	speed: 0.0463s/iter; left time: 5835.1680s
	iters: 3400, epoch: 1 | loss: 54.3515968
	speed: 0.0440s/iter; left time: 5533.8628s
	iters: 3500, epoch: 1 | loss: 332.8096008
	speed: 0.0375s/iter; left time: 4711.6478s
	iters: 3600, epoch: 1 | loss: 80.3948288
	speed: 0.0368s/iter; left time: 4617.3160s
	iters: 3700, epoch: 1 | loss: 1401.0976562
	speed: 0.0357s/iter; left time: 4477.9342s
	iters: 3800, epoch: 1 | loss: 170.2846222
	speed: 0.0359s/iter; left time: 4498.2347s
	iters: 3900, epoch: 1 | loss: 121.3876877
	speed: 0.0365s/iter; left time: 4580.3681s
Epoch: 2, Steps: 534 | Train Loss: 10.3158380 Vali Loss: 0.1253733 Test Loss: 0.1783585
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 4000, epoch: 1 | loss: 101.6804123
	speed: 0.0398s/iter; left time: 4989.3987s
	iters: 4100, epoch: 1 | loss: 93.6685333
	speed: 0.0403s/iter; left time: 5040.6805s
	iters: 100, epoch: 3 | loss: 18.5957184
	speed: 0.6939s/iter; left time: 2895.8180s
	iters: 4200, epoch: 1 | loss: 102.5834351
	speed: 0.0407s/iter; left time: 5086.5419s
	iters: 200, epoch: 3 | loss: 8.6601133
	speed: 0.0531s/iter; left time: 216.1022s
	iters: 4300, epoch: 1 | loss: 209.2898560
	speed: 0.0428s/iter; left time: 5350.5340s
Epoch: 1 cost time: 177.59741878509521
	iters: 300, epoch: 3 | loss: 23.3026581
	speed: 0.0578s/iter; left time: 229.6245s
	iters: 400, epoch: 3 | loss: 18.5978565
	speed: 0.0604s/iter; left time: 234.0780s
	iters: 500, epoch: 3 | loss: 22.1261940
	speed: 0.0587s/iter; left time: 221.5308s
Epoch: 3 cost time: 30.859846115112305
Epoch: 3, Steps: 534 | Train Loss: 15.8176958 Vali Loss: 0.0883818 Test Loss: 0.1157557
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 4 | loss: 458.7529297
	speed: 0.7075s/iter; left time: 2574.4601s
	iters: 200, epoch: 4 | loss: 49.8419571
	speed: 0.0568s/iter; left time: 200.9483s
	iters: 300, epoch: 4 | loss: 41.0469017
	speed: 0.0534s/iter; left time: 183.5054s
	iters: 400, epoch: 4 | loss: 37.3657646
	speed: 0.0532s/iter; left time: 177.5024s
	iters: 500, epoch: 4 | loss: 33.6944504
	speed: 0.0614s/iter; left time: 198.7719s
Epoch: 4 cost time: 31.299575090408325
Epoch: 1, Steps: 4308 | Train Loss: 63.0391310 Vali Loss: 0.5609170 Test Loss: 0.5504519
Validation loss decreased (inf --> 0.560917).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
Epoch: 4, Steps: 534 | Train Loss: 56.6800792 Vali Loss: 0.1647132 Test Loss: 0.2467811
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh2_mask_0.125_CALF_ETTh2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
	iters: 100, epoch: 2 | loss: 1267.7075195
	speed: 1.7605s/iter; left time: 219765.6610s
	iters: 200, epoch: 2 | loss: 729.7215576
	speed: 0.0395s/iter; left time: 4924.1819s
	iters: 300, epoch: 2 | loss: 491.8847351
	speed: 0.0351s/iter; left time: 4372.9495s
	iters: 400, epoch: 2 | loss: 324.1535339
	speed: 0.0435s/iter; left time: 5415.8359s
	iters: 500, epoch: 2 | loss: 705.6077271
	speed: 0.0438s/iter; left time: 5445.8279s
	iters: 600, epoch: 2 | loss: 603.7443237
	speed: 0.0419s/iter; left time: 5210.7124s
	iters: 700, epoch: 2 | loss: 555.6071777
	speed: 0.0387s/iter; left time: 4808.2692s
	iters: 800, epoch: 2 | loss: 440.1444702
	speed: 0.0399s/iter; left time: 4947.7562s
	iters: 900, epoch: 2 | loss: 340.9174805
	speed: 0.0435s/iter; left time: 5400.6081s
	iters: 1000, epoch: 2 | loss: 345.0194702
	speed: 0.0450s/iter; left time: 5573.2726s
	iters: 1100, epoch: 2 | loss: 346.9134216
	speed: 0.0390s/iter; left time: 4833.0713s
	iters: 1200, epoch: 2 | loss: 342.8033142
	speed: 0.0384s/iter; left time: 4747.5926s
	iters: 1300, epoch: 2 | loss: 371.3014526
	speed: 0.0342s/iter; left time: 4226.5323s
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.11370939016342163, mae:0.2358587235212326
	iters: 1400, epoch: 2 | loss: 351.5096130
	speed: 0.0362s/iter; left time: 4468.3336s
	iters: 1500, epoch: 2 | loss: 362.6678467
	speed: 0.0378s/iter; left time: 4666.0216s
	iters: 1600, epoch: 2 | loss: 366.6506042
	speed: 0.0432s/iter; left time: 5323.1566s
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh2_mask_0.25     Model:              CALF                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.25                

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
	iters: 1700, epoch: 2 | loss: 435.4371948
	speed: 0.0434s/iter; left time: 5353.3110s
>>>>>>>start training : imputation_ETTh2_mask_0.25_CALF_ETTh2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 1800, epoch: 2 | loss: 420.9505005
	speed: 0.0434s/iter; left time: 5346.6639s
	iters: 100, epoch: 1 | loss: 0.5223086
	speed: 0.0813s/iter; left time: 426.2266s
	iters: 1900, epoch: 2 | loss: 548.5602417
	speed: 0.0405s/iter; left time: 4982.3680s
	iters: 2000, epoch: 2 | loss: 522.2025146
	speed: 0.0388s/iter; left time: 4773.7034s
	iters: 200, epoch: 1 | loss: 0.8452828
	speed: 0.0605s/iter; left time: 310.9569s
	iters: 2100, epoch: 2 | loss: 399.0631409
	speed: 0.0357s/iter; left time: 4388.6151s
	iters: 2200, epoch: 2 | loss: 502.8513794
	speed: 0.0354s/iter; left time: 4349.5412s
	iters: 300, epoch: 1 | loss: 2.5910974
	speed: 0.0539s/iter; left time: 271.7342s
	iters: 2300, epoch: 2 | loss: 638.8795776
	speed: 0.0337s/iter; left time: 4137.6366s
	iters: 400, epoch: 1 | loss: 3.4029677
	speed: 0.0584s/iter; left time: 288.7107s
	iters: 2400, epoch: 2 | loss: 415.0865173
	speed: 0.0341s/iter; left time: 4184.1811s
	iters: 2500, epoch: 2 | loss: 595.0208740
	speed: 0.0348s/iter; left time: 4257.7103s
	iters: 500, epoch: 1 | loss: 4.2288384
	speed: 0.0563s/iter; left time: 272.5476s
Epoch: 1 cost time: 32.8843629360199
	iters: 2600, epoch: 2 | loss: 506.9125366
	speed: 0.0416s/iter; left time: 5089.4828s
	iters: 2700, epoch: 2 | loss: 470.2259521
	speed: 0.0360s/iter; left time: 4404.1231s
	iters: 2800, epoch: 2 | loss: 658.8648682
	speed: 0.0385s/iter; left time: 4700.3529s
	iters: 2900, epoch: 2 | loss: 606.9035645
	speed: 0.0395s/iter; left time: 4821.9035s
	iters: 3000, epoch: 2 | loss: 605.6744995
	speed: 0.0443s/iter; left time: 5401.2352s
	iters: 3100, epoch: 2 | loss: 456.6680603
	speed: 0.0437s/iter; left time: 5325.2145s
	iters: 3200, epoch: 2 | loss: 743.1110229
	speed: 0.0422s/iter; left time: 5131.7566s
	iters: 3300, epoch: 2 | loss: 615.2412109
	speed: 0.0433s/iter; left time: 5266.6059s
	iters: 3400, epoch: 2 | loss: 606.9746704
	speed: 0.0441s/iter; left time: 5364.1624s
	iters: 3500, epoch: 2 | loss: 701.4709473
	speed: 0.0425s/iter; left time: 5166.0695s
	iters: 3600, epoch: 2 | loss: 793.1865845
	speed: 0.0453s/iter; left time: 5502.0903s
	iters: 3700, epoch: 2 | loss: 751.7445679
	speed: 0.0407s/iter; left time: 4939.8347s
	iters: 3800, epoch: 2 | loss: 736.3273315
	speed: 0.0372s/iter; left time: 4504.9956s
	iters: 3900, epoch: 2 | loss: 686.1995850
	speed: 0.0363s/iter; left time: 4395.9673s
	iters: 4000, epoch: 2 | loss: 803.9676514
	speed: 0.0415s/iter; left time: 5015.6907s
Epoch: 1, Steps: 534 | Train Loss: 2.1085574 Vali Loss: 0.0934689 Test Loss: 0.1244236
Validation loss decreased (inf --> 0.093469).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 4100, epoch: 2 | loss: 834.2365723
	speed: 0.0419s/iter; left time: 5068.0293s
	iters: 4200, epoch: 2 | loss: 1271.3071289
	speed: 0.0412s/iter; left time: 4978.5897s
	iters: 100, epoch: 2 | loss: 10.1100063
	speed: 0.7027s/iter; left time: 3307.8116s
	iters: 4300, epoch: 2 | loss: 1080.0468750
	speed: 0.0371s/iter; left time: 4479.6423s
Epoch: 2 cost time: 172.81745100021362
	iters: 200, epoch: 2 | loss: 7.0187330
	speed: 0.0610s/iter; left time: 281.0963s
	iters: 300, epoch: 2 | loss: 14.9053278
	speed: 0.0590s/iter; left time: 265.7879s
	iters: 400, epoch: 2 | loss: 15.9640694
	speed: 0.0636s/iter; left time: 280.4482s
	iters: 500, epoch: 2 | loss: 19.2491474
	speed: 0.0569s/iter; left time: 244.8619s
Epoch: 2 cost time: 32.309203147888184
Epoch: 2, Steps: 534 | Train Loss: 11.0119541 Vali Loss: 0.1515907 Test Loss: 0.2212369
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 17.6829453
	speed: 0.6936s/iter; left time: 2894.5829s
	iters: 200, epoch: 3 | loss: 19.5994663
	speed: 0.0578s/iter; left time: 235.4253s
	iters: 300, epoch: 3 | loss: 32.8078842
	speed: 0.0586s/iter; left time: 232.9394s
	iters: 400, epoch: 3 | loss: 31.1117573
	speed: 0.0521s/iter; left time: 201.9439s
	iters: 500, epoch: 3 | loss: 40.4821243
	speed: 0.0588s/iter; left time: 221.7119s
Epoch: 3 cost time: 30.84350872039795
Epoch: 2, Steps: 4308 | Train Loss: 597.6755806 Vali Loss: 0.6454660 Test Loss: 0.6166782
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 823.0278320
	speed: 1.7511s/iter; left time: 211052.3285s
Epoch: 3, Steps: 534 | Train Loss: 25.2344359 Vali Loss: 0.1494527 Test Loss: 0.2239205
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 200, epoch: 3 | loss: 966.5368652
	speed: 0.0449s/iter; left time: 5406.3756s
	iters: 300, epoch: 3 | loss: 758.5192261
	speed: 0.0456s/iter; left time: 5490.1861s
	iters: 100, epoch: 4 | loss: 28.5485668
	speed: 0.7124s/iter; left time: 2592.4281s
	iters: 400, epoch: 3 | loss: 716.2432251
	speed: 0.0416s/iter; left time: 4997.8840s
	iters: 200, epoch: 4 | loss: 14.9654846
	speed: 0.0556s/iter; left time: 196.6321s
	iters: 500, epoch: 3 | loss: 820.0434570
	speed: 0.0423s/iter; left time: 5080.0486s
	iters: 300, epoch: 4 | loss: 39.1646194
	speed: 0.0520s/iter; left time: 178.7520s
	iters: 600, epoch: 3 | loss: 859.4453735
	speed: 0.0439s/iter; left time: 5272.2657s
	iters: 700, epoch: 3 | loss: 790.3392334
	speed: 0.0379s/iter; left time: 4547.5689s
	iters: 400, epoch: 4 | loss: 17.1653576
	speed: 0.0521s/iter; left time: 173.8419s
	iters: 800, epoch: 3 | loss: 720.7352905
	speed: 0.0387s/iter; left time: 4638.2181s
	iters: 500, epoch: 4 | loss: 24.2758522
	speed: 0.0502s/iter; left time: 162.4614s
Epoch: 4 cost time: 28.926615953445435
	iters: 900, epoch: 3 | loss: 1217.7843018
	speed: 0.0427s/iter; left time: 5112.8481s
	iters: 1000, epoch: 3 | loss: 1328.3826904
	speed: 0.0456s/iter; left time: 5453.7340s
	iters: 1100, epoch: 3 | loss: 1056.1907959
	speed: 0.0450s/iter; left time: 5383.4450s
	iters: 1200, epoch: 3 | loss: 1222.9388428
	speed: 0.0453s/iter; left time: 5410.5296s
	iters: 1300, epoch: 3 | loss: 1163.3101807
	speed: 0.0499s/iter; left time: 5948.5616s
	iters: 1400, epoch: 3 | loss: 1058.9206543
	speed: 0.0465s/iter; left time: 5542.5337s
	iters: 1500, epoch: 3 | loss: 1012.4092407
	speed: 0.0410s/iter; left time: 4885.7736s
	iters: 1600, epoch: 3 | loss: 1078.8864746
	speed: 0.0441s/iter; left time: 5246.6143s
	iters: 1700, epoch: 3 | loss: 1143.3220215
	speed: 0.0458s/iter; left time: 5452.5491s
	iters: 1800, epoch: 3 | loss: 3227.0366211
	speed: 0.0445s/iter; left time: 5282.3440s
	iters: 1900, epoch: 3 | loss: 2182.8051758
	speed: 0.0436s/iter; left time: 5181.7912s
	iters: 2000, epoch: 3 | loss: 1557.9160156
	speed: 0.0412s/iter; left time: 4887.3564s
	iters: 2100, epoch: 3 | loss: 983.1076660
	speed: 0.0399s/iter; left time: 4733.0345s
	iters: 2200, epoch: 3 | loss: 1403.0484619
	speed: 0.0408s/iter; left time: 4836.1561s
Epoch: 4, Steps: 534 | Train Loss: 24.3302638 Vali Loss: 0.1820419 Test Loss: 0.2864951
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh2_mask_0.25_CALF_ETTh2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
	iters: 2300, epoch: 3 | loss: 1483.7745361
	speed: 0.0407s/iter; left time: 4812.2063s
	iters: 2400, epoch: 3 | loss: 971.0075684
	speed: 0.0386s/iter; left time: 4559.6021s
	iters: 2500, epoch: 3 | loss: 1320.7103271
	speed: 0.0408s/iter; left time: 4824.1468s
	iters: 2600, epoch: 3 | loss: 1235.5725098
	speed: 0.0408s/iter; left time: 4820.9245s
	iters: 2700, epoch: 3 | loss: 948.0968628
	speed: 0.0394s/iter; left time: 4648.6481s
	iters: 2800, epoch: 3 | loss: 1524.8815918
	speed: 0.0382s/iter; left time: 4501.7644s
	iters: 2900, epoch: 3 | loss: 1024.3709717
	speed: 0.0403s/iter; left time: 4739.2285s
	iters: 3000, epoch: 3 | loss: 1119.6112061
	speed: 0.0400s/iter; left time: 4710.2728s
	iters: 3100, epoch: 3 | loss: 1001.3425903
	speed: 0.0433s/iter; left time: 5088.1596s
	iters: 3200, epoch: 3 | loss: 1178.6456299
	speed: 0.0418s/iter; left time: 4914.1404s
	iters: 3300, epoch: 3 | loss: 771.2790527
	speed: 0.0378s/iter; left time: 4435.3627s
	iters: 3400, epoch: 3 | loss: 1080.5135498
	speed: 0.0408s/iter; left time: 4786.5080s
	iters: 3500, epoch: 3 | loss: 895.7156372
	speed: 0.0431s/iter; left time: 5047.9989s
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.12481248378753662, mae:0.24764259159564972
	iters: 3600, epoch: 3 | loss: 1056.6021729
	speed: 0.0421s/iter; left time: 4921.2273s
	iters: 3700, epoch: 3 | loss: 1172.4022217
	speed: 0.0434s/iter; left time: 5079.4092s
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh2_mask_0.375    Model:              CALF                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.375               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
	iters: 3800, epoch: 3 | loss: 1264.1934814
	speed: 0.0462s/iter; left time: 5402.9841s
>>>>>>>start training : imputation_ETTh2_mask_0.375_CALF_ETTh2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 3900, epoch: 3 | loss: 1140.2517090
	speed: 0.0433s/iter; left time: 5053.5757s
	iters: 4000, epoch: 3 | loss: 928.9012451
	speed: 0.0450s/iter; left time: 5253.1083s
	iters: 100, epoch: 1 | loss: 0.6239810
	speed: 0.0743s/iter; left time: 389.5331s
	iters: 4100, epoch: 3 | loss: 2150.8339844
	speed: 0.0457s/iter; left time: 5329.1897s
	iters: 200, epoch: 1 | loss: 1.4336556
	speed: 0.0549s/iter; left time: 282.0980s
	iters: 4200, epoch: 3 | loss: 1662.9970703
	speed: 0.0414s/iter; left time: 4816.5620s
	iters: 300, epoch: 1 | loss: 2.5840988
	speed: 0.0544s/iter; left time: 274.0806s
	iters: 4300, epoch: 3 | loss: 1585.5655518
	speed: 0.0404s/iter; left time: 4695.0096s
Epoch: 3 cost time: 183.50359559059143
	iters: 400, epoch: 1 | loss: 6.3628125
	speed: 0.0609s/iter; left time: 301.0506s
	iters: 500, epoch: 1 | loss: 8.1041336
	speed: 0.0607s/iter; left time: 294.0065s
Epoch: 1 cost time: 32.44306492805481
Epoch: 1, Steps: 534 | Train Loss: 2.7681068 Vali Loss: 0.1714462 Test Loss: 0.2748808
Validation loss decreased (inf --> 0.171446).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 8.6124334
	speed: 0.7794s/iter; left time: 3668.4501s
	iters: 200, epoch: 2 | loss: 13.0444794
	speed: 0.0623s/iter; left time: 287.1043s
	iters: 300, epoch: 2 | loss: 10.6758099
	speed: 0.0624s/iter; left time: 281.4572s
	iters: 400, epoch: 2 | loss: 6.5416651
	speed: 0.0591s/iter; left time: 260.2713s
	iters: 500, epoch: 2 | loss: 23.7534180
	speed: 0.0596s/iter; left time: 256.6592s
Epoch: 2 cost time: 33.14967226982117
Epoch: 3, Steps: 4308 | Train Loss: 1228.9365081 Vali Loss: 0.6833875 Test Loss: 0.6533606
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 4 | loss: 1936.1265869
	speed: 1.7217s/iter; left time: 200086.0182s
	iters: 200, epoch: 4 | loss: 1734.8220215
	speed: 0.0438s/iter; left time: 5080.7475s
Epoch: 2, Steps: 534 | Train Loss: 9.5077861 Vali Loss: 0.1869186 Test Loss: 0.3158598
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 300, epoch: 4 | loss: 1144.8525391
	speed: 0.0468s/iter; left time: 5427.2957s
	iters: 400, epoch: 4 | loss: 2241.9182129
	speed: 0.0395s/iter; left time: 4576.9838s
	iters: 100, epoch: 3 | loss: 14.9823799
	speed: 0.7363s/iter; left time: 3072.3906s
	iters: 500, epoch: 4 | loss: 1230.7106934
	speed: 0.0367s/iter; left time: 4250.0665s
	iters: 600, epoch: 4 | loss: 1918.9337158
	speed: 0.0381s/iter; left time: 4411.0620s
	iters: 200, epoch: 3 | loss: 29.7859535
	speed: 0.0596s/iter; left time: 242.5733s
	iters: 700, epoch: 4 | loss: 1336.7973633
	speed: 0.0384s/iter; left time: 4439.0151s
	iters: 300, epoch: 3 | loss: 17.2852020
	speed: 0.0624s/iter; left time: 247.8076s
	iters: 800, epoch: 4 | loss: 1570.1159668
	speed: 0.0427s/iter; left time: 4928.3172s
	iters: 900, epoch: 4 | loss: 1853.8909912
	speed: 0.0389s/iter; left time: 4491.2924s
	iters: 400, epoch: 3 | loss: 15.2261972
	speed: 0.0603s/iter; left time: 233.6693s
	iters: 1000, epoch: 4 | loss: 1429.4498291
	speed: 0.0368s/iter; left time: 4243.8411s
	iters: 500, epoch: 3 | loss: 16.5665855
	speed: 0.0560s/iter; left time: 211.4158s
	iters: 1100, epoch: 4 | loss: 1461.9737549
	speed: 0.0359s/iter; left time: 4141.3408s
Epoch: 3 cost time: 32.83035326004028
	iters: 1200, epoch: 4 | loss: 1482.1203613
	speed: 0.0369s/iter; left time: 4243.4814s
	iters: 1300, epoch: 4 | loss: 1579.9433594
	speed: 0.0388s/iter; left time: 4467.4710s
	iters: 1400, epoch: 4 | loss: 1783.9444580
	speed: 0.0437s/iter; left time: 5024.2296s
	iters: 1500, epoch: 4 | loss: 2039.3359375
	speed: 0.0423s/iter; left time: 4853.5621s
	iters: 1600, epoch: 4 | loss: 2269.5070801
	speed: 0.0424s/iter; left time: 4868.5506s
	iters: 1700, epoch: 4 | loss: 1282.0247803
	speed: 0.0403s/iter; left time: 4620.1092s
	iters: 1800, epoch: 4 | loss: 2402.1437988
	speed: 0.0414s/iter; left time: 4743.1437s
	iters: 1900, epoch: 4 | loss: 3528.1940918
	speed: 0.0361s/iter; left time: 4131.4313s
	iters: 2000, epoch: 4 | loss: 1509.8853760
	speed: 0.0396s/iter; left time: 4525.8946s
	iters: 2100, epoch: 4 | loss: 3704.8330078
	speed: 0.0416s/iter; left time: 4752.6290s
	iters: 2200, epoch: 4 | loss: 1637.0339355
	speed: 0.0398s/iter; left time: 4538.7977s
	iters: 2300, epoch: 4 | loss: 4199.8134766
	speed: 0.0447s/iter; left time: 5092.0757s
	iters: 2400, epoch: 4 | loss: 1917.7238770
	speed: 0.0417s/iter; left time: 4747.3468s
	iters: 2500, epoch: 4 | loss: 2439.6147461
	speed: 0.0388s/iter; left time: 4411.7400s
	iters: 2600, epoch: 4 | loss: 2712.7531738
	speed: 0.0404s/iter; left time: 4590.0517s
	iters: 2700, epoch: 4 | loss: 1648.7849121
	speed: 0.0369s/iter; left time: 4188.1982s
Epoch: 3, Steps: 534 | Train Loss: 16.7752684 Vali Loss: 0.1646862 Test Loss: 0.2452780
Validation loss decreased (0.171446 --> 0.164686).  Saving model ...
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 2800, epoch: 4 | loss: 1579.4338379
	speed: 0.0447s/iter; left time: 5072.4624s
	iters: 2900, epoch: 4 | loss: 1318.2399902
	speed: 0.0407s/iter; left time: 4619.9197s
	iters: 100, epoch: 4 | loss: 35.0476570
	speed: 0.7363s/iter; left time: 2679.4110s
	iters: 3000, epoch: 4 | loss: 1636.9188232
	speed: 0.0403s/iter; left time: 4566.3671s
	iters: 200, epoch: 4 | loss: 20.1064816
	speed: 0.0636s/iter; left time: 225.2448s
	iters: 3100, epoch: 4 | loss: 1693.2338867
	speed: 0.0395s/iter; left time: 4469.8857s
	iters: 3200, epoch: 4 | loss: 1303.8673096
	speed: 0.0445s/iter; left time: 5034.1324s
	iters: 300, epoch: 4 | loss: 24.2646313
	speed: 0.0584s/iter; left time: 200.8995s
	iters: 3300, epoch: 4 | loss: 1514.5496826
	speed: 0.0418s/iter; left time: 4725.6304s
	iters: 400, epoch: 4 | loss: 18.6585732
	speed: 0.0596s/iter; left time: 198.8589s
	iters: 3400, epoch: 4 | loss: 1669.6372070
	speed: 0.0439s/iter; left time: 4961.4104s
	iters: 500, epoch: 4 | loss: 18.1170635
	speed: 0.0568s/iter; left time: 184.0531s
	iters: 3500, epoch: 4 | loss: 1694.8663330
	speed: 0.0402s/iter; left time: 4537.3360s
Epoch: 4 cost time: 32.87396216392517
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Imputation_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Imputation_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_loader.py", line 10, in <module>
    from data_provider.m4 import M4Dataset, M4Meta
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/m4.py", line 26, in <module>
    import patoolib
ModuleNotFoundError: No module named 'patoolib'
	iters: 3600, epoch: 4 | loss: 1765.5728760
	speed: 0.0471s/iter; left time: 5303.9459s
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Imputation_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Imputation_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_loader.py", line 10, in <module>
    from data_provider.m4 import M4Dataset, M4Meta
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/m4.py", line 26, in <module>
    import patoolib
ModuleNotFoundError: No module named 'patoolib'
	iters: 3700, epoch: 4 | loss: 1509.5561523
	speed: 0.0491s/iter; left time: 5532.9668s
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Imputation_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Imputation_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_loader.py", line 10, in <module>
    from data_provider.m4 import M4Dataset, M4Meta
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/m4.py", line 26, in <module>
    import patoolib
ModuleNotFoundError: No module named 'patoolib'
Traceback (most recent call last):
  File "/home/nathan/LLM4TS/Imputation_task/CALF/run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/home/nathan/LLM4TS/Imputation_task/CALF/exp/exp_long_term_forecasting.py", line 1, in <module>
    from data_provider.data_factory import data_provider
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_factory.py", line 1, in <module>
    from data_provider.data_loader import Dataset_ETT_hour, Dataset_ETT_minute, Dataset_Custom, Dataset_M4, PSMSegLoader, \
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/data_loader.py", line 10, in <module>
    from data_provider.m4 import M4Dataset, M4Meta
  File "/home/nathan/LLM4TS/Imputation_task/CALF/data_provider/m4.py", line 26, in <module>
    import patoolib
ModuleNotFoundError: No module named 'patoolib'
	iters: 3800, epoch: 4 | loss: 2391.0673828
	speed: 0.0434s/iter; left time: 4881.1560s
	iters: 3900, epoch: 4 | loss: 1681.6057129
	speed: 0.0409s/iter; left time: 4593.0890s
	iters: 4000, epoch: 4 | loss: 2973.1430664
	speed: 0.0407s/iter; left time: 4568.6834s
	iters: 4100, epoch: 4 | loss: 2704.8676758
	speed: 0.0401s/iter; left time: 4495.4682s
	iters: 4200, epoch: 4 | loss: 2411.6464844
	speed: 0.0405s/iter; left time: 4538.1343s
	iters: 4300, epoch: 4 | loss: 2931.8720703
	speed: 0.0370s/iter; left time: 4139.8143s
Epoch: 4 cost time: 176.98195362091064
Epoch: 4, Steps: 534 | Train Loss: 23.2678155 Vali Loss: 0.1614324 Test Loss: 0.2511908
Validation loss decreased (0.164686 --> 0.161432).  Saving model ...
lr_adjust = {4: 0.00045000000000000004}
Updating learning rate to 0.00045000000000000004
	iters: 100, epoch: 5 | loss: 40.5337563
	speed: 0.7942s/iter; left time: 2465.8803s
	iters: 200, epoch: 5 | loss: 46.1958275
	speed: 0.0671s/iter; left time: 201.7385s
	iters: 300, epoch: 5 | loss: 33.9998779
	speed: 0.0623s/iter; left time: 181.0209s
	iters: 400, epoch: 5 | loss: 46.3643799
	speed: 0.0563s/iter; left time: 157.9234s
	iters: 500, epoch: 5 | loss: 19.7169342
	speed: 0.0544s/iter; left time: 147.2680s
Epoch: 5 cost time: 33.49580240249634
Epoch: 5, Steps: 534 | Train Loss: 43.2101269 Vali Loss: 0.1681455 Test Loss: 0.2758861
EarlyStopping counter: 1 out of 3
lr_adjust = {5: 0.00040500000000000003}
Updating learning rate to 0.00040500000000000003
	iters: 100, epoch: 6 | loss: 165.1547546
	speed: 0.7528s/iter; left time: 1935.4254s
	iters: 200, epoch: 6 | loss: 108.4477386
	speed: 0.0568s/iter; left time: 140.3722s
	iters: 300, epoch: 6 | loss: 66.4661407
	speed: 0.0519s/iter; left time: 123.1441s
	iters: 400, epoch: 6 | loss: 75.8817673
	speed: 0.0535s/iter; left time: 121.4810s
	iters: 500, epoch: 6 | loss: 69.8779755
	speed: 0.0525s/iter; left time: 113.9611s
Epoch: 6 cost time: 30.40660572052002
Epoch: 4, Steps: 4308 | Train Loss: 1974.5613822 Vali Loss: 0.5962451 Test Loss: 0.5831098
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTm1_mask_0.125_CALF_ETTm1_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt3_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11521
Epoch: 6, Steps: 534 | Train Loss: 75.9595545 Vali Loss: 0.1540273 Test Loss: 0.2437728
Validation loss decreased (0.161432 --> 0.154027).  Saving model ...
lr_adjust = {6: 0.0003645000000000001}
Updating learning rate to 0.0003645000000000001
	iters: 100, epoch: 7 | loss: 45.3296852
	speed: 0.7681s/iter; left time: 1564.6355s
	iters: 200, epoch: 7 | loss: 55.3147736
	speed: 0.0646s/iter; left time: 125.1582s
	iters: 300, epoch: 7 | loss: 51.5325546
	speed: 0.0681s/iter; left time: 125.1222s
	iters: 400, epoch: 7 | loss: 57.5118408
	speed: 0.0666s/iter; left time: 115.6667s
	iters: 500, epoch: 7 | loss: 52.1282578
	speed: 0.0605s/iter; left time: 99.0945s
Epoch: 7 cost time: 34.47255039215088
Epoch: 7, Steps: 534 | Train Loss: 47.7891946 Vali Loss: 0.1688830 Test Loss: 0.2613170
EarlyStopping counter: 1 out of 3
lr_adjust = {7: 0.00032805000000000003}
Updating learning rate to 0.00032805000000000003
test shape: (11521, 96, 7) (11521, 96, 7)
mse:0.5477087497711182, mae:0.47875353693962097
	iters: 100, epoch: 8 | loss: 42.3448677
	speed: 0.7420s/iter; left time: 1115.2354s
	iters: 200, epoch: 8 | loss: 55.7808113
	speed: 0.0531s/iter; left time: 74.5283s
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTm1_mask_0.25     Model:              CALF                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.25                

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
	iters: 300, epoch: 8 | loss: 42.2894058
	speed: 0.0570s/iter; left time: 74.3194s
>>>>>>>start training : imputation_ETTm1_mask_0.25_CALF_ETTm1_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt3_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34465
val 11521
test 11521
	iters: 400, epoch: 8 | loss: 29.4481354
	speed: 0.0648s/iter; left time: 77.9703s
	iters: 100, epoch: 1 | loss: 0.6304202
	speed: 0.0570s/iter; left time: 7357.2339s
	iters: 200, epoch: 1 | loss: 0.9262999
	speed: 0.0360s/iter; left time: 4640.5127s
	iters: 500, epoch: 8 | loss: 37.7930756
	speed: 0.0613s/iter; left time: 67.6288s
	iters: 300, epoch: 1 | loss: 1.4174135
	speed: 0.0375s/iter; left time: 4835.5814s
Epoch: 8 cost time: 31.591882705688477
	iters: 400, epoch: 1 | loss: 1.8143666
	speed: 0.0385s/iter; left time: 4963.8262s
	iters: 500, epoch: 1 | loss: 2.5285802
	speed: 0.0409s/iter; left time: 5261.9220s
	iters: 600, epoch: 1 | loss: 3.5942185
	speed: 0.0392s/iter; left time: 5048.8522s
	iters: 700, epoch: 1 | loss: 3.1143951
	speed: 0.0389s/iter; left time: 5001.7844s
	iters: 800, epoch: 1 | loss: 4.8923974
	speed: 0.0400s/iter; left time: 5140.4953s
	iters: 900, epoch: 1 | loss: 5.1880426
	speed: 0.0412s/iter; left time: 5286.4894s
	iters: 1000, epoch: 1 | loss: 5.7149000
	speed: 0.0393s/iter; left time: 5037.8813s
	iters: 1100, epoch: 1 | loss: 5.4402456
	speed: 0.0376s/iter; left time: 4814.8702s
	iters: 1200, epoch: 1 | loss: 3.9862294
	speed: 0.0335s/iter; left time: 4291.5753s
	iters: 1300, epoch: 1 | loss: 8.7401171
	speed: 0.0370s/iter; left time: 4728.2679s
	iters: 1400, epoch: 1 | loss: 6.0556302
	speed: 0.0383s/iter; left time: 4892.6746s
	iters: 1500, epoch: 1 | loss: 10.0194387
	speed: 0.0396s/iter; left time: 5064.6534s
	iters: 1600, epoch: 1 | loss: 8.6406651
	speed: 0.0386s/iter; left time: 4920.9391s
	iters: 1700, epoch: 1 | loss: 11.2126713
	speed: 0.0456s/iter; left time: 5814.4537s
	iters: 1800, epoch: 1 | loss: 5.5694609
	speed: 0.0426s/iter; left time: 5431.0150s
	iters: 1900, epoch: 1 | loss: 25.4079838
	speed: 0.0423s/iter; left time: 5387.7287s
Epoch: 8, Steps: 534 | Train Loss: 46.1580698 Vali Loss: 0.1742002 Test Loss: 0.2818041
EarlyStopping counter: 2 out of 3
lr_adjust = {8: 0.000295245}
Updating learning rate to 0.000295245
	iters: 2000, epoch: 1 | loss: 40.6155815
	speed: 0.0426s/iter; left time: 5422.6572s
	iters: 2100, epoch: 1 | loss: 24.8662872
	speed: 0.0355s/iter; left time: 4509.1901s
	iters: 100, epoch: 9 | loss: 55.9969673
	speed: 0.7324s/iter; left time: 709.7419s
	iters: 2200, epoch: 1 | loss: 27.7001877
	speed: 0.0341s/iter; left time: 4333.0514s
	iters: 200, epoch: 9 | loss: 85.3854904
	speed: 0.0610s/iter; left time: 52.9867s
	iters: 2300, epoch: 1 | loss: 46.6194191
	speed: 0.0350s/iter; left time: 4441.1863s
	iters: 2400, epoch: 1 | loss: 15.9145679
	speed: 0.0401s/iter; left time: 5087.6420s
	iters: 300, epoch: 9 | loss: 133.4060516
	speed: 0.0607s/iter; left time: 46.7152s
	iters: 2500, epoch: 1 | loss: 15.7945185
	speed: 0.0371s/iter; left time: 4700.0787s
	iters: 2600, epoch: 1 | loss: 23.4537239
	speed: 0.0388s/iter; left time: 4916.3225s
	iters: 400, epoch: 9 | loss: 89.9830780
	speed: 0.0583s/iter; left time: 39.0192s
	iters: 2700, epoch: 1 | loss: 27.6799622
	speed: 0.0341s/iter; left time: 4310.5086s
	iters: 500, epoch: 9 | loss: 73.0205002
	speed: 0.0544s/iter; left time: 30.9320s
	iters: 2800, epoch: 1 | loss: 13.4572840
	speed: 0.0338s/iter; left time: 4270.3423s
Epoch: 9 cost time: 32.16841387748718
	iters: 2900, epoch: 1 | loss: 86.0449905
	speed: 0.0374s/iter; left time: 4728.0930s
	iters: 3000, epoch: 1 | loss: 49.5806618
	speed: 0.0423s/iter; left time: 5336.7759s
	iters: 3100, epoch: 1 | loss: 46.3506966
	speed: 0.0398s/iter; left time: 5025.0120s
	iters: 3200, epoch: 1 | loss: 33.9373932
	speed: 0.0407s/iter; left time: 5132.0842s
	iters: 3300, epoch: 1 | loss: 43.6291161
	speed: 0.0365s/iter; left time: 4593.0371s
	iters: 3400, epoch: 1 | loss: 38.6004601
	speed: 0.0352s/iter; left time: 4427.4952s
	iters: 3500, epoch: 1 | loss: 24.9579849
	speed: 0.0366s/iter; left time: 4599.4373s
	iters: 3600, epoch: 1 | loss: 21.0085220
	speed: 0.0398s/iter; left time: 5001.7478s
	iters: 3700, epoch: 1 | loss: 23.4671249
	speed: 0.0380s/iter; left time: 4766.2427s
	iters: 3800, epoch: 1 | loss: 21.1106739
	speed: 0.0343s/iter; left time: 4297.1237s
	iters: 3900, epoch: 1 | loss: 23.1748314
	speed: 0.0369s/iter; left time: 4630.2490s
	iters: 4000, epoch: 1 | loss: 59.2706833
	speed: 0.0407s/iter; left time: 5103.4890s
	iters: 4100, epoch: 1 | loss: 87.4989777
	speed: 0.0347s/iter; left time: 4338.4365s
	iters: 4200, epoch: 1 | loss: 108.1312637
	speed: 0.0363s/iter; left time: 4538.5773s
	iters: 4300, epoch: 1 | loss: 64.5270538
	speed: 0.0379s/iter; left time: 4739.9758s
Epoch: 1 cost time: 166.5681185722351
Epoch: 9, Steps: 534 | Train Loss: 96.5475366 Vali Loss: 0.1644952 Test Loss: 0.2573237
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh2_mask_0.375_CALF_ETTh2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.23285698890686035, mae:0.3446599543094635
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTh2_mask_0.5      Model:              CALF                

[1mData Loader[0m
  Data:               ETTh2               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTh2_mask_0.5_CALF_ETTh2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8545
val 2881
test 2881
	iters: 100, epoch: 1 | loss: 0.6300395
	speed: 0.0821s/iter; left time: 430.0812s
	iters: 200, epoch: 1 | loss: 0.9516428
	speed: 0.0590s/iter; left time: 303.1781s
	iters: 300, epoch: 1 | loss: 3.0246704
	speed: 0.0613s/iter; left time: 308.7615s
	iters: 400, epoch: 1 | loss: 2.7898543
	speed: 0.0629s/iter; left time: 310.5987s
	iters: 500, epoch: 1 | loss: 5.4706850
	speed: 0.0619s/iter; left time: 299.6851s
Epoch: 1 cost time: 34.82329177856445
Epoch: 1, Steps: 4308 | Train Loss: 24.7332045 Vali Loss: 0.3616840 Test Loss: 0.3792740
Validation loss decreased (inf --> 0.361684).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 55.7470055
	speed: 1.7096s/iter; left time: 213416.3400s
	iters: 200, epoch: 2 | loss: 55.6698341
	speed: 0.0437s/iter; left time: 5456.1635s
	iters: 300, epoch: 2 | loss: 52.1793671
	speed: 0.0420s/iter; left time: 5228.4716s
Epoch: 1, Steps: 534 | Train Loss: 2.5591619 Vali Loss: 0.1841774 Test Loss: 0.2871459
Validation loss decreased (inf --> 0.184177).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 400, epoch: 2 | loss: 67.2008896
	speed: 0.0467s/iter; left time: 5809.9635s
	iters: 100, epoch: 2 | loss: 8.0048714
	speed: 0.7590s/iter; left time: 3572.5958s
	iters: 500, epoch: 2 | loss: 57.3073959
	speed: 0.0421s/iter; left time: 5241.3442s
	iters: 600, epoch: 2 | loss: 31.3340492
	speed: 0.0400s/iter; left time: 4971.5026s
	iters: 200, epoch: 2 | loss: 14.3886061
	speed: 0.0609s/iter; left time: 280.4850s
	iters: 700, epoch: 2 | loss: 29.5820408
	speed: 0.0393s/iter; left time: 4885.0553s
	iters: 300, epoch: 2 | loss: 7.3521500
	speed: 0.0630s/iter; left time: 284.0715s
	iters: 800, epoch: 2 | loss: 30.7832394
	speed: 0.0437s/iter; left time: 5422.7507s
	iters: 900, epoch: 2 | loss: 33.8717346
	speed: 0.0367s/iter; left time: 4555.5796s
	iters: 400, epoch: 2 | loss: 12.4966049
	speed: 0.0566s/iter; left time: 249.3870s
	iters: 1000, epoch: 2 | loss: 34.7593803
	speed: 0.0383s/iter; left time: 4744.3243s
	iters: 500, epoch: 2 | loss: 9.8511047
	speed: 0.0616s/iter; left time: 265.1315s
	iters: 1100, epoch: 2 | loss: 32.4544029
	speed: 0.0433s/iter; left time: 5362.2351s
Epoch: 2 cost time: 32.59999990463257
	iters: 1200, epoch: 2 | loss: 25.5893536
	speed: 0.0451s/iter; left time: 5580.9917s
	iters: 1300, epoch: 2 | loss: 96.8260651
	speed: 0.0436s/iter; left time: 5387.2441s
	iters: 1400, epoch: 2 | loss: 80.7138977
	speed: 0.0440s/iter; left time: 5441.0870s
	iters: 1500, epoch: 2 | loss: 44.6666451
	speed: 0.0421s/iter; left time: 5193.3543s
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTm2_mask_0.125    Model:              CALF                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.125               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
	iters: 1600, epoch: 2 | loss: 48.3959618
	speed: 0.0431s/iter; left time: 5318.4760s
>>>>>>>start training : imputation_ETTm2_mask_0.125_CALF_ETTm2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34465
val 11521
test 11521
	iters: 1700, epoch: 2 | loss: 49.7619476
	speed: 0.0426s/iter; left time: 5244.5192s
	iters: 1800, epoch: 2 | loss: 107.0992279
	speed: 0.0416s/iter; left time: 5126.3472s
	iters: 100, epoch: 1 | loss: 0.5774205
	speed: 0.0808s/iter; left time: 10429.2790s
	iters: 1900, epoch: 2 | loss: 98.2255020
	speed: 0.0394s/iter; left time: 4852.9114s
	iters: 200, epoch: 1 | loss: 1.1952994
	speed: 0.0571s/iter; left time: 7369.7841s
	iters: 2000, epoch: 2 | loss: 93.0152512
	speed: 0.0365s/iter; left time: 4491.6764s
	iters: 2100, epoch: 2 | loss: 128.9105988
	speed: 0.0385s/iter; left time: 4733.6521s
	iters: 300, epoch: 1 | loss: 2.3302107
	speed: 0.0592s/iter; left time: 7633.4373s
	iters: 2200, epoch: 2 | loss: 71.7910919
	speed: 0.0396s/iter; left time: 4862.6550s
	iters: 400, epoch: 1 | loss: 5.1832514
	speed: 0.0593s/iter; left time: 7635.7377s
	iters: 2300, epoch: 2 | loss: 67.1426315
	speed: 0.0438s/iter; left time: 5366.7904s
	iters: 2400, epoch: 2 | loss: 890.6560669
	speed: 0.0379s/iter; left time: 4643.8628s
	iters: 500, epoch: 1 | loss: 6.9212570
	speed: 0.0615s/iter; left time: 7921.6825s
	iters: 2500, epoch: 2 | loss: 280.3378906
	speed: 0.0372s/iter; left time: 4554.6448s
	iters: 600, epoch: 1 | loss: 23.1922989
	speed: 0.0613s/iter; left time: 7880.0010s
	iters: 2600, epoch: 2 | loss: 163.8588104
	speed: 0.0401s/iter; left time: 4904.4873s
	iters: 2700, epoch: 2 | loss: 88.5244827
	speed: 0.0393s/iter; left time: 4799.8729s
	iters: 700, epoch: 1 | loss: 18.6877518
	speed: 0.0622s/iter; left time: 7992.8641s
Epoch: 2, Steps: 534 | Train Loss: 10.2818423 Vali Loss: 0.2921611 Test Loss: 0.5338310
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 2800, epoch: 2 | loss: 108.0700073
	speed: 0.0417s/iter; left time: 5093.2403s
	iters: 800, epoch: 1 | loss: 36.2212906
	speed: 0.0654s/iter; left time: 8402.8302s
	iters: 2900, epoch: 2 | loss: 86.4988098
	speed: 0.0395s/iter; left time: 4823.8546s
	iters: 100, epoch: 3 | loss: 14.0128222
	speed: 0.7552s/iter; left time: 3151.5004s
	iters: 3000, epoch: 2 | loss: 119.5083542
	speed: 0.0410s/iter; left time: 4997.3098s
	iters: 900, epoch: 1 | loss: 33.3788986
	speed: 0.0648s/iter; left time: 8320.4380s
	iters: 200, epoch: 3 | loss: 14.8596935
	speed: 0.0615s/iter; left time: 250.5907s
	iters: 3100, epoch: 2 | loss: 67.6803894
	speed: 0.0436s/iter; left time: 5308.3035s
	iters: 1000, epoch: 1 | loss: 69.4063416
	speed: 0.0609s/iter; left time: 7815.2565s
	iters: 3200, epoch: 2 | loss: 96.5098190
	speed: 0.0410s/iter; left time: 4992.9954s
	iters: 300, epoch: 3 | loss: 33.7179337
	speed: 0.0612s/iter; left time: 243.2236s
	iters: 3300, epoch: 2 | loss: 111.6970367
	speed: 0.0387s/iter; left time: 4705.5628s
	iters: 1100, epoch: 1 | loss: 30.2976284
	speed: 0.0637s/iter; left time: 8164.1513s
	iters: 400, epoch: 3 | loss: 15.1460695
	speed: 0.0578s/iter; left time: 223.7005s
	iters: 3400, epoch: 2 | loss: 138.5888367
	speed: 0.0383s/iter; left time: 4654.0393s
	iters: 3500, epoch: 2 | loss: 66.1718216
	speed: 0.0380s/iter; left time: 4612.2577s
	iters: 1200, epoch: 1 | loss: 34.9368477
	speed: 0.0608s/iter; left time: 7789.4022s
	iters: 500, epoch: 3 | loss: 36.2347145
	speed: 0.0669s/iter; left time: 252.3403s
	iters: 3600, epoch: 2 | loss: 81.4611435
	speed: 0.0392s/iter; left time: 4751.5960s
Epoch: 3 cost time: 34.088671922683716
	iters: 1300, epoch: 1 | loss: 40.8695602
	speed: 0.0613s/iter; left time: 7843.4948s
	iters: 3700, epoch: 2 | loss: 88.7556610
	speed: 0.0422s/iter; left time: 5120.6440s
	iters: 3800, epoch: 2 | loss: 98.5066223
	speed: 0.0425s/iter; left time: 5151.3735s
	iters: 1400, epoch: 1 | loss: 46.4021072
	speed: 0.0613s/iter; left time: 7840.2540s
	iters: 3900, epoch: 2 | loss: 104.1274185
	speed: 0.0388s/iter; left time: 4701.7566s
	iters: 1500, epoch: 1 | loss: 36.6146889
	speed: 0.0648s/iter; left time: 8277.8857s
	iters: 4000, epoch: 2 | loss: 75.7864532
	speed: 0.0420s/iter; left time: 5079.7102s
	iters: 4100, epoch: 2 | loss: 88.3122482
	speed: 0.0438s/iter; left time: 5292.9597s
	iters: 1600, epoch: 1 | loss: 45.6597633
	speed: 0.0656s/iter; left time: 8368.2721s
	iters: 4200, epoch: 2 | loss: 111.6705933
	speed: 0.0418s/iter; left time: 5041.3312s
	iters: 1700, epoch: 1 | loss: 101.2334747
	speed: 0.0649s/iter; left time: 8278.2441s
	iters: 4300, epoch: 2 | loss: 73.4620514
	speed: 0.0400s/iter; left time: 4831.2793s
Epoch: 2 cost time: 177.53939270973206
	iters: 1800, epoch: 1 | loss: 86.2712936
	speed: 0.0640s/iter; left time: 8157.9572s
	iters: 1900, epoch: 1 | loss: 86.1281662
	speed: 0.0655s/iter; left time: 8335.2242s
	iters: 2000, epoch: 1 | loss: 61.7991028
	speed: 0.0630s/iter; left time: 8019.7202s
	iters: 2100, epoch: 1 | loss: 84.6083374
	speed: 0.0680s/iter; left time: 8646.9356s
	iters: 2200, epoch: 1 | loss: 91.1376343
	speed: 0.0572s/iter; left time: 7263.2469s
	iters: 2300, epoch: 1 | loss: 101.6856079
	speed: 0.0612s/iter; left time: 7764.8137s
Epoch: 3, Steps: 534 | Train Loss: 29.0283727 Vali Loss: 0.3273095 Test Loss: 0.5723828
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 2400, epoch: 1 | loss: 127.8994141
	speed: 0.0613s/iter; left time: 7772.9892s
	iters: 100, epoch: 4 | loss: 26.5117455
	speed: 0.7675s/iter; left time: 2793.0427s
	iters: 2500, epoch: 1 | loss: 164.6595459
	speed: 0.0627s/iter; left time: 7945.1800s
	iters: 200, epoch: 4 | loss: 19.3057976
	speed: 0.0650s/iter; left time: 229.9620s
	iters: 2600, epoch: 1 | loss: 350.0103149
	speed: 0.0635s/iter; left time: 8044.2795s
	iters: 300, epoch: 4 | loss: 23.3868256
	speed: 0.0626s/iter; left time: 215.1817s
	iters: 2700, epoch: 1 | loss: 229.1274414
	speed: 0.0640s/iter; left time: 8100.8431s
	iters: 400, epoch: 4 | loss: 26.8514004
	speed: 0.0585s/iter; left time: 195.4929s
	iters: 2800, epoch: 1 | loss: 276.7588196
	speed: 0.0645s/iter; left time: 8150.6939s
	iters: 500, epoch: 4 | loss: 33.4078979
	speed: 0.0603s/iter; left time: 195.4719s
Epoch: 4 cost time: 34.332724809646606
	iters: 2900, epoch: 1 | loss: 202.0935669
	speed: 0.0613s/iter; left time: 7738.7574s
	iters: 3000, epoch: 1 | loss: 307.2118530
	speed: 0.0650s/iter; left time: 8209.9739s
	iters: 3100, epoch: 1 | loss: 179.6627808
	speed: 0.0602s/iter; left time: 7598.1587s
	iters: 3200, epoch: 1 | loss: 291.8738098
	speed: 0.0579s/iter; left time: 7294.3015s
	iters: 3300, epoch: 1 | loss: 197.6622009
	speed: 0.0570s/iter; left time: 7179.3829s
	iters: 3400, epoch: 1 | loss: 195.4731598
	speed: 0.0540s/iter; left time: 6794.0913s
	iters: 3500, epoch: 1 | loss: 210.5061493
	speed: 0.0532s/iter; left time: 6691.8053s
	iters: 3600, epoch: 1 | loss: 202.0862427
	speed: 0.0572s/iter; left time: 7180.7719s
	iters: 3700, epoch: 1 | loss: 309.8342896
	speed: 0.0553s/iter; left time: 6942.9036s
	iters: 3800, epoch: 1 | loss: 236.7574005
	speed: 0.0557s/iter; left time: 6989.1278s
	iters: 3900, epoch: 1 | loss: 209.7247467
	speed: 0.0553s/iter; left time: 6929.9784s
	iters: 4000, epoch: 1 | loss: 199.2175446
	speed: 0.0563s/iter; left time: 7051.9872s
Epoch: 4, Steps: 534 | Train Loss: 29.2859584 Vali Loss: 0.1844943 Test Loss: 0.2802281
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTh2_mask_0.5_CALF_ETTh2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2881
	iters: 4100, epoch: 1 | loss: 195.7037964
	speed: 0.0593s/iter; left time: 7427.0028s
	iters: 4200, epoch: 1 | loss: 241.6618500
	speed: 0.0622s/iter; left time: 7772.5048s
	iters: 4300, epoch: 1 | loss: 218.0827332
	speed: 0.0659s/iter; left time: 8230.1164s
Epoch: 1 cost time: 265.1438138484955
Epoch: 2, Steps: 4308 | Train Loss: 90.9395254 Vali Loss: 0.4627131 Test Loss: 0.4543745
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 83.9934921
	speed: 1.7766s/iter; left time: 214127.3404s
	iters: 200, epoch: 3 | loss: 54.2286835
	speed: 0.0383s/iter; left time: 4606.4010s
	iters: 300, epoch: 3 | loss: 62.8914185
	speed: 0.0423s/iter; left time: 5085.7066s
	iters: 400, epoch: 3 | loss: 69.0103836
	speed: 0.0429s/iter; left time: 5162.8876s
	iters: 500, epoch: 3 | loss: 80.6347122
	speed: 0.0432s/iter; left time: 5193.1423s
	iters: 600, epoch: 3 | loss: 72.4231949
	speed: 0.0389s/iter; left time: 4673.8348s
test shape: (2881, 96, 7) (2881, 96, 7)
mse:0.28440526127815247, mae:0.3842969238758087
	iters: 700, epoch: 3 | loss: 66.9016113
	speed: 0.0386s/iter; left time: 4634.6738s
	iters: 800, epoch: 3 | loss: 87.8240814
	speed: 0.0364s/iter; left time: 4363.9685s
	iters: 900, epoch: 3 | loss: 69.0769501
	speed: 0.0379s/iter; left time: 4539.4106s
	iters: 1000, epoch: 3 | loss: 86.5457382
	speed: 0.0351s/iter; left time: 4193.6627s
	iters: 1100, epoch: 3 | loss: 62.2118149
	speed: 0.0326s/iter; left time: 3895.3680s
	iters: 1200, epoch: 3 | loss: 77.6667862
	speed: 0.0321s/iter; left time: 3834.4930s
	iters: 1300, epoch: 3 | loss: 63.1428986
	speed: 0.0340s/iter; left time: 4054.7309s
	iters: 1400, epoch: 3 | loss: 92.2320251
	speed: 0.0369s/iter; left time: 4394.1970s
	iters: 1500, epoch: 3 | loss: 105.9519196
	speed: 0.0383s/iter; left time: 4568.1765s
	iters: 1600, epoch: 3 | loss: 91.6890411
	speed: 0.0351s/iter; left time: 4174.9011s
	iters: 1700, epoch: 3 | loss: 105.4349823
	speed: 0.0387s/iter; left time: 4605.0731s
	iters: 1800, epoch: 3 | loss: 90.7240906
	speed: 0.0372s/iter; left time: 4423.3406s
	iters: 1900, epoch: 3 | loss: 141.6296997
	speed: 0.0363s/iter; left time: 4311.5502s
	iters: 2000, epoch: 3 | loss: 120.4352646
	speed: 0.0392s/iter; left time: 4655.7235s
	iters: 2100, epoch: 3 | loss: 96.6481094
	speed: 0.0432s/iter; left time: 5119.5927s
	iters: 2200, epoch: 3 | loss: 95.0838089
	speed: 0.0452s/iter; left time: 5348.2300s
	iters: 2300, epoch: 3 | loss: 226.4520874
	speed: 0.0455s/iter; left time: 5383.3036s
	iters: 2400, epoch: 3 | loss: 155.4333496
	speed: 0.0427s/iter; left time: 5045.6264s
	iters: 2500, epoch: 3 | loss: 111.5071945
	speed: 0.0424s/iter; left time: 5007.7205s
	iters: 2600, epoch: 3 | loss: 110.2276459
	speed: 0.0413s/iter; left time: 4876.8439s
	iters: 2700, epoch: 3 | loss: 120.6868668
	speed: 0.0374s/iter; left time: 4410.1749s
	iters: 2800, epoch: 3 | loss: 136.9621277
	speed: 0.0344s/iter; left time: 4051.1417s
	iters: 2900, epoch: 3 | loss: 125.8896790
	speed: 0.0368s/iter; left time: 4333.4612s
	iters: 3000, epoch: 3 | loss: 128.7557678
	speed: 0.0350s/iter; left time: 4119.8031s
	iters: 3100, epoch: 3 | loss: 128.7553711
	speed: 0.0334s/iter; left time: 3925.2046s
	iters: 3200, epoch: 3 | loss: 138.9766235
	speed: 0.0351s/iter; left time: 4125.8715s
	iters: 3300, epoch: 3 | loss: 112.8605576
	speed: 0.0364s/iter; left time: 4267.2936s
	iters: 3400, epoch: 3 | loss: 127.6722107
	speed: 0.0369s/iter; left time: 4322.4284s
	iters: 3500, epoch: 3 | loss: 174.7272949
	speed: 0.0339s/iter; left time: 3975.1480s
	iters: 3600, epoch: 3 | loss: 168.6922760
	speed: 0.0341s/iter; left time: 3988.8439s
	iters: 3700, epoch: 3 | loss: 191.6430664
	speed: 0.0360s/iter; left time: 4214.9673s
	iters: 3800, epoch: 3 | loss: 158.3660126
	speed: 0.0358s/iter; left time: 4182.2756s
	iters: 3900, epoch: 3 | loss: 171.4589386
	speed: 0.0339s/iter; left time: 3952.4464s
	iters: 4000, epoch: 3 | loss: 177.4291534
	speed: 0.0364s/iter; left time: 4240.4154s
	iters: 4100, epoch: 3 | loss: 166.4618683
	speed: 0.0384s/iter; left time: 4474.1251s
	iters: 4200, epoch: 3 | loss: 167.2235413
	speed: 0.0355s/iter; left time: 4138.1199s
	iters: 4300, epoch: 3 | loss: 216.6120911
	speed: 0.0365s/iter; left time: 4247.5854s
Epoch: 3 cost time: 163.27859115600586
Epoch: 1, Steps: 4308 | Train Loss: 124.8834575 Vali Loss: 0.1488904 Test Loss: 0.2072122
Validation loss decreased (inf --> 0.148890).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 246.3349609
	speed: 2.6977s/iter; left time: 336763.3564s
	iters: 200, epoch: 2 | loss: 261.7304993
	speed: 0.0566s/iter; left time: 7054.4844s
	iters: 300, epoch: 2 | loss: 311.3420410
	speed: 0.0654s/iter; left time: 8148.8195s
	iters: 400, epoch: 2 | loss: 398.0516663
	speed: 0.0634s/iter; left time: 7893.5379s
	iters: 500, epoch: 2 | loss: 396.1630554
	speed: 0.0625s/iter; left time: 7775.1030s
	iters: 600, epoch: 2 | loss: 289.9382935
	speed: 0.0638s/iter; left time: 7929.9985s
	iters: 700, epoch: 2 | loss: 293.2100220
	speed: 0.0569s/iter; left time: 7065.1041s
	iters: 800, epoch: 2 | loss: 318.1206665
	speed: 0.0588s/iter; left time: 7301.1594s
	iters: 900, epoch: 2 | loss: 254.7855072
	speed: 0.0601s/iter; left time: 7455.2249s
	iters: 1000, epoch: 2 | loss: 333.2711182
	speed: 0.0577s/iter; left time: 7153.9684s
	iters: 1100, epoch: 2 | loss: 369.0686646
	speed: 0.0560s/iter; left time: 6934.5000s
	iters: 1200, epoch: 2 | loss: 411.4667664
	speed: 0.0565s/iter; left time: 6992.9369s
	iters: 1300, epoch: 2 | loss: 543.5159912
	speed: 0.0572s/iter; left time: 7071.1594s
Epoch: 3, Steps: 4308 | Train Loss: 114.9910971 Vali Loss: 0.4909582 Test Loss: 0.4752364
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 1400, epoch: 2 | loss: 443.9910278
	speed: 0.0582s/iter; left time: 7187.7659s
	iters: 100, epoch: 4 | loss: 191.7529755
	speed: 1.7045s/iter; left time: 198093.1112s
	iters: 1500, epoch: 2 | loss: 496.4040833
	speed: 0.0596s/iter; left time: 7353.0489s
	iters: 200, epoch: 4 | loss: 184.7646790
	speed: 0.0410s/iter; left time: 4755.4427s
	iters: 300, epoch: 4 | loss: 165.6911774
	speed: 0.0424s/iter; left time: 4918.4204s
	iters: 1600, epoch: 2 | loss: 467.7465820
	speed: 0.0547s/iter; left time: 6747.5540s
	iters: 400, epoch: 4 | loss: 154.6660309
	speed: 0.0421s/iter; left time: 4877.3260s
	iters: 1700, epoch: 2 | loss: 417.1952209
	speed: 0.0580s/iter; left time: 7149.4096s
	iters: 500, epoch: 4 | loss: 151.7258453
	speed: 0.0373s/iter; left time: 4321.8833s
	iters: 1800, epoch: 2 | loss: 347.4903564
	speed: 0.0562s/iter; left time: 6920.3859s
	iters: 600, epoch: 4 | loss: 1693.1652832
	speed: 0.0408s/iter; left time: 4726.7829s
	iters: 700, epoch: 4 | loss: 2050.5158691
	speed: 0.0403s/iter; left time: 4658.7189s
	iters: 1900, epoch: 2 | loss: 303.9855347
	speed: 0.0539s/iter; left time: 6628.1463s
	iters: 800, epoch: 4 | loss: 1965.1434326
	speed: 0.0409s/iter; left time: 4721.1026s
	iters: 2000, epoch: 2 | loss: 393.9914551
	speed: 0.0537s/iter; left time: 6598.8386s
	iters: 900, epoch: 4 | loss: 845.9348755
	speed: 0.0418s/iter; left time: 4825.0559s
	iters: 2100, epoch: 2 | loss: 404.4003906
	speed: 0.0529s/iter; left time: 6493.7402s
	iters: 1000, epoch: 4 | loss: 461.5948792
	speed: 0.0361s/iter; left time: 4164.5470s
	iters: 1100, epoch: 4 | loss: 511.3786316
	speed: 0.0421s/iter; left time: 4846.3892s
	iters: 2200, epoch: 2 | loss: 555.8436279
	speed: 0.0576s/iter; left time: 7065.5436s
	iters: 1200, epoch: 4 | loss: 4511.5537109
	speed: 0.0358s/iter; left time: 4124.0783s
	iters: 1300, epoch: 4 | loss: 4723.3500977
	speed: 0.0374s/iter; left time: 4305.6992s
	iters: 2300, epoch: 2 | loss: 403.5586548
	speed: 0.0595s/iter; left time: 7297.8845s
	iters: 1400, epoch: 4 | loss: 5164.4399414
	speed: 0.0365s/iter; left time: 4194.5624s
	iters: 2400, epoch: 2 | loss: 446.6958008
	speed: 0.0594s/iter; left time: 7283.1410s
	iters: 1500, epoch: 4 | loss: 4225.2636719
	speed: 0.0396s/iter; left time: 4547.8772s
	iters: 1600, epoch: 4 | loss: 4104.3100586
	speed: 0.0352s/iter; left time: 4041.2160s
	iters: 2500, epoch: 2 | loss: 494.7507019
	speed: 0.0625s/iter; left time: 7649.0343s
	iters: 1700, epoch: 4 | loss: 2670.4316406
	speed: 0.0388s/iter; left time: 4444.2130s
	iters: 2600, epoch: 2 | loss: 489.4455872
	speed: 0.0627s/iter; left time: 7671.8739s
	iters: 1800, epoch: 4 | loss: 3428.2500000
	speed: 0.0348s/iter; left time: 3984.6150s
	iters: 1900, epoch: 4 | loss: 2128.9155273
	speed: 0.0371s/iter; left time: 4240.6719s
	iters: 2700, epoch: 2 | loss: 461.4048462
	speed: 0.0669s/iter; left time: 8171.9911s
	iters: 2000, epoch: 4 | loss: 2118.2521973
	speed: 0.0374s/iter; left time: 4277.8968s
	iters: 2100, epoch: 4 | loss: 1844.1265869
	speed: 0.0365s/iter; left time: 4167.9830s
	iters: 2800, epoch: 2 | loss: 441.5696411
	speed: 0.0696s/iter; left time: 8506.3444s
	iters: 2200, epoch: 4 | loss: 1881.0959473
	speed: 0.0383s/iter; left time: 4375.4611s
	iters: 2300, epoch: 4 | loss: 1680.1000977
	speed: 0.0365s/iter; left time: 4159.7063s
	iters: 2900, epoch: 2 | loss: 379.9161682
	speed: 0.0683s/iter; left time: 8337.1517s
	iters: 2400, epoch: 4 | loss: 1737.6555176
	speed: 0.0421s/iter; left time: 4799.3988s
	iters: 3000, epoch: 2 | loss: 388.2662048
	speed: 0.0593s/iter; left time: 7229.7717s
	iters: 2500, epoch: 4 | loss: 1228.3642578
	speed: 0.0382s/iter; left time: 4350.0757s
	iters: 2600, epoch: 4 | loss: 1239.3590088
	speed: 0.0418s/iter; left time: 4757.0983s
	iters: 3100, epoch: 2 | loss: 528.2097168
	speed: 0.0653s/iter; left time: 7955.0669s
	iters: 2700, epoch: 4 | loss: 1004.5108643
	speed: 0.0390s/iter; left time: 4432.4896s
	iters: 2800, epoch: 4 | loss: 976.5087280
	speed: 0.0376s/iter; left time: 4264.7327s
	iters: 3200, epoch: 2 | loss: 489.7237244
	speed: 0.0611s/iter; left time: 7437.9790s
	iters: 2900, epoch: 4 | loss: 2730.8549805
	speed: 0.0387s/iter; left time: 4391.9681s
	iters: 3300, epoch: 2 | loss: 733.5765991
	speed: 0.0559s/iter; left time: 6804.0695s
	iters: 3000, epoch: 4 | loss: 935.9633179
	speed: 0.0381s/iter; left time: 4315.2087s
	iters: 3100, epoch: 4 | loss: 1788.6610107
	speed: 0.0397s/iter; left time: 4497.9563s
	iters: 3400, epoch: 2 | loss: 855.3513184
	speed: 0.0550s/iter; left time: 6685.4465s
	iters: 3200, epoch: 4 | loss: 1699.8880615
	speed: 0.0422s/iter; left time: 4777.0952s
	iters: 3500, epoch: 2 | loss: 612.8408203
	speed: 0.0623s/iter; left time: 7568.9974s
	iters: 3300, epoch: 4 | loss: 3320.6347656
	speed: 0.0446s/iter; left time: 5042.7424s
	iters: 3600, epoch: 2 | loss: 478.3423157
	speed: 0.0631s/iter; left time: 7653.0921s
	iters: 3400, epoch: 4 | loss: 1723.6225586
	speed: 0.0408s/iter; left time: 4602.4121s
	iters: 3500, epoch: 4 | loss: 2885.5036621
	speed: 0.0407s/iter; left time: 4591.7449s
	iters: 3700, epoch: 2 | loss: 664.8540649
	speed: 0.0661s/iter; left time: 8007.8862s
	iters: 3600, epoch: 4 | loss: 1513.2226562
	speed: 0.0411s/iter; left time: 4635.4463s
	iters: 3700, epoch: 4 | loss: 2382.0537109
	speed: 0.0414s/iter; left time: 4662.8498s
	iters: 3800, epoch: 2 | loss: 660.6141968
	speed: 0.0640s/iter; left time: 7758.2007s
	iters: 3800, epoch: 4 | loss: 1246.5657959
	speed: 0.0367s/iter; left time: 4133.9478s
	iters: 3900, epoch: 2 | loss: 676.2937622
	speed: 0.0650s/iter; left time: 7868.2369s
	iters: 3900, epoch: 4 | loss: 1200.8824463
	speed: 0.0359s/iter; left time: 4036.0074s
	iters: 4000, epoch: 4 | loss: 1509.1428223
	speed: 0.0338s/iter; left time: 3799.0708s
	iters: 4000, epoch: 2 | loss: 632.0435791
	speed: 0.0584s/iter; left time: 7059.5514s
	iters: 4100, epoch: 4 | loss: 1502.3553467
	speed: 0.0363s/iter; left time: 4073.1918s
	iters: 4200, epoch: 4 | loss: 1226.8726807
	speed: 0.0351s/iter; left time: 3938.9426s
	iters: 4100, epoch: 2 | loss: 540.5637817
	speed: 0.0572s/iter; left time: 6908.4130s
	iters: 4300, epoch: 4 | loss: 1291.7067871
	speed: 0.0367s/iter; left time: 4110.4712s
Epoch: 4 cost time: 168.0883288383484
	iters: 4200, epoch: 2 | loss: 655.7918701
	speed: 0.0606s/iter; left time: 7318.3596s
	iters: 4300, epoch: 2 | loss: 552.4935303
	speed: 0.0620s/iter; left time: 7479.9901s
Epoch: 2 cost time: 259.94491934776306
Epoch: 4, Steps: 4308 | Train Loss: 1727.4256673 Vali Loss: 0.5568779 Test Loss: 0.5345870
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTm1_mask_0.25_CALF_ETTm1_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt3_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11521
Epoch: 2, Steps: 4308 | Train Loss: 449.7133339 Vali Loss: 0.1398757 Test Loss: 0.2036023
Validation loss decreased (0.148890 --> 0.139876).  Saving model ...
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 2407.3994141
	speed: 2.6900s/iter; left time: 324212.8434s
	iters: 200, epoch: 3 | loss: 11862.7578125
	speed: 0.0543s/iter; left time: 6534.7909s
	iters: 300, epoch: 3 | loss: 12146.1074219
	speed: 0.0526s/iter; left time: 6328.8001s
	iters: 400, epoch: 3 | loss: 6368.4443359
	speed: 0.0599s/iter; left time: 7203.9403s
	iters: 500, epoch: 3 | loss: 2689.8623047
	speed: 0.0546s/iter; left time: 6556.9580s
test shape: (11521, 96, 7) (11521, 96, 7)
mse:0.3751242160797119, mae:0.40797707438468933
	iters: 600, epoch: 3 | loss: 4508.9653320
	speed: 0.0614s/iter; left time: 7364.8910s
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTm1_mask_0.375    Model:              CALF                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.375               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
	iters: 700, epoch: 3 | loss: 2756.1669922
	speed: 0.0659s/iter; left time: 7899.9474s
>>>>>>>start training : imputation_ETTm1_mask_0.375_CALF_ETTm1_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt3_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34465
val 11521
test 11521
	iters: 800, epoch: 3 | loss: 2509.9804688
	speed: 0.0567s/iter; left time: 6799.2859s
	iters: 100, epoch: 1 | loss: 0.5416216
	speed: 0.0532s/iter; left time: 6864.6561s
	iters: 900, epoch: 3 | loss: 2974.2045898
	speed: 0.0542s/iter; left time: 6485.4505s
	iters: 200, epoch: 1 | loss: 1.0204045
	speed: 0.0373s/iter; left time: 4814.7925s
	iters: 300, epoch: 1 | loss: 2.6930113
	speed: 0.0348s/iter; left time: 4483.5463s
	iters: 1000, epoch: 3 | loss: 2829.2712402
	speed: 0.0616s/iter; left time: 7371.1455s
	iters: 400, epoch: 1 | loss: 2.8273280
	speed: 0.0362s/iter; left time: 4669.4489s
	iters: 500, epoch: 1 | loss: 3.7876279
	speed: 0.0353s/iter; left time: 4546.0702s
	iters: 1100, epoch: 3 | loss: 2690.3471680
	speed: 0.0569s/iter; left time: 6795.9867s
	iters: 600, epoch: 1 | loss: 5.4361725
	speed: 0.0365s/iter; left time: 4700.0763s
	iters: 1200, epoch: 3 | loss: 3269.1210938
	speed: 0.0534s/iter; left time: 6376.6656s
	iters: 700, epoch: 1 | loss: 5.8909097
	speed: 0.0360s/iter; left time: 4633.7676s
	iters: 800, epoch: 1 | loss: 5.9284582
	speed: 0.0349s/iter; left time: 4487.2370s
	iters: 1300, epoch: 3 | loss: 1794.0400391
	speed: 0.0546s/iter; left time: 6520.0949s
	iters: 900, epoch: 1 | loss: 7.4443789
	speed: 0.0368s/iter; left time: 4716.5754s
	iters: 1400, epoch: 3 | loss: 2427.4067383
	speed: 0.0553s/iter; left time: 6589.4287s
	iters: 1000, epoch: 1 | loss: 8.9248772
	speed: 0.0367s/iter; left time: 4711.7905s
	iters: 1100, epoch: 1 | loss: 8.5427055
	speed: 0.0353s/iter; left time: 4528.6327s
	iters: 1500, epoch: 3 | loss: 1508.6369629
	speed: 0.0571s/iter; left time: 6807.0513s
	iters: 1200, epoch: 1 | loss: 8.8604355
	speed: 0.0352s/iter; left time: 4510.1042s
	iters: 1600, epoch: 3 | loss: 874.9756470
	speed: 0.0631s/iter; left time: 7506.1183s
	iters: 1300, epoch: 1 | loss: 8.6235275
	speed: 0.0418s/iter; left time: 5353.6512s
	iters: 1400, epoch: 1 | loss: 23.0534420
	speed: 0.0447s/iter; left time: 5708.5721s
	iters: 1700, epoch: 3 | loss: 1151.8168945
	speed: 0.0671s/iter; left time: 7974.3470s
	iters: 1500, epoch: 1 | loss: 23.8354836
	speed: 0.0346s/iter; left time: 4422.7234s
	iters: 1600, epoch: 1 | loss: 26.8419991
	speed: 0.0339s/iter; left time: 4321.4406s
	iters: 1800, epoch: 3 | loss: 860.0178223
	speed: 0.0629s/iter; left time: 7477.4496s
	iters: 1700, epoch: 1 | loss: 21.4391003
	speed: 0.0347s/iter; left time: 4428.1665s
	iters: 1800, epoch: 1 | loss: 18.7480450
	speed: 0.0354s/iter; left time: 4517.2488s
	iters: 1900, epoch: 3 | loss: 1313.7802734
	speed: 0.0609s/iter; left time: 7228.3942s
	iters: 1900, epoch: 1 | loss: 21.0281467
	speed: 0.0339s/iter; left time: 4314.1904s
	iters: 2000, epoch: 3 | loss: 1209.5798340
	speed: 0.0564s/iter; left time: 6685.9586s
	iters: 2000, epoch: 1 | loss: 27.3109703
	speed: 0.0354s/iter; left time: 4502.9559s
	iters: 2100, epoch: 1 | loss: 50.5923767
	speed: 0.0356s/iter; left time: 4524.3350s
	iters: 2100, epoch: 3 | loss: 1022.0317383
	speed: 0.0567s/iter; left time: 6725.3140s
	iters: 2200, epoch: 1 | loss: 10.8489513
	speed: 0.0350s/iter; left time: 4451.7280s
	iters: 2200, epoch: 3 | loss: 1265.5469971
	speed: 0.0537s/iter; left time: 6360.9140s
	iters: 2300, epoch: 1 | loss: 8.8983660
	speed: 0.0351s/iter; left time: 4450.4335s
	iters: 2400, epoch: 1 | loss: 8.4309311
	speed: 0.0383s/iter; left time: 4854.3743s
	iters: 2300, epoch: 3 | loss: 1071.7686768
	speed: 0.0529s/iter; left time: 6263.3741s
	iters: 2500, epoch: 1 | loss: 9.9032526
	speed: 0.0385s/iter; left time: 4885.3927s
	iters: 2400, epoch: 3 | loss: 1101.9484863
	speed: 0.0562s/iter; left time: 6649.3893s
	iters: 2600, epoch: 1 | loss: 9.6214428
	speed: 0.0380s/iter; left time: 4818.5561s
	iters: 2500, epoch: 3 | loss: 1131.9682617
	speed: 0.0505s/iter; left time: 5965.8647s
	iters: 2700, epoch: 1 | loss: 102.9350739
	speed: 0.0430s/iter; left time: 5440.3675s
	iters: 2800, epoch: 1 | loss: 90.3083344
	speed: 0.0442s/iter; left time: 5587.4108s
	iters: 2600, epoch: 3 | loss: 1143.4840088
	speed: 0.0522s/iter; left time: 6157.7039s
	iters: 2900, epoch: 1 | loss: 102.8541489
	speed: 0.0428s/iter; left time: 5412.5863s
	iters: 2700, epoch: 3 | loss: 878.6793823
	speed: 0.0529s/iter; left time: 6242.7113s
	iters: 3000, epoch: 1 | loss: 79.3334961
	speed: 0.0435s/iter; left time: 5487.0310s
	iters: 2800, epoch: 3 | loss: 1218.6010742
	speed: 0.0555s/iter; left time: 6535.9367s
	iters: 3100, epoch: 1 | loss: 74.2130356
	speed: 0.0385s/iter; left time: 4859.3745s
	iters: 3200, epoch: 1 | loss: 38.7838898
	speed: 0.0382s/iter; left time: 4813.5346s
	iters: 2900, epoch: 3 | loss: 1116.4788818
	speed: 0.0529s/iter; left time: 6222.9705s
	iters: 3300, epoch: 1 | loss: 51.2561951
	speed: 0.0391s/iter; left time: 4921.4170s
	iters: 3000, epoch: 3 | loss: 1410.0502930
	speed: 0.0556s/iter; left time: 6540.8594s
	iters: 3400, epoch: 1 | loss: 37.1733322
	speed: 0.0374s/iter; left time: 4708.6385s
	iters: 3100, epoch: 3 | loss: 1440.8771973
	speed: 0.0525s/iter; left time: 6168.8464s
	iters: 3500, epoch: 1 | loss: 33.5704613
	speed: 0.0395s/iter; left time: 4972.4227s
	iters: 3600, epoch: 1 | loss: 38.5093803
	speed: 0.0340s/iter; left time: 4273.7634s
	iters: 3200, epoch: 3 | loss: 1211.0852051
	speed: 0.0555s/iter; left time: 6513.8421s
	iters: 3700, epoch: 1 | loss: 35.7739677
	speed: 0.0335s/iter; left time: 4201.6838s
	iters: 3800, epoch: 1 | loss: 30.2049160
	speed: 0.0340s/iter; left time: 4262.6721s
	iters: 3300, epoch: 3 | loss: 1430.5273438
	speed: 0.0530s/iter; left time: 6217.2926s
	iters: 3900, epoch: 1 | loss: 36.6483192
	speed: 0.0378s/iter; left time: 4738.1587s
	iters: 3400, epoch: 3 | loss: 1480.4801025
	speed: 0.0600s/iter; left time: 7028.6889s
	iters: 4000, epoch: 1 | loss: 29.5528908
	speed: 0.0347s/iter; left time: 4351.8547s
	iters: 4100, epoch: 1 | loss: 31.2132683
	speed: 0.0404s/iter; left time: 5054.6422s
	iters: 3500, epoch: 3 | loss: 1568.7934570
	speed: 0.0532s/iter; left time: 6225.9972s
	iters: 4200, epoch: 1 | loss: 29.5215454
	speed: 0.0369s/iter; left time: 4614.8030s
	iters: 3600, epoch: 3 | loss: 1535.6437988
	speed: 0.0651s/iter; left time: 7623.8145s
	iters: 4300, epoch: 1 | loss: 52.2297516
	speed: 0.0335s/iter; left time: 4191.1423s
Epoch: 1 cost time: 161.82357048988342
	iters: 3700, epoch: 3 | loss: 1577.5760498
	speed: 0.0674s/iter; left time: 7885.6436s
	iters: 3800, epoch: 3 | loss: 1654.8728027
	speed: 0.0536s/iter; left time: 6261.7349s
	iters: 3900, epoch: 3 | loss: 2010.2517090
	speed: 0.0539s/iter; left time: 6294.9374s
	iters: 4000, epoch: 3 | loss: 1375.8253174
	speed: 0.0712s/iter; left time: 8305.4155s
	iters: 4100, epoch: 3 | loss: 3278.9404297
	speed: 0.0694s/iter; left time: 8089.9250s
	iters: 4200, epoch: 3 | loss: 3279.7827148
	speed: 0.0594s/iter; left time: 6920.1779s
	iters: 4300, epoch: 3 | loss: 3673.2353516
	speed: 0.0530s/iter; left time: 6167.2199s
Epoch: 3 cost time: 248.1541588306427
Epoch: 1, Steps: 4308 | Train Loss: 27.6519079 Vali Loss: 0.2870059 Test Loss: 0.3143080
Validation loss decreased (inf --> 0.287006).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 133.7232208
	speed: 1.6833s/iter; left time: 210128.6703s
	iters: 200, epoch: 2 | loss: 51.1463623
	speed: 0.0354s/iter; left time: 4410.6335s
	iters: 300, epoch: 2 | loss: 54.1529236
	speed: 0.0356s/iter; left time: 4438.6020s
	iters: 400, epoch: 2 | loss: 64.0337296
	speed: 0.0373s/iter; left time: 4648.9476s
	iters: 500, epoch: 2 | loss: 59.5742264
	speed: 0.0439s/iter; left time: 5460.8199s
	iters: 600, epoch: 2 | loss: 59.9715767
	speed: 0.0402s/iter; left time: 4995.0373s
	iters: 700, epoch: 2 | loss: 63.3434486
	speed: 0.0411s/iter; left time: 5104.7484s
	iters: 800, epoch: 2 | loss: 46.4035034
	speed: 0.0423s/iter; left time: 5255.6888s
	iters: 900, epoch: 2 | loss: 51.8169937
	speed: 0.0368s/iter; left time: 4565.9371s
	iters: 1000, epoch: 2 | loss: 45.8485413
	speed: 0.0396s/iter; left time: 4909.5239s
	iters: 1100, epoch: 2 | loss: 62.3318710
	speed: 0.0358s/iter; left time: 4431.9341s
	iters: 1200, epoch: 2 | loss: 359.3319397
	speed: 0.0349s/iter; left time: 4313.1307s
	iters: 1300, epoch: 2 | loss: 352.5147705
	speed: 0.0384s/iter; left time: 4746.7195s
	iters: 1400, epoch: 2 | loss: 404.2358704
	speed: 0.0343s/iter; left time: 4239.8230s
	iters: 1500, epoch: 2 | loss: 403.0344238
	speed: 0.0343s/iter; left time: 4239.5156s
	iters: 1600, epoch: 2 | loss: 398.6141357
	speed: 0.0354s/iter; left time: 4365.0601s
	iters: 1700, epoch: 2 | loss: 254.9917603
	speed: 0.0422s/iter; left time: 5204.0900s
	iters: 1800, epoch: 2 | loss: 257.7122803
	speed: 0.0405s/iter; left time: 4984.6911s
	iters: 1900, epoch: 2 | loss: 283.9365845
	speed: 0.0398s/iter; left time: 4899.6644s
	iters: 2000, epoch: 2 | loss: 250.0227661
	speed: 0.0383s/iter; left time: 4708.0234s
	iters: 2100, epoch: 2 | loss: 236.1554871
	speed: 0.0372s/iter; left time: 4567.1933s
	iters: 2200, epoch: 2 | loss: 260.7442017
	speed: 0.0356s/iter; left time: 4374.3629s
	iters: 2300, epoch: 2 | loss: 237.3237762
	speed: 0.0351s/iter; left time: 4310.1934s
	iters: 2400, epoch: 2 | loss: 206.1944733
	speed: 0.0362s/iter; left time: 4439.3716s
	iters: 2500, epoch: 2 | loss: 248.9498138
	speed: 0.0386s/iter; left time: 4725.0712s
	iters: 2600, epoch: 2 | loss: 321.0872498
	speed: 0.0432s/iter; left time: 5288.6693s
	iters: 2700, epoch: 2 | loss: 848.9465332
	speed: 0.0437s/iter; left time: 5337.8808s
	iters: 2800, epoch: 2 | loss: 3718.7453613
	speed: 0.0420s/iter; left time: 5133.2629s
	iters: 2900, epoch: 2 | loss: 1400.0439453
	speed: 0.0431s/iter; left time: 5257.8297s
	iters: 3000, epoch: 2 | loss: 763.9544067
	speed: 0.0435s/iter; left time: 5299.0192s
	iters: 3100, epoch: 2 | loss: 683.5466919
	speed: 0.0457s/iter; left time: 5571.0088s
	iters: 3200, epoch: 2 | loss: 769.5140381
	speed: 0.0448s/iter; left time: 5458.7965s
	iters: 3300, epoch: 2 | loss: 526.5235596
	speed: 0.0435s/iter; left time: 5290.0184s
Epoch: 3, Steps: 4308 | Train Loss: 2735.6135653 Vali Loss: 0.1452144 Test Loss: 0.2128808
EarlyStopping counter: 1 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 3400, epoch: 2 | loss: 478.6618347
	speed: 0.0428s/iter; left time: 5205.9889s
	iters: 3500, epoch: 2 | loss: 426.0820007
	speed: 0.0397s/iter; left time: 4822.4095s
	iters: 100, epoch: 4 | loss: 3412.0529785
	speed: 2.6220s/iter; left time: 304724.0023s
	iters: 3600, epoch: 2 | loss: 392.8286743
	speed: 0.0388s/iter; left time: 4713.2012s
	iters: 200, epoch: 4 | loss: 2411.5151367
	speed: 0.0546s/iter; left time: 6334.6321s
	iters: 3700, epoch: 2 | loss: 560.5710449
	speed: 0.0404s/iter; left time: 4896.9975s
	iters: 3800, epoch: 2 | loss: 352.3342590
	speed: 0.0369s/iter; left time: 4475.2702s
	iters: 300, epoch: 4 | loss: 1876.8089600
	speed: 0.0552s/iter; left time: 6404.2421s
	iters: 3900, epoch: 2 | loss: 400.6420288
	speed: 0.0347s/iter; left time: 4203.2742s
	iters: 400, epoch: 4 | loss: 2305.5395508
	speed: 0.0557s/iter; left time: 6459.6619s
	iters: 4000, epoch: 2 | loss: 382.4625549
	speed: 0.0376s/iter; left time: 4547.9685s
	iters: 4100, epoch: 2 | loss: 327.3964844
	speed: 0.0389s/iter; left time: 4701.7622s
	iters: 500, epoch: 4 | loss: 2389.3872070
	speed: 0.0533s/iter; left time: 6178.3960s
	iters: 4200, epoch: 2 | loss: 380.6406555
	speed: 0.0357s/iter; left time: 4310.9872s
	iters: 600, epoch: 4 | loss: 2106.2758789
	speed: 0.0540s/iter; left time: 6250.6976s
	iters: 4300, epoch: 2 | loss: 323.8997192
	speed: 0.0404s/iter; left time: 4869.1097s
Epoch: 2 cost time: 168.94189763069153
	iters: 700, epoch: 4 | loss: 1468.9713135
	speed: 0.0579s/iter; left time: 6691.6579s
	iters: 800, epoch: 4 | loss: 2193.4199219
	speed: 0.0528s/iter; left time: 6100.8046s
	iters: 900, epoch: 4 | loss: 1874.0047607
	speed: 0.0549s/iter; left time: 6334.3424s
	iters: 1000, epoch: 4 | loss: 1562.1333008
	speed: 0.0563s/iter; left time: 6496.8419s
	iters: 1100, epoch: 4 | loss: 1732.4135742
	speed: 0.0561s/iter; left time: 6460.9596s
	iters: 1200, epoch: 4 | loss: 1984.6510010
	speed: 0.0625s/iter; left time: 7194.7222s
	iters: 1300, epoch: 4 | loss: 1765.1009521
	speed: 0.0588s/iter; left time: 6762.8278s
	iters: 1400, epoch: 4 | loss: 1809.0161133
	speed: 0.0533s/iter; left time: 6130.3107s
	iters: 1500, epoch: 4 | loss: 2147.2998047
	speed: 0.0609s/iter; left time: 6989.5570s
	iters: 1600, epoch: 4 | loss: 2841.7934570
	speed: 0.0554s/iter; left time: 6354.5171s
	iters: 1700, epoch: 4 | loss: 2468.8952637
	speed: 0.0549s/iter; left time: 6289.8098s
	iters: 1800, epoch: 4 | loss: 2909.4667969
	speed: 0.0532s/iter; left time: 6094.2966s
	iters: 1900, epoch: 4 | loss: 3365.6557617
	speed: 0.0576s/iter; left time: 6592.8852s
	iters: 2000, epoch: 4 | loss: 2479.9492188
	speed: 0.0541s/iter; left time: 6189.9126s
	iters: 2100, epoch: 4 | loss: 3560.7153320
	speed: 0.0519s/iter; left time: 5925.4442s
	iters: 2200, epoch: 4 | loss: 3593.5131836
	speed: 0.0503s/iter; left time: 5736.3859s
	iters: 2300, epoch: 4 | loss: 2817.1464844
	speed: 0.0526s/iter; left time: 5994.5701s
	iters: 2400, epoch: 4 | loss: 3717.0996094
	speed: 0.0531s/iter; left time: 6051.2477s
	iters: 2500, epoch: 4 | loss: 3689.0886230
	speed: 0.0552s/iter; left time: 6282.5122s
	iters: 2600, epoch: 4 | loss: 4217.9658203
	speed: 0.0559s/iter; left time: 6361.7013s
	iters: 2700, epoch: 4 | loss: 3192.4184570
	speed: 0.0513s/iter; left time: 5825.7781s
	iters: 2800, epoch: 4 | loss: 3229.4694824
	speed: 0.0526s/iter; left time: 5967.3464s
	iters: 2900, epoch: 4 | loss: 1879.2709961
	speed: 0.0548s/iter; left time: 6212.0727s
	iters: 3000, epoch: 4 | loss: 2909.0837402
	speed: 0.0631s/iter; left time: 7147.0995s
	iters: 3100, epoch: 4 | loss: 4436.2905273
	speed: 0.0605s/iter; left time: 6851.2237s
	iters: 3200, epoch: 4 | loss: 3427.8908691
	speed: 0.0616s/iter; left time: 6968.7268s
	iters: 3300, epoch: 4 | loss: 3634.4536133
	speed: 0.0637s/iter; left time: 7201.1484s
	iters: 3400, epoch: 4 | loss: 2138.9858398
	speed: 0.0613s/iter; left time: 6924.1008s
	iters: 3500, epoch: 4 | loss: 2906.2138672
	speed: 0.0636s/iter; left time: 7175.7093s
Epoch: 2, Steps: 4308 | Train Loss: 401.9184523 Vali Loss: 0.5579281 Test Loss: 0.5490975
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 617.1186523
	speed: 1.6771s/iter; left time: 202134.4597s
	iters: 3600, epoch: 4 | loss: 2565.8559570
	speed: 0.0595s/iter; left time: 6708.5838s
	iters: 200, epoch: 3 | loss: 699.4983521
	speed: 0.0427s/iter; left time: 5136.4637s
	iters: 3700, epoch: 4 | loss: 2968.0822754
	speed: 0.0530s/iter; left time: 5968.6193s
	iters: 300, epoch: 3 | loss: 362.0843506
	speed: 0.0422s/iter; left time: 5073.3482s
	iters: 3800, epoch: 4 | loss: 3376.2077637
	speed: 0.0522s/iter; left time: 5874.5648s
	iters: 400, epoch: 3 | loss: 284.3500671
	speed: 0.0384s/iter; left time: 4618.2545s
	iters: 3900, epoch: 4 | loss: 2306.1018066
	speed: 0.0496s/iter; left time: 5578.5913s
	iters: 500, epoch: 3 | loss: 344.3119202
	speed: 0.0457s/iter; left time: 5488.0189s
	iters: 600, epoch: 3 | loss: 327.3054199
	speed: 0.0449s/iter; left time: 5384.8003s
	iters: 4000, epoch: 4 | loss: 4296.7885742
	speed: 0.0502s/iter; left time: 5642.8124s
	iters: 700, epoch: 3 | loss: 351.3544922
	speed: 0.0390s/iter; left time: 4681.9753s
	iters: 4100, epoch: 4 | loss: 3008.5878906
	speed: 0.0504s/iter; left time: 5656.6748s
	iters: 800, epoch: 3 | loss: 361.0196838
	speed: 0.0374s/iter; left time: 4479.9029s
	iters: 4200, epoch: 4 | loss: 4436.5532227
	speed: 0.0523s/iter; left time: 5865.1123s
	iters: 900, epoch: 3 | loss: 327.0834656
	speed: 0.0425s/iter; left time: 5082.9518s
	iters: 1000, epoch: 3 | loss: 297.5132446
	speed: 0.0340s/iter; left time: 4068.6011s
	iters: 4300, epoch: 4 | loss: 2508.0473633
	speed: 0.0531s/iter; left time: 5949.1495s
Epoch: 4 cost time: 240.58469414710999
	iters: 1100, epoch: 3 | loss: 368.9292297
	speed: 0.0374s/iter; left time: 4468.7725s
	iters: 1200, epoch: 3 | loss: 322.9329224
	speed: 0.0385s/iter; left time: 4601.3034s
	iters: 1300, epoch: 3 | loss: 311.4767456
	speed: 0.0355s/iter; left time: 4234.7282s
	iters: 1400, epoch: 3 | loss: 304.3801880
	speed: 0.0382s/iter; left time: 4552.6124s
	iters: 1500, epoch: 3 | loss: 339.5380859
	speed: 0.0365s/iter; left time: 4351.1345s
	iters: 1600, epoch: 3 | loss: 361.4414062
	speed: 0.0340s/iter; left time: 4047.8626s
	iters: 1700, epoch: 3 | loss: 326.7308350
	speed: 0.0365s/iter; left time: 4343.5305s
	iters: 1800, epoch: 3 | loss: 293.5560913
	speed: 0.0372s/iter; left time: 4425.2841s
	iters: 1900, epoch: 3 | loss: 324.8149414
	speed: 0.0374s/iter; left time: 4443.0123s
	iters: 2000, epoch: 3 | loss: 287.6376343
	speed: 0.0371s/iter; left time: 4405.3569s
	iters: 2100, epoch: 3 | loss: 332.0892334
	speed: 0.0365s/iter; left time: 4330.9273s
	iters: 2200, epoch: 3 | loss: 350.9907837
	speed: 0.0364s/iter; left time: 4315.8040s
	iters: 2300, epoch: 3 | loss: 351.5896606
	speed: 0.0374s/iter; left time: 4421.8594s
	iters: 2400, epoch: 3 | loss: 344.9365845
	speed: 0.0394s/iter; left time: 4653.8269s
	iters: 2500, epoch: 3 | loss: 420.1750488
	speed: 0.0379s/iter; left time: 4473.1934s
	iters: 2600, epoch: 3 | loss: 314.1878662
	speed: 0.0380s/iter; left time: 4485.9582s
	iters: 2700, epoch: 3 | loss: 381.6826477
	speed: 0.0330s/iter; left time: 3887.5607s
	iters: 2800, epoch: 3 | loss: 466.2668762
	speed: 0.0345s/iter; left time: 4065.7458s
	iters: 2900, epoch: 3 | loss: 376.7023926
	speed: 0.0362s/iter; left time: 4266.9222s
	iters: 3000, epoch: 3 | loss: 347.5039368
	speed: 0.0348s/iter; left time: 4093.3444s
	iters: 3100, epoch: 3 | loss: 397.4311523
	speed: 0.0331s/iter; left time: 3889.9006s
	iters: 3200, epoch: 3 | loss: 370.5536194
	speed: 0.0354s/iter; left time: 4155.3676s
	iters: 3300, epoch: 3 | loss: 305.0596619
	speed: 0.0367s/iter; left time: 4308.3308s
	iters: 3400, epoch: 3 | loss: 388.8193054
	speed: 0.0348s/iter; left time: 4075.4809s
	iters: 3500, epoch: 3 | loss: 385.0469055
	speed: 0.0333s/iter; left time: 3896.9606s
	iters: 3600, epoch: 3 | loss: 420.9530029
	speed: 0.0375s/iter; left time: 4390.6835s
	iters: 3700, epoch: 3 | loss: 488.3302917
	speed: 0.0384s/iter; left time: 4484.7643s
	iters: 3800, epoch: 3 | loss: 341.3858948
	speed: 0.0380s/iter; left time: 4440.6067s
	iters: 3900, epoch: 3 | loss: 468.0287781
	speed: 0.0397s/iter; left time: 4636.2968s
	iters: 4000, epoch: 3 | loss: 406.2612915
	speed: 0.0353s/iter; left time: 4111.2786s
	iters: 4100, epoch: 3 | loss: 370.8554382
	speed: 0.0368s/iter; left time: 4287.0735s
	iters: 4200, epoch: 3 | loss: 530.1979370
	speed: 0.0353s/iter; left time: 4112.7012s
	iters: 4300, epoch: 3 | loss: 438.6157837
	speed: 0.0412s/iter; left time: 4796.6557s
Epoch: 3 cost time: 162.57046270370483
Epoch: 4, Steps: 4308 | Train Loss: 2842.6473330 Vali Loss: 0.1796405 Test Loss: 0.2621604
EarlyStopping counter: 2 out of 3
lr_adjust = {4: 0.00045000000000000004}
Updating learning rate to 0.00045000000000000004
	iters: 100, epoch: 5 | loss: 4487.9604492
	speed: 2.6222s/iter; left time: 293450.0691s
	iters: 200, epoch: 5 | loss: 2850.2470703
	speed: 0.0700s/iter; left time: 7824.0850s
	iters: 300, epoch: 5 | loss: 3603.7155762
	speed: 0.0585s/iter; left time: 6533.7172s
	iters: 400, epoch: 5 | loss: 3558.5219727
	speed: 0.0594s/iter; left time: 6626.4733s
Epoch: 3, Steps: 4308 | Train Loss: 386.3908681 Vali Loss: 0.5520939 Test Loss: 0.5507790
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 500, epoch: 5 | loss: 2745.0505371
	speed: 0.0574s/iter; left time: 6397.9657s
	iters: 100, epoch: 4 | loss: 499.2446899
	speed: 1.6791s/iter; left time: 195142.5162s
	iters: 600, epoch: 5 | loss: 3208.4416504
	speed: 0.0531s/iter; left time: 5912.3690s
	iters: 200, epoch: 4 | loss: 681.1740112
	speed: 0.0419s/iter; left time: 4862.2770s
	iters: 300, epoch: 4 | loss: 865.1582031
	speed: 0.0378s/iter; left time: 4381.2683s
	iters: 700, epoch: 5 | loss: 2697.2165527
	speed: 0.0507s/iter; left time: 5647.1357s
	iters: 400, epoch: 4 | loss: 741.3029785
	speed: 0.0372s/iter; left time: 4312.7437s
	iters: 800, epoch: 5 | loss: 2084.1411133
	speed: 0.0535s/iter; left time: 5950.1191s
	iters: 500, epoch: 4 | loss: 758.1842041
	speed: 0.0382s/iter; left time: 4420.5873s
	iters: 600, epoch: 4 | loss: 1155.9041748
	speed: 0.0371s/iter; left time: 4295.4489s
	iters: 900, epoch: 5 | loss: 2468.0534668
	speed: 0.0510s/iter; left time: 5667.6967s
	iters: 700, epoch: 4 | loss: 872.5279541
	speed: 0.0382s/iter; left time: 4415.4182s
	iters: 1000, epoch: 5 | loss: 2218.1772461
	speed: 0.0530s/iter; left time: 5879.2478s
	iters: 800, epoch: 4 | loss: 925.8502197
	speed: 0.0372s/iter; left time: 4295.6025s
	iters: 1100, epoch: 5 | loss: 3679.6916504
	speed: 0.0508s/iter; left time: 5629.3574s
	iters: 900, epoch: 4 | loss: 926.1116943
	speed: 0.0363s/iter; left time: 4194.8868s
	iters: 1000, epoch: 4 | loss: 915.2077026
	speed: 0.0349s/iter; left time: 4028.1831s
	iters: 1200, epoch: 5 | loss: 2496.5966797
	speed: 0.0503s/iter; left time: 5578.2970s
	iters: 1100, epoch: 4 | loss: 820.0786133
	speed: 0.0379s/iter; left time: 4365.3238s
	iters: 1300, epoch: 5 | loss: 2202.7807617
	speed: 0.0505s/iter; left time: 5589.4031s
	iters: 1200, epoch: 4 | loss: 968.2718506
	speed: 0.0345s/iter; left time: 3976.8100s
	iters: 1300, epoch: 4 | loss: 845.6378174
	speed: 0.0341s/iter; left time: 3919.7503s
	iters: 1400, epoch: 5 | loss: 3568.7421875
	speed: 0.0557s/iter; left time: 6160.2395s
	iters: 1400, epoch: 4 | loss: 750.1484375
	speed: 0.0339s/iter; left time: 3892.4792s
	iters: 1500, epoch: 5 | loss: 2919.1931152
	speed: 0.0519s/iter; left time: 5733.6853s
	iters: 1500, epoch: 4 | loss: 1228.1881104
	speed: 0.0360s/iter; left time: 4127.8973s
	iters: 1600, epoch: 4 | loss: 837.0424194
	speed: 0.0332s/iter; left time: 3812.6251s
	iters: 1600, epoch: 5 | loss: 3428.7856445
	speed: 0.0526s/iter; left time: 5812.6504s
	iters: 1700, epoch: 4 | loss: 918.7902222
	speed: 0.0348s/iter; left time: 3989.0985s
	iters: 1700, epoch: 5 | loss: 4063.7807617
	speed: 0.0589s/iter; left time: 6500.8054s
	iters: 1800, epoch: 4 | loss: 1078.5031738
	speed: 0.0376s/iter; left time: 4310.1285s
	iters: 1900, epoch: 4 | loss: 1059.1431885
	speed: 0.0369s/iter; left time: 4222.2918s
	iters: 1800, epoch: 5 | loss: 2917.7448730
	speed: 0.0588s/iter; left time: 6475.0066s
	iters: 2000, epoch: 4 | loss: 1101.1588135
	speed: 0.0369s/iter; left time: 4223.8888s
	iters: 2100, epoch: 4 | loss: 1076.2183838
	speed: 0.0401s/iter; left time: 4576.9965s
	iters: 1900, epoch: 5 | loss: 4441.4584961
	speed: 0.0572s/iter; left time: 6302.4081s
	iters: 2200, epoch: 4 | loss: 998.8485107
	speed: 0.0365s/iter; left time: 4160.5237s
	iters: 2000, epoch: 5 | loss: 3477.4489746
	speed: 0.0533s/iter; left time: 5864.2573s
	iters: 2300, epoch: 4 | loss: 1187.6184082
	speed: 0.0359s/iter; left time: 4091.4824s
	iters: 2100, epoch: 5 | loss: 3063.1140137
	speed: 0.0517s/iter; left time: 5687.6453s
	iters: 2400, epoch: 4 | loss: 1196.5535889
	speed: 0.0401s/iter; left time: 4571.2193s
	iters: 2500, epoch: 4 | loss: 1317.4404297
	speed: 0.0373s/iter; left time: 4245.7253s
	iters: 2200, epoch: 5 | loss: 3289.9575195
	speed: 0.0525s/iter; left time: 5760.1514s
	iters: 2600, epoch: 4 | loss: 1187.1320801
	speed: 0.0361s/iter; left time: 4104.2563s
	iters: 2300, epoch: 5 | loss: 3665.0395508
	speed: 0.0523s/iter; left time: 5737.9547s
	iters: 2700, epoch: 4 | loss: 1511.4239502
	speed: 0.0356s/iter; left time: 4042.5070s
	iters: 2800, epoch: 4 | loss: 1200.4809570
	speed: 0.0371s/iter; left time: 4215.0005s
	iters: 2400, epoch: 5 | loss: 3089.7509766
	speed: 0.0531s/iter; left time: 5815.5946s
	iters: 2900, epoch: 4 | loss: 1540.4104004
	speed: 0.0389s/iter; left time: 4408.8077s
	iters: 2500, epoch: 5 | loss: 2868.6166992
	speed: 0.0558s/iter; left time: 6105.4858s
	iters: 3000, epoch: 4 | loss: 1160.0422363
	speed: 0.0375s/iter; left time: 4244.1489s
	iters: 2600, epoch: 5 | loss: 3568.7094727
	speed: 0.0525s/iter; left time: 5747.4330s
	iters: 3100, epoch: 4 | loss: 1496.3348389
	speed: 0.0392s/iter; left time: 4434.2759s
	iters: 3200, epoch: 4 | loss: 3785.3725586
	speed: 0.0363s/iter; left time: 4109.3210s
	iters: 2700, epoch: 5 | loss: 2894.2807617
	speed: 0.0600s/iter; left time: 6557.8655s
	iters: 3300, epoch: 4 | loss: 959.9993286
	speed: 0.0378s/iter; left time: 4275.6454s
	iters: 3400, epoch: 4 | loss: 1356.7546387
	speed: 0.0394s/iter; left time: 4444.1551s
	iters: 2800, epoch: 5 | loss: 3101.5397949
	speed: 0.0563s/iter; left time: 6143.4182s
	iters: 3500, epoch: 4 | loss: 1308.2326660
	speed: 0.0394s/iter; left time: 4439.7117s
	iters: 2900, epoch: 5 | loss: 2683.0361328
	speed: 0.0608s/iter; left time: 6637.8821s
	iters: 3600, epoch: 4 | loss: 1236.0579834
	speed: 0.0387s/iter; left time: 4366.5349s
	iters: 3700, epoch: 4 | loss: 1190.0324707
	speed: 0.0373s/iter; left time: 4199.4483s
	iters: 3000, epoch: 5 | loss: 4015.7832031
	speed: 0.0602s/iter; left time: 6564.4649s
	iters: 3800, epoch: 4 | loss: 1362.7691650
	speed: 0.0374s/iter; left time: 4202.7647s
	iters: 3100, epoch: 5 | loss: 2322.8784180
	speed: 0.0565s/iter; left time: 6148.4944s
	iters: 3900, epoch: 4 | loss: 1215.3005371
	speed: 0.0382s/iter; left time: 4297.5260s
	iters: 4000, epoch: 4 | loss: 1949.5434570
	speed: 0.0395s/iter; left time: 4433.2131s
	iters: 3200, epoch: 5 | loss: 2768.3649902
	speed: 0.0537s/iter; left time: 5838.1741s
	iters: 4100, epoch: 4 | loss: 1510.6901855
	speed: 0.0370s/iter; left time: 4152.0764s
	iters: 3300, epoch: 5 | loss: 3221.8801270
	speed: 0.0544s/iter; left time: 5913.4247s
	iters: 4200, epoch: 4 | loss: 1470.2813721
	speed: 0.0331s/iter; left time: 3714.1734s
	iters: 4300, epoch: 4 | loss: 1367.2601318
	speed: 0.0342s/iter; left time: 3833.7419s
Epoch: 4 cost time: 161.04411220550537
	iters: 3400, epoch: 5 | loss: 1881.0092773
	speed: 0.0590s/iter; left time: 6406.1055s
	iters: 3500, epoch: 5 | loss: 2029.7851562
	speed: 0.0567s/iter; left time: 6152.4881s
	iters: 3600, epoch: 5 | loss: 2434.7934570
	speed: 0.0521s/iter; left time: 5649.8402s
	iters: 3700, epoch: 5 | loss: 1947.8306885
	speed: 0.0507s/iter; left time: 5494.7373s
	iters: 3800, epoch: 5 | loss: 1900.5493164
	speed: 0.0519s/iter; left time: 5612.9900s
	iters: 3900, epoch: 5 | loss: 1961.6406250
	speed: 0.0515s/iter; left time: 5562.3663s
	iters: 4000, epoch: 5 | loss: 1686.4230957
	speed: 0.0510s/iter; left time: 5511.6747s
	iters: 4100, epoch: 5 | loss: 2524.2302246
	speed: 0.0534s/iter; left time: 5758.5246s
	iters: 4200, epoch: 5 | loss: 1990.7633057
	speed: 0.0535s/iter; left time: 5767.6773s
	iters: 4300, epoch: 5 | loss: 3373.6821289
	speed: 0.0532s/iter; left time: 5726.3759s
Epoch: 5 cost time: 236.76320099830627
Epoch: 4, Steps: 4308 | Train Loss: 1133.2521889 Vali Loss: 0.7143198 Test Loss: 0.7128137
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTm1_mask_0.375_CALF_ETTm1_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt3_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11521
test shape: (11521, 96, 7) (11521, 96, 7)
mse:0.30982506275177, mae:0.36601173877716064
Epoch: 5, Steps: 4308 | Train Loss: 2918.6737875 Vali Loss: 0.1943644 Test Loss: 0.2839997
EarlyStopping counter: 3 out of 3
Early stopping
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTm1_mask_0.5      Model:              CALF                

[1mData Loader[0m
  Data:               ETTm1               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>testing : imputation_ETTm2_mask_0.125_CALF_ETTm2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11521
>>>>>>>start training : imputation_ETTm1_mask_0.5_CALF_ETTm1_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt3_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34465
val 11521
test 11521
	iters: 100, epoch: 1 | loss: 0.6489715
	speed: 0.0552s/iter; left time: 7129.9388s
	iters: 200, epoch: 1 | loss: 0.8616124
	speed: 0.0373s/iter; left time: 4806.7962s
	iters: 300, epoch: 1 | loss: 2.4096866
	speed: 0.0408s/iter; left time: 5257.7145s
	iters: 400, epoch: 1 | loss: 2.3863921
	speed: 0.0419s/iter; left time: 5400.0823s
	iters: 500, epoch: 1 | loss: 4.4915400
	speed: 0.0409s/iter; left time: 5263.4853s
	iters: 600, epoch: 1 | loss: 3.0115602
	speed: 0.0347s/iter; left time: 4464.0028s
	iters: 700, epoch: 1 | loss: 7.1969900
	speed: 0.0356s/iter; left time: 4573.2195s
	iters: 800, epoch: 1 | loss: 7.2587476
	speed: 0.0354s/iter; left time: 4546.6987s
	iters: 900, epoch: 1 | loss: 6.4680734
	speed: 0.0355s/iter; left time: 4556.9815s
	iters: 1000, epoch: 1 | loss: 6.8131161
	speed: 0.0378s/iter; left time: 4846.7069s
	iters: 1100, epoch: 1 | loss: 5.4876661
	speed: 0.0383s/iter; left time: 4904.3042s
	iters: 1200, epoch: 1 | loss: 8.0960445
	speed: 0.0395s/iter; left time: 5061.0576s
	iters: 1300, epoch: 1 | loss: 7.1371555
	speed: 0.0412s/iter; left time: 5274.9304s
	iters: 1400, epoch: 1 | loss: 5.4359784
	speed: 0.0403s/iter; left time: 5154.6547s
	iters: 1500, epoch: 1 | loss: 11.4477978
	speed: 0.0424s/iter; left time: 5411.9113s
	iters: 1600, epoch: 1 | loss: 26.2368851
	speed: 0.0401s/iter; left time: 5117.9175s
	iters: 1700, epoch: 1 | loss: 26.5017586
	speed: 0.0359s/iter; left time: 4575.9887s
	iters: 1800, epoch: 1 | loss: 51.9310837
	speed: 0.0345s/iter; left time: 4400.3349s
	iters: 1900, epoch: 1 | loss: 46.2940598
	speed: 0.0341s/iter; left time: 4347.3441s
	iters: 2000, epoch: 1 | loss: 52.4585724
	speed: 0.0342s/iter; left time: 4349.6595s
	iters: 2100, epoch: 1 | loss: 46.6218872
	speed: 0.0343s/iter; left time: 4364.2553s
	iters: 2200, epoch: 1 | loss: 36.9076271
	speed: 0.0360s/iter; left time: 4574.4318s
	iters: 2300, epoch: 1 | loss: 41.5856590
	speed: 0.0338s/iter; left time: 4294.2384s
	iters: 2400, epoch: 1 | loss: 46.7233925
	speed: 0.0388s/iter; left time: 4915.4997s
	iters: 2500, epoch: 1 | loss: 51.7379761
	speed: 0.0338s/iter; left time: 4277.6308s
	iters: 2600, epoch: 1 | loss: 48.1036797
	speed: 0.0346s/iter; left time: 4377.9694s
	iters: 2700, epoch: 1 | loss: 54.5769730
	speed: 0.0344s/iter; left time: 4353.4727s
	iters: 2800, epoch: 1 | loss: 46.2760201
	speed: 0.0333s/iter; left time: 4211.2910s
	iters: 2900, epoch: 1 | loss: 58.0263062
	speed: 0.0345s/iter; left time: 4353.6568s
	iters: 3000, epoch: 1 | loss: 36.0247192
	speed: 0.0343s/iter; left time: 4333.3648s
	iters: 3100, epoch: 1 | loss: 30.4211922
	speed: 0.0336s/iter; left time: 4241.6538s
	iters: 3200, epoch: 1 | loss: 29.4895306
	speed: 0.0339s/iter; left time: 4273.7763s
	iters: 3300, epoch: 1 | loss: 44.8101044
	speed: 0.0343s/iter; left time: 4323.7934s
	iters: 3400, epoch: 1 | loss: 39.6465149
	speed: 0.0338s/iter; left time: 4251.6966s
	iters: 3500, epoch: 1 | loss: 42.8449631
	speed: 0.0340s/iter; left time: 4272.4873s
	iters: 3600, epoch: 1 | loss: 36.0400848
	speed: 0.0418s/iter; left time: 5245.9341s
	iters: 3700, epoch: 1 | loss: 43.7405319
	speed: 0.0409s/iter; left time: 5135.0054s
	iters: 3800, epoch: 1 | loss: 54.5553322
	speed: 0.0399s/iter; left time: 5005.9596s
	iters: 3900, epoch: 1 | loss: 63.2404060
	speed: 0.0388s/iter; left time: 4860.2348s
	iters: 4000, epoch: 1 | loss: 44.7141075
	speed: 0.0386s/iter; left time: 4832.4491s
	iters: 4100, epoch: 1 | loss: 48.6165810
	speed: 0.0388s/iter; left time: 4854.9772s
	iters: 4200, epoch: 1 | loss: 40.5994606
	speed: 0.0386s/iter; left time: 4828.2669s
	iters: 4300, epoch: 1 | loss: 51.3202629
	speed: 0.0351s/iter; left time: 4379.5977s
Epoch: 1 cost time: 160.89982557296753
test shape: (11521, 96, 7) (11521, 96, 7)
mse:0.191730797290802, mae:0.3169785737991333
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTm2_mask_0.25     Model:              CALF                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.25                

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTm2_mask_0.25_CALF_ETTm2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34465
val 11521
test 11521
	iters: 100, epoch: 1 | loss: 0.6041479
	speed: 0.0691s/iter; left time: 8928.7084s
	iters: 200, epoch: 1 | loss: 1.1813025
	speed: 0.0575s/iter; left time: 7420.1209s
	iters: 300, epoch: 1 | loss: 2.5536141
	speed: 0.0573s/iter; left time: 7391.1436s
	iters: 400, epoch: 1 | loss: 2.3389814
	speed: 0.0613s/iter; left time: 7898.5356s
	iters: 500, epoch: 1 | loss: 5.3087091
	speed: 0.0623s/iter; left time: 8023.0134s
	iters: 600, epoch: 1 | loss: 5.6684699
	speed: 0.0655s/iter; left time: 8420.9221s
	iters: 700, epoch: 1 | loss: 10.1258173
	speed: 0.0593s/iter; left time: 7622.7474s
	iters: 800, epoch: 1 | loss: 12.4512863
	speed: 0.0569s/iter; left time: 7303.3492s
	iters: 900, epoch: 1 | loss: 9.9308224
	speed: 0.0613s/iter; left time: 7867.4834s
	iters: 1000, epoch: 1 | loss: 8.3515358
	speed: 0.0648s/iter; left time: 8304.0431s
	iters: 1100, epoch: 1 | loss: 9.0415983
	speed: 0.0632s/iter; left time: 8102.6624s
	iters: 1200, epoch: 1 | loss: 12.0726719
	speed: 0.0592s/iter; left time: 7581.6318s
	iters: 1300, epoch: 1 | loss: 11.3596630
	speed: 0.0586s/iter; left time: 7492.6562s
	iters: 1400, epoch: 1 | loss: 11.7695484
	speed: 0.0621s/iter; left time: 7944.5920s
	iters: 1500, epoch: 1 | loss: 11.8402462
	speed: 0.0638s/iter; left time: 8155.5416s
	iters: 1600, epoch: 1 | loss: 33.9661865
	speed: 0.0587s/iter; left time: 7486.8732s
	iters: 1700, epoch: 1 | loss: 21.4840775
	speed: 0.0561s/iter; left time: 7161.2654s
Epoch: 1, Steps: 4308 | Train Loss: 30.3939634 Vali Loss: 0.2853891 Test Loss: 0.3101811
Validation loss decreased (inf --> 0.285389).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 1800, epoch: 1 | loss: 23.8600445
	speed: 0.0581s/iter; left time: 7400.6042s
	iters: 100, epoch: 2 | loss: 43.7154694
	speed: 1.7414s/iter; left time: 217384.8182s
	iters: 200, epoch: 2 | loss: 100.5822296
	speed: 0.0360s/iter; left time: 4486.8481s
	iters: 1900, epoch: 1 | loss: 28.6875401
	speed: 0.0514s/iter; left time: 6541.7954s
	iters: 300, epoch: 2 | loss: 135.3919067
	speed: 0.0392s/iter; left time: 4885.4613s
	iters: 2000, epoch: 1 | loss: 22.4542656
	speed: 0.0558s/iter; left time: 7101.6015s
	iters: 400, epoch: 2 | loss: 94.9102707
	speed: 0.0388s/iter; left time: 4836.0854s
	iters: 2100, epoch: 1 | loss: 49.9573517
	speed: 0.0521s/iter; left time: 6618.0679s
	iters: 500, epoch: 2 | loss: 100.8466949
	speed: 0.0421s/iter; left time: 5236.7099s
	iters: 600, epoch: 2 | loss: 128.2356720
	speed: 0.0398s/iter; left time: 4950.6049s
	iters: 2200, epoch: 1 | loss: 43.7765083
	speed: 0.0563s/iter; left time: 7154.9112s
	iters: 700, epoch: 2 | loss: 171.2351685
	speed: 0.0385s/iter; left time: 4780.5404s
	iters: 2300, epoch: 1 | loss: 44.8661690
	speed: 0.0531s/iter; left time: 6742.7068s
	iters: 800, epoch: 2 | loss: 144.0418396
	speed: 0.0415s/iter; left time: 5147.8359s
	iters: 900, epoch: 2 | loss: 153.7418518
	speed: 0.0397s/iter; left time: 4918.0547s
	iters: 2400, epoch: 1 | loss: 51.0487289
	speed: 0.0560s/iter; left time: 7106.6616s
	iters: 1000, epoch: 2 | loss: 95.1196213
	speed: 0.0397s/iter; left time: 4919.4771s
	iters: 2500, epoch: 1 | loss: 64.1848602
	speed: 0.0549s/iter; left time: 6956.5395s
	iters: 1100, epoch: 2 | loss: 153.1409149
	speed: 0.0375s/iter; left time: 4643.9146s
	iters: 2600, epoch: 1 | loss: 32.3585587
	speed: 0.0528s/iter; left time: 6690.6883s
	iters: 1200, epoch: 2 | loss: 112.2725525
	speed: 0.0366s/iter; left time: 4528.8173s
	iters: 1300, epoch: 2 | loss: 135.1348877
	speed: 0.0383s/iter; left time: 4731.7917s
	iters: 2700, epoch: 1 | loss: 37.9820442
	speed: 0.0558s/iter; left time: 7065.1719s
	iters: 1400, epoch: 2 | loss: 110.4676361
	speed: 0.0400s/iter; left time: 4939.9328s
	iters: 2800, epoch: 1 | loss: 35.0364571
	speed: 0.0513s/iter; left time: 6483.5921s
	iters: 1500, epoch: 2 | loss: 178.7972412
	speed: 0.0386s/iter; left time: 4762.6894s
	iters: 1600, epoch: 2 | loss: 228.3571167
	speed: 0.0339s/iter; left time: 4184.2960s
	iters: 2900, epoch: 1 | loss: 38.0379524
	speed: 0.0611s/iter; left time: 7718.8491s
	iters: 1700, epoch: 2 | loss: 154.3581085
	speed: 0.0381s/iter; left time: 4697.3508s
	iters: 3000, epoch: 1 | loss: 29.9843864
	speed: 0.0550s/iter; left time: 6937.1725s
	iters: 1800, epoch: 2 | loss: 138.9777679
	speed: 0.0428s/iter; left time: 5264.1927s
	iters: 1900, epoch: 2 | loss: 102.5183258
	speed: 0.0399s/iter; left time: 4914.0843s
	iters: 3100, epoch: 1 | loss: 29.8493557
	speed: 0.0522s/iter; left time: 6582.3486s
	iters: 2000, epoch: 2 | loss: 114.3142471
	speed: 0.0409s/iter; left time: 5028.7041s
	iters: 3200, epoch: 1 | loss: 44.2090530
	speed: 0.0550s/iter; left time: 6937.8378s
	iters: 2100, epoch: 2 | loss: 105.3287964
	speed: 0.0432s/iter; left time: 5308.8903s
	iters: 3300, epoch: 1 | loss: 46.8412132
	speed: 0.0543s/iter; left time: 6838.2042s
	iters: 2200, epoch: 2 | loss: 106.1095581
	speed: 0.0407s/iter; left time: 4997.5792s
	iters: 2300, epoch: 2 | loss: 83.5564041
	speed: 0.0405s/iter; left time: 4961.1748s
	iters: 3400, epoch: 1 | loss: 51.8438721
	speed: 0.0562s/iter; left time: 7077.9247s
	iters: 2400, epoch: 2 | loss: 148.0968628
	speed: 0.0370s/iter; left time: 4528.4815s
	iters: 3500, epoch: 1 | loss: 57.6596336
	speed: 0.0600s/iter; left time: 7547.6758s
	iters: 2500, epoch: 2 | loss: 155.9142761
	speed: 0.0344s/iter; left time: 4206.9667s
	iters: 2600, epoch: 2 | loss: 131.1496277
	speed: 0.0370s/iter; left time: 4528.3522s
	iters: 3600, epoch: 1 | loss: 51.9632149
	speed: 0.0642s/iter; left time: 8069.8640s
	iters: 2700, epoch: 2 | loss: 140.6711578
	speed: 0.0352s/iter; left time: 4305.7385s
	iters: 2800, epoch: 2 | loss: 94.6416092
	speed: 0.0391s/iter; left time: 4777.2267s
	iters: 3700, epoch: 1 | loss: 41.0599060
	speed: 0.0595s/iter; left time: 7471.1580s
	iters: 2900, epoch: 2 | loss: 110.8373032
	speed: 0.0436s/iter; left time: 5317.1275s
	iters: 3800, epoch: 1 | loss: 46.2690086
	speed: 0.0605s/iter; left time: 7590.5798s
	iters: 3000, epoch: 2 | loss: 128.2910461
	speed: 0.0372s/iter; left time: 4540.7895s
	iters: 3100, epoch: 2 | loss: 142.5095367
	speed: 0.0372s/iter; left time: 4529.4868s
	iters: 3900, epoch: 1 | loss: 49.3148155
	speed: 0.0611s/iter; left time: 7662.6803s
	iters: 3200, epoch: 2 | loss: 159.3051453
	speed: 0.0398s/iter; left time: 4845.2892s
	iters: 4000, epoch: 1 | loss: 66.0154114
	speed: 0.0593s/iter; left time: 7432.3784s
	iters: 3300, epoch: 2 | loss: 168.5985413
	speed: 0.0356s/iter; left time: 4325.2390s
	iters: 3400, epoch: 2 | loss: 148.9450073
	speed: 0.0353s/iter; left time: 4285.6958s
	iters: 4100, epoch: 1 | loss: 47.2757530
	speed: 0.0604s/iter; left time: 7554.7150s
	iters: 3500, epoch: 2 | loss: 154.0008698
	speed: 0.0361s/iter; left time: 4383.9500s
	iters: 3600, epoch: 2 | loss: 102.7172699
	speed: 0.0379s/iter; left time: 4593.0099s
	iters: 4200, epoch: 1 | loss: 52.7460747
	speed: 0.0591s/iter; left time: 7395.7610s
	iters: 3700, epoch: 2 | loss: 152.3765106
	speed: 0.0405s/iter; left time: 4906.4752s
	iters: 4300, epoch: 1 | loss: 44.0189438
	speed: 0.0602s/iter; left time: 7522.0725s
Epoch: 1 cost time: 251.8672811985016
	iters: 3800, epoch: 2 | loss: 146.1093140
	speed: 0.0367s/iter; left time: 4449.8847s
	iters: 3900, epoch: 2 | loss: 150.2110443
	speed: 0.0359s/iter; left time: 4341.7199s
	iters: 4000, epoch: 2 | loss: 159.5054932
	speed: 0.0386s/iter; left time: 4670.5325s
	iters: 4100, epoch: 2 | loss: 157.9289703
	speed: 0.0380s/iter; left time: 4596.1294s
	iters: 4200, epoch: 2 | loss: 122.6225662
	speed: 0.0402s/iter; left time: 4859.3445s
	iters: 4300, epoch: 2 | loss: 127.1130829
	speed: 0.0435s/iter; left time: 5245.5284s
Epoch: 2 cost time: 167.48420977592468
Epoch: 2, Steps: 4308 | Train Loss: 136.2881578 Vali Loss: 0.6553151 Test Loss: 0.5976111
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 155.1304626
	speed: 1.7342s/iter; left time: 209017.4421s
	iters: 200, epoch: 3 | loss: 193.4987488
	speed: 0.0417s/iter; left time: 5020.4745s
	iters: 300, epoch: 3 | loss: 180.8415375
	speed: 0.0429s/iter; left time: 5161.3397s
	iters: 400, epoch: 3 | loss: 214.8010864
	speed: 0.0369s/iter; left time: 4440.3875s
	iters: 500, epoch: 3 | loss: 213.2326508
	speed: 0.0336s/iter; left time: 4030.6892s
	iters: 600, epoch: 3 | loss: 149.4778290
	speed: 0.0332s/iter; left time: 3980.4843s
	iters: 700, epoch: 3 | loss: 211.4155731
	speed: 0.0336s/iter; left time: 4035.4502s
	iters: 800, epoch: 3 | loss: 183.7996521
	speed: 0.0363s/iter; left time: 4351.9608s
	iters: 900, epoch: 3 | loss: 899.0244751
	speed: 0.0423s/iter; left time: 5059.4610s
	iters: 1000, epoch: 3 | loss: 189.7284241
	speed: 0.0402s/iter; left time: 4810.3952s
	iters: 1100, epoch: 3 | loss: 180.1373901
	speed: 0.0386s/iter; left time: 4610.1193s
	iters: 1200, epoch: 3 | loss: 197.5205841
	speed: 0.0426s/iter; left time: 5090.1419s
	iters: 1300, epoch: 3 | loss: 212.1575470
	speed: 0.0399s/iter; left time: 4766.0877s
	iters: 1400, epoch: 3 | loss: 191.1098175
	speed: 0.0379s/iter; left time: 4520.6869s
	iters: 1500, epoch: 3 | loss: 288.3795471
	speed: 0.0398s/iter; left time: 4742.1847s
	iters: 1600, epoch: 3 | loss: 280.2794495
	speed: 0.0366s/iter; left time: 4356.5427s
	iters: 1700, epoch: 3 | loss: 288.0793152
	speed: 0.0344s/iter; left time: 4096.3200s
	iters: 1800, epoch: 3 | loss: 219.9168091
	speed: 0.0384s/iter; left time: 4559.5191s
Epoch: 1, Steps: 4308 | Train Loss: 29.7890738 Vali Loss: 0.1177480 Test Loss: 0.1754881
Validation loss decreased (inf --> 0.117748).  Saving model ...
	iters: 1900, epoch: 3 | loss: 194.9194794
	speed: 0.0425s/iter; left time: 5048.8665s
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 2000, epoch: 3 | loss: 249.3633423
	speed: 0.0423s/iter; left time: 5019.5150s
	iters: 2100, epoch: 3 | loss: 223.4892426
	speed: 0.0368s/iter; left time: 4359.5331s
	iters: 100, epoch: 2 | loss: 53.5413818
	speed: 2.7179s/iter; left time: 339286.5551s
	iters: 2200, epoch: 3 | loss: 224.6473999
	speed: 0.0347s/iter; left time: 4114.3081s
	iters: 200, epoch: 2 | loss: 60.3606682
	speed: 0.0645s/iter; left time: 8046.5460s
	iters: 2300, epoch: 3 | loss: 204.9986420
	speed: 0.0366s/iter; left time: 4328.2207s
	iters: 2400, epoch: 3 | loss: 216.5339813
	speed: 0.0349s/iter; left time: 4124.7365s
	iters: 300, epoch: 2 | loss: 45.4802170
	speed: 0.0681s/iter; left time: 8490.9452s
	iters: 2500, epoch: 3 | loss: 192.9079132
	speed: 0.0355s/iter; left time: 4197.9562s
	iters: 2600, epoch: 3 | loss: 184.3757477
	speed: 0.0413s/iter; left time: 4876.7921s
	iters: 400, epoch: 2 | loss: 56.4454193
	speed: 0.0634s/iter; left time: 7895.7374s
	iters: 2700, epoch: 3 | loss: 225.5444336
	speed: 0.0386s/iter; left time: 4546.0793s
	iters: 500, epoch: 2 | loss: 73.2707443
	speed: 0.0617s/iter; left time: 7680.4254s
	iters: 2800, epoch: 3 | loss: 236.5658722
	speed: 0.0388s/iter; left time: 4566.6623s
	iters: 2900, epoch: 3 | loss: 245.0547485
	speed: 0.0395s/iter; left time: 4653.0350s
	iters: 600, epoch: 2 | loss: 82.4427872
	speed: 0.0628s/iter; left time: 7811.7297s
	iters: 3000, epoch: 3 | loss: 243.3579865
	speed: 0.0374s/iter; left time: 4397.9010s
	iters: 3100, epoch: 3 | loss: 239.0183411
	speed: 0.0351s/iter; left time: 4130.7015s
	iters: 700, epoch: 2 | loss: 110.7357101
	speed: 0.0667s/iter; left time: 8282.8209s
	iters: 3200, epoch: 3 | loss: 248.0089569
	speed: 0.0337s/iter; left time: 3953.5624s
	iters: 3300, epoch: 3 | loss: 268.7771912
	speed: 0.0387s/iter; left time: 4538.4533s
	iters: 800, epoch: 2 | loss: 128.7056274
	speed: 0.0586s/iter; left time: 7269.7724s
	iters: 3400, epoch: 3 | loss: 245.6012726
	speed: 0.0395s/iter; left time: 4631.3957s
	iters: 900, epoch: 2 | loss: 96.5282593
	speed: 0.0579s/iter; left time: 7175.5224s
	iters: 3500, epoch: 3 | loss: 232.8386993
	speed: 0.0376s/iter; left time: 4409.0825s
	iters: 3600, epoch: 3 | loss: 258.4971008
	speed: 0.0385s/iter; left time: 4509.7960s
	iters: 1000, epoch: 2 | loss: 89.8903580
	speed: 0.0593s/iter; left time: 7345.0327s
	iters: 3700, epoch: 3 | loss: 265.4956360
	speed: 0.0351s/iter; left time: 4107.6416s
	iters: 1100, epoch: 2 | loss: 100.7754517
	speed: 0.0593s/iter; left time: 7345.1605s
	iters: 3800, epoch: 3 | loss: 298.1212769
	speed: 0.0350s/iter; left time: 4093.8387s
	iters: 3900, epoch: 3 | loss: 284.4909058
	speed: 0.0358s/iter; left time: 4183.9949s
	iters: 1200, epoch: 2 | loss: 122.5268784
	speed: 0.0617s/iter; left time: 7631.2759s
	iters: 4000, epoch: 3 | loss: 295.5561523
	speed: 0.0380s/iter; left time: 4427.4996s
	iters: 4100, epoch: 3 | loss: 278.7697144
	speed: 0.0337s/iter; left time: 3921.9878s
	iters: 1300, epoch: 2 | loss: 117.3890839
	speed: 0.0552s/iter; left time: 6823.7027s
	iters: 4200, epoch: 3 | loss: 294.7067566
	speed: 0.0329s/iter; left time: 3832.2661s
	iters: 1400, epoch: 2 | loss: 94.4598236
	speed: 0.0610s/iter; left time: 7533.1225s
	iters: 4300, epoch: 3 | loss: 314.7791138
	speed: 0.0356s/iter; left time: 4143.6152s
Epoch: 3 cost time: 163.09545612335205
	iters: 1500, epoch: 2 | loss: 97.8511658
	speed: 0.0640s/iter; left time: 7902.8698s
	iters: 1600, epoch: 2 | loss: 76.4279251
	speed: 0.0635s/iter; left time: 7829.7864s
	iters: 1700, epoch: 2 | loss: 88.9442368
	speed: 0.0593s/iter; left time: 7307.1905s
	iters: 1800, epoch: 2 | loss: 1535.4519043
	speed: 0.0572s/iter; left time: 7039.6760s
	iters: 1900, epoch: 2 | loss: 1822.5434570
	speed: 0.0576s/iter; left time: 7084.5295s
	iters: 2000, epoch: 2 | loss: 1998.2576904
	speed: 0.0645s/iter; left time: 7926.1427s
	iters: 2100, epoch: 2 | loss: 1426.7186279
	speed: 0.0668s/iter; left time: 8206.9767s
	iters: 2200, epoch: 2 | loss: 1423.4152832
	speed: 0.0603s/iter; left time: 7398.9327s
	iters: 2300, epoch: 2 | loss: 1342.6964111
	speed: 0.0620s/iter; left time: 7606.2813s
	iters: 2400, epoch: 2 | loss: 1482.7187500
	speed: 0.0577s/iter; left time: 7075.1719s
	iters: 2500, epoch: 2 | loss: 1446.7159424
	speed: 0.0592s/iter; left time: 7246.8404s
	iters: 2600, epoch: 2 | loss: 1047.8964844
	speed: 0.0553s/iter; left time: 6759.2434s
	iters: 2700, epoch: 2 | loss: 1114.4873047
	speed: 0.0533s/iter; left time: 6520.9898s
	iters: 2800, epoch: 2 | loss: 1112.3300781
	speed: 0.0539s/iter; left time: 6583.6269s
	iters: 2900, epoch: 2 | loss: 1272.7678223
	speed: 0.0526s/iter; left time: 6418.3449s
	iters: 3000, epoch: 2 | loss: 1125.7579346
	speed: 0.0517s/iter; left time: 6301.1247s
	iters: 3100, epoch: 2 | loss: 1297.3878174
	speed: 0.0514s/iter; left time: 6262.8798s
	iters: 3200, epoch: 2 | loss: 1018.6337891
	speed: 0.0522s/iter; left time: 6355.0028s
	iters: 3300, epoch: 2 | loss: 1189.8504639
	speed: 0.0506s/iter; left time: 6152.7595s
	iters: 3400, epoch: 2 | loss: 808.0695801
	speed: 0.0514s/iter; left time: 6252.5923s
	iters: 3500, epoch: 2 | loss: 1061.6188965
	speed: 0.0539s/iter; left time: 6540.1028s
	iters: 3600, epoch: 2 | loss: 1091.0181885
	speed: 0.0514s/iter; left time: 6235.0682s
	iters: 3700, epoch: 2 | loss: 995.6508789
	speed: 0.0511s/iter; left time: 6189.1100s
	iters: 3800, epoch: 2 | loss: 828.6931763
	speed: 0.0542s/iter; left time: 6570.9153s
	iters: 3900, epoch: 2 | loss: 1044.3037109
	speed: 0.0539s/iter; left time: 6522.0845s
	iters: 4000, epoch: 2 | loss: 1078.2259521
	speed: 0.0538s/iter; left time: 6505.1480s
	iters: 4100, epoch: 2 | loss: 1096.6104736
	speed: 0.0540s/iter; left time: 6528.7376s
	iters: 4200, epoch: 2 | loss: 1002.5901489
	speed: 0.0550s/iter; left time: 6635.9915s
	iters: 4300, epoch: 2 | loss: 898.7438965
	speed: 0.0524s/iter; left time: 6319.4067s
Epoch: 2 cost time: 250.39943647384644
Epoch: 3, Steps: 4308 | Train Loss: 253.9953100 Vali Loss: 0.5942680 Test Loss: 0.5873213
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 4 | loss: 378.0208130
	speed: 1.7206s/iter; left time: 199964.0876s
	iters: 200, epoch: 4 | loss: 381.1573181
	speed: 0.0411s/iter; left time: 4777.5119s
	iters: 300, epoch: 4 | loss: 380.7083130
	speed: 0.0440s/iter; left time: 5102.7983s
	iters: 400, epoch: 4 | loss: 339.8339844
	speed: 0.0436s/iter; left time: 5056.0237s
	iters: 500, epoch: 4 | loss: 292.3975830
	speed: 0.0430s/iter; left time: 4977.2208s
	iters: 600, epoch: 4 | loss: 276.2922668
	speed: 0.0440s/iter; left time: 5087.4566s
	iters: 700, epoch: 4 | loss: 300.3782654
	speed: 0.0402s/iter; left time: 4644.5620s
	iters: 800, epoch: 4 | loss: 290.5126038
	speed: 0.0407s/iter; left time: 4698.8744s
	iters: 900, epoch: 4 | loss: 320.7565308
	speed: 0.0394s/iter; left time: 4544.4494s
	iters: 1000, epoch: 4 | loss: 288.4744568
	speed: 0.0393s/iter; left time: 4533.9190s
	iters: 1100, epoch: 4 | loss: 259.0432129
	speed: 0.0341s/iter; left time: 3925.0559s
	iters: 1200, epoch: 4 | loss: 298.6528625
	speed: 0.0369s/iter; left time: 4249.3689s
	iters: 1300, epoch: 4 | loss: 284.1683350
	speed: 0.0401s/iter; left time: 4609.0841s
	iters: 1400, epoch: 4 | loss: 340.6539612
	speed: 0.0357s/iter; left time: 4099.2918s
	iters: 1500, epoch: 4 | loss: 321.3884583
	speed: 0.0378s/iter; left time: 4335.2972s
	iters: 1600, epoch: 4 | loss: 278.2805481
	speed: 0.0356s/iter; left time: 4081.8550s
	iters: 1700, epoch: 4 | loss: 297.5199585
	speed: 0.0359s/iter; left time: 4119.7887s
	iters: 1800, epoch: 4 | loss: 293.9918518
	speed: 0.0376s/iter; left time: 4308.4390s
	iters: 1900, epoch: 4 | loss: 274.0595398
	speed: 0.0390s/iter; left time: 4457.2885s
	iters: 2000, epoch: 4 | loss: 303.1676636
	speed: 0.0407s/iter; left time: 4658.2194s
	iters: 2100, epoch: 4 | loss: 305.5595093
	speed: 0.0383s/iter; left time: 4379.9028s
	iters: 2200, epoch: 4 | loss: 332.0527344
	speed: 0.0366s/iter; left time: 4180.2808s
	iters: 2300, epoch: 4 | loss: 298.6474304
	speed: 0.0370s/iter; left time: 4216.0221s
	iters: 2400, epoch: 4 | loss: 359.0532837
	speed: 0.0392s/iter; left time: 4466.1535s
	iters: 2500, epoch: 4 | loss: 316.7121277
	speed: 0.0368s/iter; left time: 4189.3327s
	iters: 2600, epoch: 4 | loss: 353.6488342
	speed: 0.0347s/iter; left time: 3941.1868s
	iters: 2700, epoch: 4 | loss: 317.7599182
	speed: 0.0348s/iter; left time: 3952.5738s
	iters: 2800, epoch: 4 | loss: 340.8930664
	speed: 0.0354s/iter; left time: 4013.7056s
	iters: 2900, epoch: 4 | loss: 362.9736328
	speed: 0.0353s/iter; left time: 4004.0576s
	iters: 3000, epoch: 4 | loss: 305.9067383
	speed: 0.0351s/iter; left time: 3978.0983s
	iters: 3100, epoch: 4 | loss: 270.8536072
	speed: 0.0327s/iter; left time: 3707.6865s
	iters: 3200, epoch: 4 | loss: 325.9155273
	speed: 0.0332s/iter; left time: 3757.1505s
	iters: 3300, epoch: 4 | loss: 339.1293640
	speed: 0.0368s/iter; left time: 4156.1498s
	iters: 3400, epoch: 4 | loss: 300.0715637
	speed: 0.0358s/iter; left time: 4043.7310s
	iters: 3500, epoch: 4 | loss: 344.1559143
	speed: 0.0399s/iter; left time: 4504.9106s
	iters: 3600, epoch: 4 | loss: 406.0468445
	speed: 0.0389s/iter; left time: 4380.0318s
	iters: 3700, epoch: 4 | loss: 380.9370728
	speed: 0.0405s/iter; left time: 4560.2847s
	iters: 3800, epoch: 4 | loss: 432.7943420
	speed: 0.0381s/iter; left time: 4281.7942s
	iters: 3900, epoch: 4 | loss: 835.1386719
	speed: 0.0371s/iter; left time: 4165.5317s
	iters: 4000, epoch: 4 | loss: 675.0878296
	speed: 0.0370s/iter; left time: 4158.7612s
	iters: 4100, epoch: 4 | loss: 487.5901794
	speed: 0.0432s/iter; left time: 4849.0856s
	iters: 4200, epoch: 4 | loss: 381.3242798
	speed: 0.0433s/iter; left time: 4851.1956s
	iters: 4300, epoch: 4 | loss: 1919.0050049
	speed: 0.0420s/iter; left time: 4704.7563s
Epoch: 4 cost time: 166.16054773330688
Epoch: 2, Steps: 4308 | Train Loss: 781.7102992 Vali Loss: 0.2141116 Test Loss: 0.3714575
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1090.6672363
	speed: 2.6299s/iter; left time: 316973.0739s
	iters: 200, epoch: 3 | loss: 1332.1591797
	speed: 0.0559s/iter; left time: 6733.3133s
	iters: 300, epoch: 3 | loss: 1296.0111084
	speed: 0.0640s/iter; left time: 7695.1541s
	iters: 400, epoch: 3 | loss: 997.7504883
	speed: 0.0615s/iter; left time: 7397.5066s
	iters: 500, epoch: 3 | loss: 1369.7584229
	speed: 0.0588s/iter; left time: 7065.0611s
	iters: 600, epoch: 3 | loss: 926.5298462
	speed: 0.0555s/iter; left time: 6658.2717s
	iters: 700, epoch: 3 | loss: 1078.0432129
	speed: 0.0566s/iter; left time: 6785.1769s
	iters: 800, epoch: 3 | loss: 916.7980347
	speed: 0.0537s/iter; left time: 6430.1160s
	iters: 900, epoch: 3 | loss: 1286.6575928
	speed: 0.0509s/iter; left time: 6099.6043s
	iters: 1000, epoch: 3 | loss: 1290.7913818
	speed: 0.0572s/iter; left time: 6841.4018s
	iters: 1100, epoch: 3 | loss: 1179.0897217
	speed: 0.0584s/iter; left time: 6976.4393s
	iters: 1200, epoch: 3 | loss: 915.7348633
	speed: 0.0572s/iter; left time: 6832.0647s
	iters: 1300, epoch: 3 | loss: 1275.9417725
	speed: 0.0576s/iter; left time: 6872.3194s
Epoch: 4, Steps: 4308 | Train Loss: 375.4187888 Vali Loss: 0.5576200 Test Loss: 0.5636079
EarlyStopping counter: 3 out of 3
Early stopping
	iters: 1400, epoch: 3 | loss: 954.0432129
	speed: 0.0546s/iter; left time: 6515.5017s
>>>>>>>testing : imputation_ETTm1_mask_0.5_CALF_ETTm1_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt3_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11521
	iters: 1500, epoch: 3 | loss: 1284.3923340
	speed: 0.0531s/iter; left time: 6326.8260s
	iters: 1600, epoch: 3 | loss: 1380.0059814
	speed: 0.0539s/iter; left time: 6417.2502s
	iters: 1700, epoch: 3 | loss: 1547.4735107
	speed: 0.0524s/iter; left time: 6227.3029s
	iters: 1800, epoch: 3 | loss: 1634.8398438
	speed: 0.0516s/iter; left time: 6136.8336s
	iters: 1900, epoch: 3 | loss: 1703.1328125
	speed: 0.0524s/iter; left time: 6219.7872s
	iters: 2000, epoch: 3 | loss: 1452.5950928
	speed: 0.0551s/iter; left time: 6539.4905s
	iters: 2100, epoch: 3 | loss: 1766.1721191
	speed: 0.0574s/iter; left time: 6802.7614s
	iters: 2200, epoch: 3 | loss: 2384.5363770
	speed: 0.0559s/iter; left time: 6624.0808s
	iters: 2300, epoch: 3 | loss: 1734.7722168
	speed: 0.0622s/iter; left time: 7365.1119s
	iters: 2400, epoch: 3 | loss: 2293.1589355
	speed: 0.0615s/iter; left time: 7268.7053s
	iters: 2500, epoch: 3 | loss: 1304.2177734
	speed: 0.0624s/iter; left time: 7375.3081s
	iters: 2600, epoch: 3 | loss: 1433.4691162
	speed: 0.0630s/iter; left time: 7433.7121s
	iters: 2700, epoch: 3 | loss: 2000.3262939
	speed: 0.0597s/iter; left time: 7042.0895s
	iters: 2800, epoch: 3 | loss: 1962.5301514
	speed: 0.0688s/iter; left time: 8107.2504s
	iters: 2900, epoch: 3 | loss: 1626.2176514
	speed: 0.0623s/iter; left time: 7332.1285s
	iters: 3000, epoch: 3 | loss: 1820.5032959
	speed: 0.0617s/iter; left time: 7255.3568s
	iters: 3100, epoch: 3 | loss: 1142.4274902
	speed: 0.0598s/iter; left time: 7022.7390s
	iters: 3200, epoch: 3 | loss: 1631.6361084
	speed: 0.0588s/iter; left time: 6908.5701s
	iters: 3300, epoch: 3 | loss: 1854.6728516
	speed: 0.0643s/iter; left time: 7541.2915s
	iters: 3400, epoch: 3 | loss: 1254.7103271
	speed: 0.0665s/iter; left time: 7800.7522s
	iters: 3500, epoch: 3 | loss: 1871.6312256
	speed: 0.0691s/iter; left time: 8094.0042s
	iters: 3600, epoch: 3 | loss: 1445.8104248
	speed: 0.0613s/iter; left time: 7168.6532s
	iters: 3700, epoch: 3 | loss: 1815.8460693
	speed: 0.0552s/iter; left time: 6454.3860s
test shape: (11521, 96, 7) (11521, 96, 7)
mse:0.30321985483169556, mae:0.36892983317375183
	iters: 3800, epoch: 3 | loss: 1207.0632324
	speed: 0.0634s/iter; left time: 7412.1093s
	iters: 3900, epoch: 3 | loss: 1651.0710449
	speed: 0.0528s/iter; left time: 6161.7216s
	iters: 4000, epoch: 3 | loss: 1881.1989746
	speed: 0.0549s/iter; left time: 6403.3323s
	iters: 4100, epoch: 3 | loss: 2302.0661621
	speed: 0.0510s/iter; left time: 5937.4783s
	iters: 4200, epoch: 3 | loss: 2620.9577637
	speed: 0.0517s/iter; left time: 6022.3028s
	iters: 4300, epoch: 3 | loss: 2601.1862793
	speed: 0.0521s/iter; left time: 6054.7220s
Epoch: 3 cost time: 250.70544981956482
Epoch: 3, Steps: 4308 | Train Loss: 1474.9700973 Vali Loss: 0.2130600 Test Loss: 0.3682201
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 4 | loss: 2177.4367676
	speed: 2.6161s/iter; left time: 304034.8464s
	iters: 200, epoch: 4 | loss: 2229.3149414
	speed: 0.0579s/iter; left time: 6726.5587s
	iters: 300, epoch: 4 | loss: 1647.9426270
	speed: 0.0587s/iter; left time: 6815.6524s
	iters: 400, epoch: 4 | loss: 1916.1647949
	speed: 0.0604s/iter; left time: 6999.7261s
	iters: 500, epoch: 4 | loss: 1617.6583252
	speed: 0.0592s/iter; left time: 6856.6943s
	iters: 600, epoch: 4 | loss: 1722.2497559
	speed: 0.0579s/iter; left time: 6698.4999s
	iters: 700, epoch: 4 | loss: 2181.1254883
	speed: 0.0577s/iter; left time: 6674.7227s
	iters: 800, epoch: 4 | loss: 1830.9685059
	speed: 0.0559s/iter; left time: 6460.8886s
	iters: 900, epoch: 4 | loss: 1794.6868896
	speed: 0.0583s/iter; left time: 6727.8950s
	iters: 1000, epoch: 4 | loss: 2090.4572754
	speed: 0.0530s/iter; left time: 6110.0776s
	iters: 1100, epoch: 4 | loss: 2099.3286133
	speed: 0.0512s/iter; left time: 5899.5487s
	iters: 1200, epoch: 4 | loss: 1529.9676514
	speed: 0.0497s/iter; left time: 5719.3482s
	iters: 1300, epoch: 4 | loss: 2355.5698242
	speed: 0.0549s/iter; left time: 6316.2563s
	iters: 1400, epoch: 4 | loss: 1726.2636719
	speed: 0.0563s/iter; left time: 6465.3325s
	iters: 1500, epoch: 4 | loss: 1950.7926025
	speed: 0.0632s/iter; left time: 7254.8165s
	iters: 1600, epoch: 4 | loss: 1512.3310547
	speed: 0.0571s/iter; left time: 6554.6717s
	iters: 1700, epoch: 4 | loss: 1790.3983154
	speed: 0.0604s/iter; left time: 6927.8968s
	iters: 1800, epoch: 4 | loss: 1334.3907471
	speed: 0.0594s/iter; left time: 6797.3921s
	iters: 1900, epoch: 4 | loss: 1502.8764648
	speed: 0.0562s/iter; left time: 6424.8697s
	iters: 2000, epoch: 4 | loss: 1773.3966064
	speed: 0.0544s/iter; left time: 6224.2253s
	iters: 2100, epoch: 4 | loss: 1775.4135742
	speed: 0.0544s/iter; left time: 6218.0699s
	iters: 2200, epoch: 4 | loss: 1615.8139648
	speed: 0.0594s/iter; left time: 6783.8714s
	iters: 2300, epoch: 4 | loss: 1928.9282227
	speed: 0.0565s/iter; left time: 6441.3490s
	iters: 2400, epoch: 4 | loss: 1885.8714600
	speed: 0.0554s/iter; left time: 6306.0505s
	iters: 2500, epoch: 4 | loss: 2105.5737305
	speed: 0.0517s/iter; left time: 5886.6385s
	iters: 2600, epoch: 4 | loss: 2676.2736816
	speed: 0.0533s/iter; left time: 6063.5483s
	iters: 2700, epoch: 4 | loss: 2016.7446289
	speed: 0.0505s/iter; left time: 5738.3105s
	iters: 2800, epoch: 4 | loss: 3051.6442871
	speed: 0.0553s/iter; left time: 6278.9012s
	iters: 2900, epoch: 4 | loss: 2449.4899902
	speed: 0.0516s/iter; left time: 5852.0296s
	iters: 3000, epoch: 4 | loss: 2973.3439941
	speed: 0.0519s/iter; left time: 5882.1801s
	iters: 3100, epoch: 4 | loss: 2701.1787109
	speed: 0.0495s/iter; left time: 5605.1102s
	iters: 3200, epoch: 4 | loss: 2490.1364746
	speed: 0.0507s/iter; left time: 5733.7707s
	iters: 3300, epoch: 4 | loss: 2267.3125000
	speed: 0.0519s/iter; left time: 5864.2324s
	iters: 3400, epoch: 4 | loss: 2686.1247559
	speed: 0.0494s/iter; left time: 5582.1572s
	iters: 3500, epoch: 4 | loss: 2541.4465332
	speed: 0.0487s/iter; left time: 5495.6346s
	iters: 3600, epoch: 4 | loss: 2623.9030762
	speed: 0.0532s/iter; left time: 5996.5059s
	iters: 3700, epoch: 4 | loss: 2841.9514160
	speed: 0.0519s/iter; left time: 5845.3478s
	iters: 3800, epoch: 4 | loss: 2785.7402344
	speed: 0.0505s/iter; left time: 5684.5121s
	iters: 3900, epoch: 4 | loss: 2824.2651367
	speed: 0.0569s/iter; left time: 6394.5110s
	iters: 4000, epoch: 4 | loss: 2838.2392578
	speed: 0.0539s/iter; left time: 6052.4824s
	iters: 4100, epoch: 4 | loss: 2896.4003906
	speed: 0.0508s/iter; left time: 5699.9156s
	iters: 4200, epoch: 4 | loss: 2668.8242188
	speed: 0.0515s/iter; left time: 5777.9222s
	iters: 4300, epoch: 4 | loss: 2900.8798828
	speed: 0.0528s/iter; left time: 5914.6749s
Epoch: 4 cost time: 236.912358045578
Epoch: 4, Steps: 4308 | Train Loss: 2194.7792256 Vali Loss: 0.1786924 Test Loss: 0.2987427
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTm2_mask_0.25_CALF_ETTm2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11521
test shape: (11521, 96, 7) (11521, 96, 7)
mse:0.1688256710767746, mae:0.28534597158432007
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTm2_mask_0.375    Model:              CALF                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.375               

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTm2_mask_0.375_CALF_ETTm2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34465
val 11521
test 11521
	iters: 100, epoch: 1 | loss: 1.0000458
	speed: 0.0673s/iter; left time: 8694.8508s
	iters: 200, epoch: 1 | loss: 1.7977958
	speed: 0.0503s/iter; left time: 6496.5521s
	iters: 300, epoch: 1 | loss: 2.8545189
	speed: 0.0522s/iter; left time: 6726.1096s
	iters: 400, epoch: 1 | loss: 2.9646428
	speed: 0.0528s/iter; left time: 6803.6901s
	iters: 500, epoch: 1 | loss: 4.8460436
	speed: 0.0533s/iter; left time: 6867.0070s
	iters: 600, epoch: 1 | loss: 5.4194078
	speed: 0.0508s/iter; left time: 6534.6833s
	iters: 700, epoch: 1 | loss: 11.5499048
	speed: 0.0512s/iter; left time: 6577.6803s
	iters: 800, epoch: 1 | loss: 5.3226471
	speed: 0.0515s/iter; left time: 6618.7122s
	iters: 900, epoch: 1 | loss: 7.4430552
	speed: 0.0572s/iter; left time: 7337.0004s
	iters: 1000, epoch: 1 | loss: 14.0259018
	speed: 0.0570s/iter; left time: 7314.4380s
	iters: 1100, epoch: 1 | loss: 8.7643127
	speed: 0.0585s/iter; left time: 7495.2044s
	iters: 1200, epoch: 1 | loss: 17.2502670
	speed: 0.0568s/iter; left time: 7278.0025s
	iters: 1300, epoch: 1 | loss: 9.1929293
	speed: 0.0616s/iter; left time: 7877.2844s
	iters: 1400, epoch: 1 | loss: 11.1078081
	speed: 0.0613s/iter; left time: 7833.1535s
	iters: 1500, epoch: 1 | loss: 12.2785101
	speed: 0.0523s/iter; left time: 6677.0681s
	iters: 1600, epoch: 1 | loss: 23.4954872
	speed: 0.0508s/iter; left time: 6489.5486s
	iters: 1700, epoch: 1 | loss: 32.1073418
	speed: 0.0513s/iter; left time: 6546.5195s
	iters: 1800, epoch: 1 | loss: 30.5529957
	speed: 0.0528s/iter; left time: 6723.7261s
	iters: 1900, epoch: 1 | loss: 34.1611404
	speed: 0.0573s/iter; left time: 7295.1274s
	iters: 2000, epoch: 1 | loss: 28.7641106
	speed: 0.0598s/iter; left time: 7609.0698s
	iters: 2100, epoch: 1 | loss: 27.3433247
	speed: 0.0570s/iter; left time: 7245.7764s
	iters: 2200, epoch: 1 | loss: 30.5400486
	speed: 0.0553s/iter; left time: 7023.3682s
	iters: 2300, epoch: 1 | loss: 30.6284790
	speed: 0.0510s/iter; left time: 6471.0497s
	iters: 2400, epoch: 1 | loss: 41.0342560
	speed: 0.0561s/iter; left time: 7118.1826s
	iters: 2500, epoch: 1 | loss: 38.7471237
	speed: 0.0579s/iter; left time: 7340.4375s
	iters: 2600, epoch: 1 | loss: 49.9436302
	speed: 0.0565s/iter; left time: 7153.4110s
	iters: 2700, epoch: 1 | loss: 36.7520943
	speed: 0.0526s/iter; left time: 6654.0569s
	iters: 2800, epoch: 1 | loss: 41.3465004
	speed: 0.0492s/iter; left time: 6223.4618s
	iters: 2900, epoch: 1 | loss: 37.7289238
	speed: 0.0503s/iter; left time: 6353.4754s
	iters: 3000, epoch: 1 | loss: 34.7933159
	speed: 0.0570s/iter; left time: 7191.2557s
	iters: 3100, epoch: 1 | loss: 40.1745567
	speed: 0.0557s/iter; left time: 7021.5698s
	iters: 3200, epoch: 1 | loss: 29.4510040
	speed: 0.0545s/iter; left time: 6871.0334s
	iters: 3300, epoch: 1 | loss: 27.6197834
	speed: 0.0574s/iter; left time: 7234.7356s
	iters: 3400, epoch: 1 | loss: 41.0628471
	speed: 0.0525s/iter; left time: 6605.7806s
	iters: 3500, epoch: 1 | loss: 31.1343403
	speed: 0.0585s/iter; left time: 7357.4355s
	iters: 3600, epoch: 1 | loss: 31.2856750
	speed: 0.0574s/iter; left time: 7217.7374s
	iters: 3700, epoch: 1 | loss: 25.6437683
	speed: 0.0589s/iter; left time: 7390.0953s
	iters: 3800, epoch: 1 | loss: 29.6887875
	speed: 0.0591s/iter; left time: 7409.4240s
	iters: 3900, epoch: 1 | loss: 51.8675804
	speed: 0.0570s/iter; left time: 7142.7462s
	iters: 4000, epoch: 1 | loss: 56.9413643
	speed: 0.0582s/iter; left time: 7290.0181s
	iters: 4100, epoch: 1 | loss: 42.5536766
	speed: 0.0576s/iter; left time: 7206.6402s
	iters: 4200, epoch: 1 | loss: 81.7003708
	speed: 0.0611s/iter; left time: 7643.7723s
	iters: 4300, epoch: 1 | loss: 71.6735764
	speed: 0.0658s/iter; left time: 8221.2240s
Epoch: 1 cost time: 240.92721486091614
Epoch: 1, Steps: 4308 | Train Loss: 28.8293875 Vali Loss: 0.1192751 Test Loss: 0.1749021
Validation loss decreased (inf --> 0.119275).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 2659.4716797
	speed: 2.6302s/iter; left time: 328341.6814s
	iters: 200, epoch: 2 | loss: 587.2390747
	speed: 0.0534s/iter; left time: 6661.2854s
	iters: 300, epoch: 2 | loss: 211.1376648
	speed: 0.0566s/iter; left time: 7049.6762s
	iters: 400, epoch: 2 | loss: 174.9557037
	speed: 0.0577s/iter; left time: 7183.7257s
	iters: 500, epoch: 2 | loss: 345.4298401
	speed: 0.0607s/iter; left time: 7550.8663s
	iters: 600, epoch: 2 | loss: 380.2425537
	speed: 0.0571s/iter; left time: 7093.4062s
	iters: 700, epoch: 2 | loss: 320.2998657
	speed: 0.0582s/iter; left time: 7232.9143s
	iters: 800, epoch: 2 | loss: 243.1020203
	speed: 0.0523s/iter; left time: 6494.3910s
	iters: 900, epoch: 2 | loss: 166.4220734
	speed: 0.0577s/iter; left time: 7156.8907s
	iters: 1000, epoch: 2 | loss: 375.3963013
	speed: 0.0608s/iter; left time: 7536.2562s
	iters: 1100, epoch: 2 | loss: 236.0130005
	speed: 0.0589s/iter; left time: 7292.1890s
	iters: 1200, epoch: 2 | loss: 381.3507996
	speed: 0.0587s/iter; left time: 7260.9012s
	iters: 1300, epoch: 2 | loss: 364.1433411
	speed: 0.0515s/iter; left time: 6370.2692s
	iters: 1400, epoch: 2 | loss: 296.9724121
	speed: 0.0520s/iter; left time: 6420.9139s
	iters: 1500, epoch: 2 | loss: 254.8140259
	speed: 0.0514s/iter; left time: 6340.2251s
	iters: 1600, epoch: 2 | loss: 259.8164978
	speed: 0.0521s/iter; left time: 6419.5343s
	iters: 1700, epoch: 2 | loss: 309.9390564
	speed: 0.0555s/iter; left time: 6837.2981s
	iters: 1800, epoch: 2 | loss: 398.0415955
	speed: 0.0506s/iter; left time: 6224.4002s
	iters: 1900, epoch: 2 | loss: 307.4825134
	speed: 0.0506s/iter; left time: 6228.0827s
	iters: 2000, epoch: 2 | loss: 440.2009888
	speed: 0.0558s/iter; left time: 6862.9091s
	iters: 2100, epoch: 2 | loss: 321.3496704
	speed: 0.0548s/iter; left time: 6728.5664s
	iters: 2200, epoch: 2 | loss: 427.1375427
	speed: 0.0610s/iter; left time: 7484.8164s
	iters: 2300, epoch: 2 | loss: 618.2216797
	speed: 0.0563s/iter; left time: 6905.6511s
	iters: 2400, epoch: 2 | loss: 904.4966431
	speed: 0.0543s/iter; left time: 6651.1943s
	iters: 2500, epoch: 2 | loss: 699.6726074
	speed: 0.0503s/iter; left time: 6155.6666s
	iters: 2600, epoch: 2 | loss: 376.3782043
	speed: 0.0482s/iter; left time: 5895.3314s
	iters: 2700, epoch: 2 | loss: 609.6155396
	speed: 0.0485s/iter; left time: 5930.5062s
	iters: 2800, epoch: 2 | loss: 497.1736755
	speed: 0.0485s/iter; left time: 5927.1927s
	iters: 2900, epoch: 2 | loss: 669.8986816
	speed: 0.0516s/iter; left time: 6294.4927s
	iters: 3000, epoch: 2 | loss: 692.0938721
	speed: 0.0549s/iter; left time: 6690.0407s
	iters: 3100, epoch: 2 | loss: 618.1419678
	speed: 0.0595s/iter; left time: 7249.9129s
	iters: 3200, epoch: 2 | loss: 619.4790649
	speed: 0.0575s/iter; left time: 7004.8247s
	iters: 3300, epoch: 2 | loss: 734.5165405
	speed: 0.0563s/iter; left time: 6853.6347s
	iters: 3400, epoch: 2 | loss: 772.4335938
	speed: 0.0503s/iter; left time: 6115.6105s
	iters: 3500, epoch: 2 | loss: 875.6873779
	speed: 0.0563s/iter; left time: 6837.4945s
	iters: 3600, epoch: 2 | loss: 503.6394043
	speed: 0.0568s/iter; left time: 6897.3850s
	iters: 3700, epoch: 2 | loss: 685.7951660
	speed: 0.0559s/iter; left time: 6774.8883s
	iters: 3800, epoch: 2 | loss: 576.2531738
	speed: 0.0505s/iter; left time: 6120.1995s
	iters: 3900, epoch: 2 | loss: 474.8038940
	speed: 0.0500s/iter; left time: 6050.4201s
	iters: 4000, epoch: 2 | loss: 704.4990234
	speed: 0.0506s/iter; left time: 6114.7735s
	iters: 4100, epoch: 2 | loss: 466.6574402
	speed: 0.0493s/iter; left time: 5960.2645s
	iters: 4200, epoch: 2 | loss: 749.1285400
	speed: 0.0493s/iter; left time: 5947.7951s
	iters: 4300, epoch: 2 | loss: 668.0569458
	speed: 0.0487s/iter; left time: 5870.4786s
Epoch: 2 cost time: 234.29388451576233
Epoch: 2, Steps: 4308 | Train Loss: 579.0885737 Vali Loss: 0.2190138 Test Loss: 0.3521160
EarlyStopping counter: 1 out of 3
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1031.5286865
	speed: 2.5866s/iter; left time: 311746.0766s
	iters: 200, epoch: 3 | loss: 836.3247681
	speed: 0.0530s/iter; left time: 6384.7489s
	iters: 300, epoch: 3 | loss: 502.3332214
	speed: 0.0558s/iter; left time: 6709.0841s
	iters: 400, epoch: 3 | loss: 408.3631897
	speed: 0.0559s/iter; left time: 6720.0210s
	iters: 500, epoch: 3 | loss: 538.5489502
	speed: 0.0560s/iter; left time: 6722.8087s
	iters: 600, epoch: 3 | loss: 629.7648926
	speed: 0.0515s/iter; left time: 6185.8047s
	iters: 700, epoch: 3 | loss: 497.4505005
	speed: 0.0491s/iter; left time: 5892.7706s
	iters: 800, epoch: 3 | loss: 505.2158203
	speed: 0.0494s/iter; left time: 5923.7300s
	iters: 900, epoch: 3 | loss: 695.4733887
	speed: 0.0488s/iter; left time: 5844.2197s
	iters: 1000, epoch: 3 | loss: 628.7075195
	speed: 0.0496s/iter; left time: 5930.8317s
	iters: 1100, epoch: 3 | loss: 688.1305542
	speed: 0.0504s/iter; left time: 6024.1346s
	iters: 1200, epoch: 3 | loss: 611.8179932
	speed: 0.0479s/iter; left time: 5723.1581s
	iters: 1300, epoch: 3 | loss: 768.5568237
	speed: 0.0497s/iter; left time: 5925.4438s
	iters: 1400, epoch: 3 | loss: 583.3845825
	speed: 0.0533s/iter; left time: 6349.2128s
	iters: 1500, epoch: 3 | loss: 828.5137939
	speed: 0.0502s/iter; left time: 5978.1951s
	iters: 1600, epoch: 3 | loss: 875.6184692
	speed: 0.0483s/iter; left time: 5746.5586s
	iters: 1700, epoch: 3 | loss: 581.9332275
	speed: 0.0482s/iter; left time: 5737.8240s
	iters: 1800, epoch: 3 | loss: 540.0861816
	speed: 0.0497s/iter; left time: 5903.3993s
	iters: 1900, epoch: 3 | loss: 689.1932983
	speed: 0.0557s/iter; left time: 6618.1245s
	iters: 2000, epoch: 3 | loss: 803.4000854
	speed: 0.0505s/iter; left time: 5984.9006s
	iters: 2100, epoch: 3 | loss: 818.2196045
	speed: 0.0518s/iter; left time: 6135.0031s
	iters: 2200, epoch: 3 | loss: 788.4568481
	speed: 0.0501s/iter; left time: 5932.5656s
	iters: 2300, epoch: 3 | loss: 1049.2451172
	speed: 0.0501s/iter; left time: 5933.6431s
	iters: 2400, epoch: 3 | loss: 744.8589478
	speed: 0.0501s/iter; left time: 5919.8628s
	iters: 2500, epoch: 3 | loss: 799.3710327
	speed: 0.0532s/iter; left time: 6287.1319s
	iters: 2600, epoch: 3 | loss: 728.4613647
	speed: 0.0484s/iter; left time: 5712.4991s
	iters: 2700, epoch: 3 | loss: 856.0075073
	speed: 0.0522s/iter; left time: 6154.0791s
	iters: 2800, epoch: 3 | loss: 965.6842651
	speed: 0.0520s/iter; left time: 6121.6171s
	iters: 2900, epoch: 3 | loss: 721.2136230
	speed: 0.0497s/iter; left time: 5851.9135s
	iters: 3000, epoch: 3 | loss: 1037.3519287
	speed: 0.0484s/iter; left time: 5691.7683s
	iters: 3100, epoch: 3 | loss: 643.0686646
	speed: 0.0512s/iter; left time: 6015.9559s
	iters: 3200, epoch: 3 | loss: 868.5778809
	speed: 0.0502s/iter; left time: 5890.6814s
	iters: 3300, epoch: 3 | loss: 753.5207520
	speed: 0.0529s/iter; left time: 6212.1040s
	iters: 3400, epoch: 3 | loss: 760.8056641
	speed: 0.0503s/iter; left time: 5897.7023s
	iters: 3500, epoch: 3 | loss: 688.4700928
	speed: 0.0545s/iter; left time: 6379.3905s
	iters: 3600, epoch: 3 | loss: 832.1375122
	speed: 0.0608s/iter; left time: 7118.0690s
	iters: 3700, epoch: 3 | loss: 760.0764160
	speed: 0.0534s/iter; left time: 6242.0679s
	iters: 3800, epoch: 3 | loss: 589.0595703
	speed: 0.0539s/iter; left time: 6301.9723s
	iters: 3900, epoch: 3 | loss: 740.1456909
	speed: 0.0579s/iter; left time: 6760.3600s
	iters: 4000, epoch: 3 | loss: 757.1035767
	speed: 0.0597s/iter; left time: 6961.9781s
	iters: 4100, epoch: 3 | loss: 731.8590088
	speed: 0.0590s/iter; left time: 6871.9000s
	iters: 4200, epoch: 3 | loss: 766.6456909
	speed: 0.0581s/iter; left time: 6759.6127s
	iters: 4300, epoch: 3 | loss: 861.6796875
	speed: 0.0516s/iter; left time: 6003.3039s
Epoch: 3 cost time: 226.3512098789215
Epoch: 3, Steps: 4308 | Train Loss: 743.3384074 Vali Loss: 0.2026845 Test Loss: 0.3386318
EarlyStopping counter: 2 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 4 | loss: 860.7052612
	speed: 2.6399s/iter; left time: 306804.0749s
	iters: 200, epoch: 4 | loss: 650.1412354
	speed: 0.0569s/iter; left time: 6601.8826s
	iters: 300, epoch: 4 | loss: 977.9876709
	speed: 0.0564s/iter; left time: 6542.9199s
	iters: 400, epoch: 4 | loss: 773.0604858
	speed: 0.0588s/iter; left time: 6816.9232s
	iters: 500, epoch: 4 | loss: 878.0803833
	speed: 0.0605s/iter; left time: 7009.0265s
	iters: 600, epoch: 4 | loss: 849.2445068
	speed: 0.0573s/iter; left time: 6633.1143s
	iters: 700, epoch: 4 | loss: 838.1817017
	speed: 0.0571s/iter; left time: 6606.6454s
	iters: 800, epoch: 4 | loss: 925.3103027
	speed: 0.0561s/iter; left time: 6485.4484s
	iters: 900, epoch: 4 | loss: 648.6364746
	speed: 0.0586s/iter; left time: 6766.8361s
	iters: 1000, epoch: 4 | loss: 998.8184204
	speed: 0.0516s/iter; left time: 5955.8849s
	iters: 1100, epoch: 4 | loss: 907.4960938
	speed: 0.0501s/iter; left time: 5772.3374s
	iters: 1200, epoch: 4 | loss: 946.5333862
	speed: 0.0501s/iter; left time: 5768.2509s
	iters: 1300, epoch: 4 | loss: 904.6917114
	speed: 0.0498s/iter; left time: 5730.3980s
	iters: 1400, epoch: 4 | loss: 1033.9624023
	speed: 0.0522s/iter; left time: 6002.0210s
	iters: 1500, epoch: 4 | loss: 892.6731567
	speed: 0.0540s/iter; left time: 6196.5887s
	iters: 1600, epoch: 4 | loss: 997.6828613
	speed: 0.0514s/iter; left time: 5895.4622s
	iters: 1700, epoch: 4 | loss: 734.2152100
	speed: 0.0488s/iter; left time: 5594.4512s
	iters: 1800, epoch: 4 | loss: 865.3102417
	speed: 0.0486s/iter; left time: 5563.9532s
	iters: 1900, epoch: 4 | loss: 827.7543945
	speed: 0.0498s/iter; left time: 5696.6733s
	iters: 2000, epoch: 4 | loss: 814.8731689
	speed: 0.0495s/iter; left time: 5656.9216s
	iters: 2100, epoch: 4 | loss: 905.8000488
	speed: 0.0544s/iter; left time: 6207.9245s
	iters: 2200, epoch: 4 | loss: 741.4535522
	speed: 0.0582s/iter; left time: 6639.9401s
	iters: 2300, epoch: 4 | loss: 881.0176392
	speed: 0.0508s/iter; left time: 5790.1098s
	iters: 2400, epoch: 4 | loss: 969.7734375
	speed: 0.0509s/iter; left time: 5801.8843s
	iters: 2500, epoch: 4 | loss: 1064.9450684
	speed: 0.0500s/iter; left time: 5693.3460s
	iters: 2600, epoch: 4 | loss: 823.6854858
	speed: 0.0498s/iter; left time: 5660.0996s
	iters: 2700, epoch: 4 | loss: 1018.2501221
	speed: 0.0503s/iter; left time: 5712.0550s
	iters: 2800, epoch: 4 | loss: 1223.7819824
	speed: 0.0520s/iter; left time: 5899.0736s
	iters: 2900, epoch: 4 | loss: 1691.7985840
	speed: 0.0523s/iter; left time: 5927.1674s
	iters: 3000, epoch: 4 | loss: 1290.6129150
	speed: 0.0507s/iter; left time: 5742.8597s
	iters: 3100, epoch: 4 | loss: 1675.0740967
	speed: 0.0496s/iter; left time: 5618.3357s
	iters: 3200, epoch: 4 | loss: 1504.3035889
	speed: 0.0486s/iter; left time: 5497.7040s
	iters: 3300, epoch: 4 | loss: 1769.9858398
	speed: 0.0540s/iter; left time: 6103.8558s
	iters: 3400, epoch: 4 | loss: 1628.1423340
	speed: 0.0510s/iter; left time: 5761.9800s
	iters: 3500, epoch: 4 | loss: 1717.6605225
	speed: 0.0498s/iter; left time: 5618.2307s
	iters: 3600, epoch: 4 | loss: 1234.6994629
	speed: 0.0522s/iter; left time: 5881.1801s
	iters: 3700, epoch: 4 | loss: 1598.5246582
	speed: 0.0600s/iter; left time: 6759.0515s
	iters: 3800, epoch: 4 | loss: 1532.9741211
	speed: 0.0604s/iter; left time: 6790.4174s
	iters: 3900, epoch: 4 | loss: 1371.7326660
	speed: 0.0562s/iter; left time: 6317.8197s
	iters: 4000, epoch: 4 | loss: 3210.7856445
	speed: 0.0508s/iter; left time: 5710.5325s
	iters: 4100, epoch: 4 | loss: 4769.8833008
	speed: 0.0570s/iter; left time: 6391.5794s
	iters: 4200, epoch: 4 | loss: 5643.4624023
	speed: 0.0554s/iter; left time: 6206.3852s
	iters: 4300, epoch: 4 | loss: 10316.9619141
	speed: 0.0511s/iter; left time: 5724.8746s
Epoch: 4 cost time: 229.8580400943756
Epoch: 4, Steps: 4308 | Train Loss: 1370.7712863 Vali Loss: 0.2100424 Test Loss: 0.3461548
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTm2_mask_0.375_CALF_ETTm2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11521
test shape: (11521, 96, 7) (11521, 96, 7)
mse:0.16200770437717438, mae:0.2788471579551697
Args in experiment:
[1mBasic Config[0m
  Task Name:          imputation          Is Training:        1                   
  Model ID:           ETTm2_mask_0.5      Model:              CALF                

[1mData Loader[0m
  Data:               ETTm2               Root Path:          /home/nathan/LLM4TS/datasets/Imputation/ETT-small/
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mImputation Task[0m
  Mask Rate:          0.5                 

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            768                 
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0005              
  Des:                Exp                 Feature Loss:       l1                  Output Loss:        l1                  Task Loss:          l1                  
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

[1mDistill Loss Weight[0m
  Feature Weight:     0.01                Output Weight:      1.0                 Task Weight:        1.0                 

Use GPU: cuda:0
>>>>>>>start training : imputation_ETTm2_mask_0.5_CALF_ETTm2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34465
val 11521
test 11521
	iters: 100, epoch: 1 | loss: 0.7773566
	speed: 0.0710s/iter; left time: 9164.7604s
	iters: 200, epoch: 1 | loss: 1.2388633
	speed: 0.0582s/iter; left time: 7514.0789s
	iters: 300, epoch: 1 | loss: 1.6322446
	speed: 0.0559s/iter; left time: 7203.4183s
	iters: 400, epoch: 1 | loss: 2.5841026
	speed: 0.0579s/iter; left time: 7462.2410s
	iters: 500, epoch: 1 | loss: 4.3243394
	speed: 0.0575s/iter; left time: 7402.1940s
	iters: 600, epoch: 1 | loss: 6.7724771
	speed: 0.0585s/iter; left time: 7530.1109s
	iters: 700, epoch: 1 | loss: 9.6636581
	speed: 0.0563s/iter; left time: 7238.6776s
	iters: 800, epoch: 1 | loss: 7.8974180
	speed: 0.0561s/iter; left time: 7203.8548s
	iters: 900, epoch: 1 | loss: 8.8310204
	speed: 0.0534s/iter; left time: 6849.3663s
	iters: 1000, epoch: 1 | loss: 8.5440636
	speed: 0.0508s/iter; left time: 6517.2404s
	iters: 1100, epoch: 1 | loss: 9.5216303
	speed: 0.0603s/iter; left time: 7729.7582s
	iters: 1200, epoch: 1 | loss: 10.3732615
	speed: 0.0540s/iter; left time: 6910.9031s
	iters: 1300, epoch: 1 | loss: 17.2193794
	speed: 0.0568s/iter; left time: 7266.1625s
	iters: 1400, epoch: 1 | loss: 10.0006313
	speed: 0.0585s/iter; left time: 7482.6235s
	iters: 1500, epoch: 1 | loss: 16.4975815
	speed: 0.0609s/iter; left time: 7780.7690s
	iters: 1600, epoch: 1 | loss: 24.6082478
	speed: 0.0568s/iter; left time: 7245.7122s
	iters: 1700, epoch: 1 | loss: 16.1951847
	speed: 0.0534s/iter; left time: 6809.7731s
	iters: 1800, epoch: 1 | loss: 20.0790138
	speed: 0.0591s/iter; left time: 7530.1197s
	iters: 1900, epoch: 1 | loss: 31.6044731
	speed: 0.0591s/iter; left time: 7531.5655s
	iters: 2000, epoch: 1 | loss: 25.1202488
	speed: 0.0630s/iter; left time: 8020.4319s
	iters: 2100, epoch: 1 | loss: 34.0991135
	speed: 0.0588s/iter; left time: 7477.0325s
	iters: 2200, epoch: 1 | loss: 25.6169682
	speed: 0.0540s/iter; left time: 6866.2864s
	iters: 2300, epoch: 1 | loss: 22.6766949
	speed: 0.0526s/iter; left time: 6673.5519s
	iters: 2400, epoch: 1 | loss: 23.3789539
	speed: 0.0527s/iter; left time: 6680.0940s
	iters: 2500, epoch: 1 | loss: 45.2325439
	speed: 0.0591s/iter; left time: 7490.5449s
	iters: 2600, epoch: 1 | loss: 61.4859543
	speed: 0.0574s/iter; left time: 7273.5896s
	iters: 2700, epoch: 1 | loss: 36.1137199
	speed: 0.0577s/iter; left time: 7296.4250s
	iters: 2800, epoch: 1 | loss: 36.1091003
	speed: 0.0572s/iter; left time: 7233.9560s
	iters: 2900, epoch: 1 | loss: 44.0756950
	speed: 0.0556s/iter; left time: 7018.8409s
	iters: 3000, epoch: 1 | loss: 46.0564575
	speed: 0.0596s/iter; left time: 7526.3682s
	iters: 3100, epoch: 1 | loss: 48.6228523
	speed: 0.0605s/iter; left time: 7628.0412s
	iters: 3200, epoch: 1 | loss: 68.0923309
	speed: 0.0595s/iter; left time: 7504.5325s
	iters: 3300, epoch: 1 | loss: 90.0276337
	speed: 0.0579s/iter; left time: 7293.8326s
	iters: 3400, epoch: 1 | loss: 57.3529396
	speed: 0.0554s/iter; left time: 6969.8497s
	iters: 3500, epoch: 1 | loss: 68.2145767
	speed: 0.0500s/iter; left time: 6283.7445s
	iters: 3600, epoch: 1 | loss: 50.3040237
	speed: 0.0493s/iter; left time: 6190.4076s
	iters: 3700, epoch: 1 | loss: 87.7747955
	speed: 0.0519s/iter; left time: 6521.7714s
	iters: 3800, epoch: 1 | loss: 77.2330246
	speed: 0.0488s/iter; left time: 6123.4260s
	iters: 3900, epoch: 1 | loss: 72.9591751
	speed: 0.0539s/iter; left time: 6755.4626s
	iters: 4000, epoch: 1 | loss: 74.9781723
	speed: 0.0581s/iter; left time: 7278.0010s
	iters: 4100, epoch: 1 | loss: 110.1569214
	speed: 0.0587s/iter; left time: 7340.3742s
	iters: 4200, epoch: 1 | loss: 111.7140274
	speed: 0.0598s/iter; left time: 7480.8862s
	iters: 4300, epoch: 1 | loss: 121.6633987
	speed: 0.0587s/iter; left time: 7334.4435s
Epoch: 1 cost time: 245.02791213989258
Epoch: 1, Steps: 4308 | Train Loss: 40.0393445 Vali Loss: 0.2137946 Test Loss: 0.3670970
Validation loss decreased (inf --> 0.213795).  Saving model ...
lr_adjust = {1: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 93.9823227
	speed: 2.6071s/iter; left time: 325457.4436s
	iters: 200, epoch: 2 | loss: 59.7655983
	speed: 0.0573s/iter; left time: 7153.2750s
	iters: 300, epoch: 2 | loss: 88.4904480
	speed: 0.0568s/iter; left time: 7079.3063s
	iters: 400, epoch: 2 | loss: 89.7817230
	speed: 0.0574s/iter; left time: 7147.6366s
	iters: 500, epoch: 2 | loss: 65.4015045
	speed: 0.0582s/iter; left time: 7239.5120s
	iters: 600, epoch: 2 | loss: 74.7114487
	speed: 0.0534s/iter; left time: 6642.2373s
	iters: 700, epoch: 2 | loss: 94.4188004
	speed: 0.0553s/iter; left time: 6868.8157s
	iters: 800, epoch: 2 | loss: 96.9665222
	speed: 0.0567s/iter; left time: 7042.8720s
	iters: 900, epoch: 2 | loss: 85.1757126
	speed: 0.0521s/iter; left time: 6459.2420s
	iters: 1000, epoch: 2 | loss: 111.7026749
	speed: 0.0577s/iter; left time: 7155.8405s
	iters: 1100, epoch: 2 | loss: 122.7225037
	speed: 0.0641s/iter; left time: 7931.8685s
	iters: 1200, epoch: 2 | loss: 150.7997589
	speed: 0.0513s/iter; left time: 6343.6149s
	iters: 1300, epoch: 2 | loss: 150.6428833
	speed: 0.0511s/iter; left time: 6319.4631s
	iters: 1400, epoch: 2 | loss: 137.2697449
	speed: 0.0482s/iter; left time: 5952.0218s
	iters: 1500, epoch: 2 | loss: 147.5647278
	speed: 0.0484s/iter; left time: 5978.4090s
	iters: 1600, epoch: 2 | loss: 145.1745758
	speed: 0.0483s/iter; left time: 5959.8123s
	iters: 1700, epoch: 2 | loss: 164.0172119
	speed: 0.0479s/iter; left time: 5907.7226s
	iters: 1800, epoch: 2 | loss: 160.8854523
	speed: 0.0501s/iter; left time: 6164.4323s
	iters: 1900, epoch: 2 | loss: 295.6472778
	speed: 0.0488s/iter; left time: 6004.1754s
	iters: 2000, epoch: 2 | loss: 129.4815521
	speed: 0.0495s/iter; left time: 6079.5084s
	iters: 2100, epoch: 2 | loss: 113.0468750
	speed: 0.0488s/iter; left time: 5994.4207s
	iters: 2200, epoch: 2 | loss: 133.8913422
	speed: 0.0482s/iter; left time: 5915.6620s
	iters: 2300, epoch: 2 | loss: 137.7903900
	speed: 0.0494s/iter; left time: 6054.0100s
	iters: 2400, epoch: 2 | loss: 103.4160385
	speed: 0.0552s/iter; left time: 6766.3413s
	iters: 2500, epoch: 2 | loss: 113.7407837
	speed: 0.0542s/iter; left time: 6635.7327s
	iters: 2600, epoch: 2 | loss: 129.9640350
	speed: 0.0547s/iter; left time: 6690.3861s
	iters: 2700, epoch: 2 | loss: 87.9130020
	speed: 0.0509s/iter; left time: 6227.2972s
	iters: 2800, epoch: 2 | loss: 147.9835815
	speed: 0.0603s/iter; left time: 7359.2643s
	iters: 2900, epoch: 2 | loss: 126.0545044
	speed: 0.0542s/iter; left time: 6609.9795s
	iters: 3000, epoch: 2 | loss: 178.8432465
	speed: 0.0510s/iter; left time: 6215.9485s
	iters: 3100, epoch: 2 | loss: 232.4122620
	speed: 0.0584s/iter; left time: 7118.2943s
	iters: 3200, epoch: 2 | loss: 154.6961517
	speed: 0.0591s/iter; left time: 7195.9601s
	iters: 3300, epoch: 2 | loss: 172.3625946
	speed: 0.0544s/iter; left time: 6621.8739s
	iters: 3400, epoch: 2 | loss: 200.9580688
	speed: 0.0525s/iter; left time: 6380.2797s
	iters: 3500, epoch: 2 | loss: 173.2955017
	speed: 0.0504s/iter; left time: 6121.1768s
	iters: 3600, epoch: 2 | loss: 190.9405212
	speed: 0.0514s/iter; left time: 6239.7418s
	iters: 3700, epoch: 2 | loss: 197.1489258
	speed: 0.0536s/iter; left time: 6497.3603s
	iters: 3800, epoch: 2 | loss: 201.7677307
	speed: 0.0594s/iter; left time: 7190.6072s
	iters: 3900, epoch: 2 | loss: 211.6403809
	speed: 0.0574s/iter; left time: 6948.7252s
	iters: 4000, epoch: 2 | loss: 187.8611298
	speed: 0.0625s/iter; left time: 7562.6954s
	iters: 4100, epoch: 2 | loss: 217.9484863
	speed: 0.0576s/iter; left time: 6954.5374s
	iters: 4200, epoch: 2 | loss: 193.6924591
	speed: 0.0580s/iter; left time: 6997.8732s
	iters: 4300, epoch: 2 | loss: 173.2584839
	speed: 0.0512s/iter; left time: 6176.3554s
Epoch: 2 cost time: 233.64165997505188
Epoch: 2, Steps: 4308 | Train Loss: 144.6505629 Vali Loss: 0.1310769 Test Loss: 0.1862471
Validation loss decreased (0.213795 --> 0.131077).  Saving model ...
lr_adjust = {2: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 214.2623596
	speed: 2.6290s/iter; left time: 316863.9581s
	iters: 200, epoch: 3 | loss: 208.4586182
	speed: 0.0522s/iter; left time: 6281.0434s
	iters: 300, epoch: 3 | loss: 175.5790863
	speed: 0.0546s/iter; left time: 6569.1346s
	iters: 400, epoch: 3 | loss: 172.8909454
	speed: 0.0597s/iter; left time: 7180.6059s
	iters: 500, epoch: 3 | loss: 190.1672363
	speed: 0.0558s/iter; left time: 6704.2081s
	iters: 600, epoch: 3 | loss: 208.4659271
	speed: 0.0562s/iter; left time: 6749.1098s
	iters: 700, epoch: 3 | loss: 258.0433350
	speed: 0.0569s/iter; left time: 6826.2273s
	iters: 800, epoch: 3 | loss: 272.6627502
	speed: 0.0581s/iter; left time: 6964.9155s
	iters: 900, epoch: 3 | loss: 230.0664520
	speed: 0.0549s/iter; left time: 6576.3436s
	iters: 1000, epoch: 3 | loss: 240.6255188
	speed: 0.0510s/iter; left time: 6096.8908s
	iters: 1100, epoch: 3 | loss: 271.5453491
	speed: 0.0545s/iter; left time: 6518.6008s
	iters: 1200, epoch: 3 | loss: 312.1769104
	speed: 0.0547s/iter; left time: 6527.3919s
	iters: 1300, epoch: 3 | loss: 267.4884338
	speed: 0.0544s/iter; left time: 6486.5774s
	iters: 1400, epoch: 3 | loss: 297.0552368
	speed: 0.0545s/iter; left time: 6495.1804s
	iters: 1500, epoch: 3 | loss: 223.8240509
	speed: 0.0569s/iter; left time: 6780.8826s
	iters: 1600, epoch: 3 | loss: 192.6997681
	speed: 0.0578s/iter; left time: 6874.5699s
	iters: 1700, epoch: 3 | loss: 198.2588348
	speed: 0.0548s/iter; left time: 6519.4879s
	iters: 1800, epoch: 3 | loss: 228.1430054
	speed: 0.0588s/iter; left time: 6988.2360s
	iters: 1900, epoch: 3 | loss: 239.5920105
	speed: 0.0560s/iter; left time: 6647.0162s
	iters: 2000, epoch: 3 | loss: 235.3369446
	speed: 0.0483s/iter; left time: 5731.4719s
	iters: 2100, epoch: 3 | loss: 184.8745117
	speed: 0.0480s/iter; left time: 5684.7218s
	iters: 2200, epoch: 3 | loss: 226.9620056
	speed: 0.0496s/iter; left time: 5879.3697s
	iters: 2300, epoch: 3 | loss: 662.9584961
	speed: 0.0555s/iter; left time: 6565.0864s
	iters: 2400, epoch: 3 | loss: 249.6243439
	speed: 0.0573s/iter; left time: 6771.5928s
	iters: 2500, epoch: 3 | loss: 263.7406006
	speed: 0.0528s/iter; left time: 6240.4683s
	iters: 2600, epoch: 3 | loss: 274.2066040
	speed: 0.0504s/iter; left time: 5950.2839s
	iters: 2700, epoch: 3 | loss: 309.8900452
	speed: 0.0526s/iter; left time: 6200.7064s
	iters: 2800, epoch: 3 | loss: 269.4523926
	speed: 0.0530s/iter; left time: 6240.7354s
	iters: 2900, epoch: 3 | loss: 307.0076294
	speed: 0.0567s/iter; left time: 6678.7243s
	iters: 3000, epoch: 3 | loss: 295.6225281
	speed: 0.0538s/iter; left time: 6326.9553s
	iters: 3100, epoch: 3 | loss: 283.9523926
	speed: 0.0500s/iter; left time: 5879.5454s
	iters: 3200, epoch: 3 | loss: 213.5642853
	speed: 0.0578s/iter; left time: 6782.7379s
	iters: 3300, epoch: 3 | loss: 519.1074219
	speed: 0.0589s/iter; left time: 6907.8588s
	iters: 3400, epoch: 3 | loss: 379.4266052
	speed: 0.0590s/iter; left time: 6918.4965s
	iters: 3500, epoch: 3 | loss: 383.2757568
	speed: 0.0585s/iter; left time: 6849.1774s
	iters: 3600, epoch: 3 | loss: 352.1635742
	speed: 0.0573s/iter; left time: 6708.0285s
	iters: 3700, epoch: 3 | loss: 344.0346680
	speed: 0.0581s/iter; left time: 6799.1651s
	iters: 3800, epoch: 3 | loss: 381.2873840
	speed: 0.0592s/iter; left time: 6912.9041s
	iters: 3900, epoch: 3 | loss: 379.2963257
	speed: 0.0596s/iter; left time: 6951.1743s
	iters: 4000, epoch: 3 | loss: 409.2694092
	speed: 0.0591s/iter; left time: 6894.3160s
	iters: 4100, epoch: 3 | loss: 461.6781311
	speed: 0.0536s/iter; left time: 6248.1566s
	iters: 4200, epoch: 3 | loss: 456.7814331
	speed: 0.0538s/iter; left time: 6258.7423s
	iters: 4300, epoch: 3 | loss: 393.1076050
	speed: 0.0557s/iter; left time: 6478.3977s
Epoch: 3 cost time: 238.17480492591858
Epoch: 3, Steps: 4308 | Train Loss: 287.6253619 Vali Loss: 0.2172474 Test Loss: 0.3586510
EarlyStopping counter: 1 out of 3
lr_adjust = {3: 0.0005}
Updating learning rate to 0.0005
	iters: 100, epoch: 4 | loss: 410.2009583
	speed: 2.6088s/iter; left time: 303187.8216s
	iters: 200, epoch: 4 | loss: 357.3420715
	speed: 0.0584s/iter; left time: 6779.6065s
	iters: 300, epoch: 4 | loss: 392.9768066
	speed: 0.0655s/iter; left time: 7601.6062s
	iters: 400, epoch: 4 | loss: 353.2337341
	speed: 0.0609s/iter; left time: 7056.8817s
	iters: 500, epoch: 4 | loss: 326.4204102
	speed: 0.0564s/iter; left time: 6529.2312s
	iters: 600, epoch: 4 | loss: 307.7295532
	speed: 0.0599s/iter; left time: 6933.4405s
	iters: 700, epoch: 4 | loss: 363.7610168
	speed: 0.0572s/iter; left time: 6608.2847s
	iters: 800, epoch: 4 | loss: 319.4609375
	speed: 0.0552s/iter; left time: 6375.3216s
	iters: 900, epoch: 4 | loss: 306.5744629
	speed: 0.0501s/iter; left time: 5784.1214s
	iters: 1000, epoch: 4 | loss: 273.5049744
	speed: 0.0485s/iter; left time: 5590.8313s
	iters: 1100, epoch: 4 | loss: 263.2810974
	speed: 0.0521s/iter; left time: 5997.6810s
	iters: 1200, epoch: 4 | loss: 284.0148621
	speed: 0.0558s/iter; left time: 6420.5457s
	iters: 1300, epoch: 4 | loss: 307.9873657
	speed: 0.0530s/iter; left time: 6095.1488s
	iters: 1400, epoch: 4 | loss: 282.1628723
	speed: 0.0599s/iter; left time: 6887.9778s
	iters: 1500, epoch: 4 | loss: 364.8246460
	speed: 0.0596s/iter; left time: 6846.0349s
	iters: 1600, epoch: 4 | loss: 334.3976746
	speed: 0.0582s/iter; left time: 6675.0193s
	iters: 1700, epoch: 4 | loss: 338.6608276
	speed: 0.0536s/iter; left time: 6139.3792s
	iters: 1800, epoch: 4 | loss: 321.7148132
	speed: 0.0544s/iter; left time: 6233.0381s
	iters: 1900, epoch: 4 | loss: 352.3786621
	speed: 0.0558s/iter; left time: 6390.0457s
	iters: 2000, epoch: 4 | loss: 280.0144043
	speed: 0.0537s/iter; left time: 6141.1498s
	iters: 2100, epoch: 4 | loss: 353.8169556
	speed: 0.0551s/iter; left time: 6297.7818s
	iters: 2200, epoch: 4 | loss: 310.0449219
	speed: 0.0525s/iter; left time: 5995.9278s
	iters: 2300, epoch: 4 | loss: 321.6473694
	speed: 0.0521s/iter; left time: 5944.8018s
	iters: 2400, epoch: 4 | loss: 296.8177490
	speed: 0.0517s/iter; left time: 5886.2213s
	iters: 2500, epoch: 4 | loss: 360.8531189
	speed: 0.0537s/iter; left time: 6111.8458s
	iters: 2600, epoch: 4 | loss: 358.9096680
	speed: 0.0513s/iter; left time: 5830.2173s
	iters: 2700, epoch: 4 | loss: 470.8179321
	speed: 0.0576s/iter; left time: 6545.7909s
	iters: 2800, epoch: 4 | loss: 458.5572510
	speed: 0.0577s/iter; left time: 6545.1553s
	iters: 2900, epoch: 4 | loss: 507.0101624
	speed: 0.0580s/iter; left time: 6574.8318s
	iters: 3000, epoch: 4 | loss: 445.1691589
	speed: 0.0594s/iter; left time: 6733.8240s
	iters: 3100, epoch: 4 | loss: 434.3193359
	speed: 0.0565s/iter; left time: 6397.8158s
	iters: 3200, epoch: 4 | loss: 426.3587036
	speed: 0.0542s/iter; left time: 6135.5149s
	iters: 3300, epoch: 4 | loss: 403.8293152
	speed: 0.0503s/iter; left time: 5685.6823s
	iters: 3400, epoch: 4 | loss: 390.8536072
	speed: 0.0519s/iter; left time: 5856.9539s
	iters: 3500, epoch: 4 | loss: 465.4314880
	speed: 0.0491s/iter; left time: 5537.5976s
	iters: 3600, epoch: 4 | loss: 1463.0522461
	speed: 0.0511s/iter; left time: 5754.2152s
	iters: 3700, epoch: 4 | loss: 450.3270569
	speed: 0.0504s/iter; left time: 5673.6408s
	iters: 3800, epoch: 4 | loss: 514.5089722
	speed: 0.0558s/iter; left time: 6281.8168s
	iters: 3900, epoch: 4 | loss: 490.5581970
	speed: 0.0513s/iter; left time: 5764.5739s
	iters: 4000, epoch: 4 | loss: 357.9172974
	speed: 0.0492s/iter; left time: 5529.1092s
	iters: 4100, epoch: 4 | loss: 424.9849548
	speed: 0.0495s/iter; left time: 5557.5240s
	iters: 4200, epoch: 4 | loss: 340.7381592
	speed: 0.0492s/iter; left time: 5517.1669s
	iters: 4300, epoch: 4 | loss: 770.7844849
	speed: 0.0484s/iter; left time: 5420.3133s
Epoch: 4 cost time: 235.74268674850464
Epoch: 4, Steps: 4308 | Train Loss: 385.6742598 Vali Loss: 0.1639563 Test Loss: 0.2299654
EarlyStopping counter: 2 out of 3
lr_adjust = {4: 0.00045000000000000004}
Updating learning rate to 0.00045000000000000004
	iters: 100, epoch: 5 | loss: 404.9995422
	speed: 2.5318s/iter; left time: 283328.7105s
	iters: 200, epoch: 5 | loss: 399.0741272
	speed: 0.0571s/iter; left time: 6389.2389s
	iters: 300, epoch: 5 | loss: 390.5452576
	speed: 0.0498s/iter; left time: 5558.2236s
	iters: 400, epoch: 5 | loss: 572.0394287
	speed: 0.0481s/iter; left time: 5373.1158s
	iters: 500, epoch: 5 | loss: 442.5058899
	speed: 0.0479s/iter; left time: 5338.0238s
	iters: 600, epoch: 5 | loss: 414.3570557
	speed: 0.0481s/iter; left time: 5354.5250s
	iters: 700, epoch: 5 | loss: 395.7887878
	speed: 0.0518s/iter; left time: 5767.5198s
	iters: 800, epoch: 5 | loss: 436.8189697
	speed: 0.0545s/iter; left time: 6061.1769s
	iters: 900, epoch: 5 | loss: 478.5877991
	speed: 0.0504s/iter; left time: 5599.2212s
	iters: 1000, epoch: 5 | loss: 739.8455811
	speed: 0.0502s/iter; left time: 5573.3431s
	iters: 1100, epoch: 5 | loss: 2166.3500977
	speed: 0.0505s/iter; left time: 5603.8065s
	iters: 1200, epoch: 5 | loss: 931.0637207
	speed: 0.0521s/iter; left time: 5772.0824s
	iters: 1300, epoch: 5 | loss: 924.7371216
	speed: 0.0576s/iter; left time: 6375.3890s
	iters: 1400, epoch: 5 | loss: 489.0153198
	speed: 0.0605s/iter; left time: 6691.8613s
	iters: 1500, epoch: 5 | loss: 514.5478516
	speed: 0.0484s/iter; left time: 5352.2815s
	iters: 1600, epoch: 5 | loss: 397.4906311
	speed: 0.0516s/iter; left time: 5697.5759s
	iters: 1700, epoch: 5 | loss: 329.4415283
	speed: 0.0512s/iter; left time: 5645.2162s
	iters: 1800, epoch: 5 | loss: 983.3967285
	speed: 0.0489s/iter; left time: 5385.4754s
	iters: 1900, epoch: 5 | loss: 1279.6997070
	speed: 0.0520s/iter; left time: 5723.4994s
	iters: 2000, epoch: 5 | loss: 993.3317261
	speed: 0.0490s/iter; left time: 5390.7598s
	iters: 2100, epoch: 5 | loss: 1816.4581299
	speed: 0.0491s/iter; left time: 5399.0411s
	iters: 2200, epoch: 5 | loss: 988.9731445
	speed: 0.0489s/iter; left time: 5373.4006s
	iters: 2300, epoch: 5 | loss: 500.8451233
	speed: 0.0495s/iter; left time: 5433.0872s
	iters: 2400, epoch: 5 | loss: 1210.8447266
	speed: 0.0492s/iter; left time: 5388.6796s
	iters: 2500, epoch: 5 | loss: 1144.8930664
	speed: 0.0547s/iter; left time: 5990.0661s
	iters: 2600, epoch: 5 | loss: 921.8353882
	speed: 0.0556s/iter; left time: 6081.0340s
	iters: 2700, epoch: 5 | loss: 489.1140137
	speed: 0.0564s/iter; left time: 6169.7318s
	iters: 2800, epoch: 5 | loss: 369.9910583
	speed: 0.0567s/iter; left time: 6195.8534s
	iters: 2900, epoch: 5 | loss: 443.8688049
	speed: 0.0569s/iter; left time: 6206.7970s
	iters: 3000, epoch: 5 | loss: 383.0983582
	speed: 0.0575s/iter; left time: 6268.7052s
	iters: 3100, epoch: 5 | loss: 476.7037048
	speed: 0.0576s/iter; left time: 6267.8289s
	iters: 3200, epoch: 5 | loss: 414.7332458
	speed: 0.0575s/iter; left time: 6258.1054s
	iters: 3300, epoch: 5 | loss: 416.5127869
	speed: 0.0594s/iter; left time: 6460.7652s
	iters: 3400, epoch: 5 | loss: 414.3402405
	speed: 0.0620s/iter; left time: 6732.1453s
	iters: 3500, epoch: 5 | loss: 406.4898071
	speed: 0.0569s/iter; left time: 6173.7133s
	iters: 3600, epoch: 5 | loss: 401.5579529
	speed: 0.0512s/iter; left time: 5545.8089s
	iters: 3700, epoch: 5 | loss: 375.4491272
	speed: 0.0584s/iter; left time: 6322.5480s
	iters: 3800, epoch: 5 | loss: 437.4503784
	speed: 0.0599s/iter; left time: 6484.7964s
	iters: 3900, epoch: 5 | loss: 386.4829407
	speed: 0.0637s/iter; left time: 6884.3324s
	iters: 4000, epoch: 5 | loss: 429.2008362
	speed: 0.0619s/iter; left time: 6686.6000s
	iters: 4100, epoch: 5 | loss: 448.0533142
	speed: 0.0589s/iter; left time: 6353.7800s
	iters: 4200, epoch: 5 | loss: 457.9913635
	speed: 0.0591s/iter; left time: 6369.9166s
	iters: 4300, epoch: 5 | loss: 420.5089111
	speed: 0.0523s/iter; left time: 5629.2990s
Epoch: 5 cost time: 234.2627944946289
Epoch: 5, Steps: 4308 | Train Loss: 601.7899187 Vali Loss: 0.1661195 Test Loss: 0.2419468
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTm2_mask_0.5_CALF_ETTm2_ftM_sl96_ll0_pl0_dm768_nh4_el2_dl1_df768_fc1_ebtimeF_dtTrue_Exp_gpt6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11521
test shape: (11521, 96, 7) (11521, 96, 7)
mse:0.1667575240135193, mae:0.28560683131217957
